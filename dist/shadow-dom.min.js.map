{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src\\custom-elements.js","src\\dom.js","src\\interfaces\\Attr.js","src\\interfaces\\CharacterData.js","src\\interfaces\\CustomEvent.js","src\\interfaces\\DOMTokenList.js","src\\interfaces\\Document.js","src\\interfaces\\Element.js","src\\interfaces\\Event.js","src\\interfaces\\EventTarget.js","src\\interfaces\\HTMLSlotElement.js","src\\interfaces\\HTMLTableElement.js","src\\interfaces\\HTMLTableRowElement.js","src\\interfaces\\HTMLTableSectionElement.js","src\\interfaces\\MutationObserver.js","src\\interfaces\\NamedNodeMap.js","src\\interfaces\\Node.js","src\\interfaces\\ShadowRoot.js","src\\interfaces\\Text.js","src\\main.js","src\\mixins\\ChildNode.js","src\\mixins\\DocumentOrShadowRoot.js","src\\mixins\\NonDocumentTypeChildNode.js","src\\mixins\\NonElementParentNode.js","src\\mixins\\ParentNode.js","src\\mixins\\Slotable.js","src\\reflect.js","src\\shadow-dom.js","src\\utils.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_interopRequireDefault","__esModule","default","install","builtInElementInterfaces","installHtmlConstructors","registry","CustomElementRegistry","Object","defineProperty","window","CE_PROP_NAME","value","writable","configurable","enumerable","Document","prototype","createElement","createElementNS","nativeMutationObserver","addedNodes","nodeType","Node","ELEMENT_NODE","tryToUpgradeElementSync","observe","document","childList","subtree","addEventListener","DOM_CONTENT_LOADED","disconnect","treeOrderShadowInclusiveForEach","push","forEach","once","customElementsReactionStack","backupElementQueue","processingBackupElementQueue","setInstallation","uninstall","getPrivateState","uninstallHtmlConstructors","nativeCreateElement","nativeCreateElementNS","setPrivateState","isInstalled","getInstallation","gatherBuiltInElementInterfaces","getOwnPropertyNames","test","nativeHTMLElement","name","object","constructor","installTranspiledClassSupport","Function","CTOR_PROP_NAME","makeHtmlConstructor","getPrototypeOf","this","TypeError","definitions","htmlConstructor","constructionStack","c","localName","_utils2","setPrototypeOf","customElementState","CE_STATE_CUSTOM","customElementDefinition","E","alreadyConstructedMarker","makeDOMException","createAnElement","lookupCustomElementDefinition","CE_STATE_UNDEFINED","isValue","upgradeElement","enqueueUpgradeReaction","HTMLElement","attributes","hasChildNodes","parentNode","ownerDocument","namespaceURI","htmlNamespace","reportError","CE_STATE_FAILED","toLowerCase","is","setAttribute","ATTR_IS_NAME","isCustom","isValidCustomElementName","charCodeAt","defaultView","customElements","elementDefinitionIsRunning","whenDefinedPromiseMap","shouldNotUpgrade","reactionQueue","enqueueCallbackReaction","CE_CALLBACK_ATTRIBUTE_CHANGED","isConnected","CE_CALLBACK_CONNECTED","splice","pop","tryToUpgradeElement","enqueueElementOnAppropriateElementQueue","setImmediate","invokeReactions","lifecycleCallbacks","observedAttributes","indexOf","type","callbackReactionType","callback","args","enqueueConnectedReaction","enqueueDisconnectedReaction","CE_CALLBACK_DISCONNECTED","enqueueAdoptedReaction","CE_CALLBACK_ADOPTED","enqueueAttributeChangedReaction","upgradeReactionType","definition","apply","executeCEReactions","getCallback","_custom","shadowRoot","childNodes","_utils","MutationObserver","descriptor","nativeSupport","promisesSupported","define","extends","HTMLUnknownElement","m","slice","d","element","p","resolve","get","whenDefined","Promise","promise","forEachShadowIncludingDescendant","getShadowState","forEachShadowIncludingInclusiveDescendant","treeOrderRecursiveSelectAll","firstChild","nextSibling","treeOrderRecursiveSelectFirst","filterByRoot","root","Array","isShadowRoot","nodeName","SHADOW_NODE_NAME","parseHTMLFragment","setShadowState","parsingElement","parsingFragment","createDocumentFragment","elementInnerHTMLDescriptor","set","nodeFirstChildDescriptor","nodeAppendChildDescriptor","serializeHTMLFragment","replace","EMPTY_STRING","NS_XML","NS_XMLNS","NS_XLINK","content","NS_HTML","NS_MATHML","NS_SVG","qualifiedName","elementAttributesDescriptor","TEXT_NODE","data","COMMENT_NODE","PROCESSING_INSTRUCTION_NODE","target","DOCUMENT_TYPE_NODE","ancestor","inclusiveAncestor","convertNodesIntoANode","createTextNode","appendChild","clone","nodeCloneNodeDescriptor","_customElements2","append","cloneNode","adopt","remove","hostIncludingInclusiveAncestor","host","shadowIncludingRoot","shadowIncludingDescendant","shadowIncludingAncestor","shadowIncludingInclusiveAncestor","closedShadowHidden","mode","SHADOW_MODE_CLOSED","retarget","updateSlotName","TAG_SLOT","ATTR_NAME","elementSetAttributeDescriptor","assignSlotablesForATree","updateSlotableName","assignedSlot","assignSlotables","assignASlot","attributeChangeSteps","changeAttribute","attrValueDescriptor","queueMutationRecord","MO_TYPE_ATTRIBUTES","appendAttribute","removeAttribute","elementRemoveAttributeNSDescriptor","replaceAttribute","ownerElement","ERROR_IN_USE_ATTRIBUTE","getNamedItemNS","namedNodeMapSetNamedItemNSDescriptor","setAttributeValue","removeAttributeByName","getNamedItem","removeAttributeByNamespace","insertAdjacent","preInsert","ERROR_SYNTAX","setExistingAttributeValue","replaceData","characterDataDataDescriptor","ERROR_INDEX_SIZE","MO_TYPE_CHARACTER_DATA","findASlot","SHADOW_MODE_OPEN","Element","slot","findSlotables","findFlattenedSlotables","k","assignedNodes","signalASlotChange","nodeChildNodesDescriptor","renderSlotablesAsync","nodeRemoveChildDescriptor","signalSlotList","queueMutationObserverCompoundMicrotask","ensurePreInsertionValidity","ERROR_HIERARCHY_REQUEST","ERROR_NOT_FOUND","insert","DOCUMENT_FRAGMENT_NODE","MO_TYPE_CHILD_LIST","v","h","nodeInsertBeforeDescriptor","PROP_ASSIGNED_SLOT","S","g","previousSibling","lastChild","DocumentFragment","replaceAll","preRemove","nodeParentNodeDescriptor","observers","options","instance","createTransientObserver","mutationObservers","getOrCreateNodeObservers","createMutationObserver","queue","nodes","observer","node","attributeFilter","characterData","_","N","attributeOldValue","characterDataOldValue","T","A","attributeName","attributeNamespace","theEmptyList","removedNodes","oldValue","freeze","mutationObserverCompoundMicrotaskQueuedFlag","notifyMutationObservers","interface","createEvent","EVENT","initEvent","EVT_SLOT_CHANGE","dispatchEvent","_customElements","Attr","CharacterData","NamedNodeMap","_dom","_dom2","appendData","insertData","deleteData","$CustomEvent","bubbles","cancelable","composed","detail","initCustomEvent","CustomEvent","validateTokens","validateToken","createDOMTokenList","getAttribute","split","sort","create","DOMTokenList","tokens","getOrCreateDOMTokenList","tokenLists","item","contains","add","arguments","join","toggle","documentGetElementsByTagNameDescriptor","documentGetElementsByTagNameNSDescriptor","documentGetElementsByClassNameDescriptor","getElementsByTagName","getElementsByTagNameNS","getElementsByClassName","importNode","DOCUMENT_NODE","adoptNode","_ShadowRoot","_ShadowRoot2","elementGetElementsByTagNameDescriptor","elementGetElementsByTagNameNSDescriptor","elementGetElementsByClassNameDescriptor","elementSetAttributeNSDescriptor","setAttributeNS","removeAttributeNS","setAttributeNode","setAttributeNodeNS","removeAttributeNode","attachShadow","extend","closest","matches","parentElement","insertAdjacentElement","insertAdjacentText","innerHTML","outerHTML","insertAdjacentHTML","$Event","hasRelatedTarget","currentTarget","stopImmediatePropagation","stopPropagation","stopImmediatePropagationFlag","composedPath","path","Window","builtInComposedEvents","relatedTarget","calculatePath","eventTargetDescriptor","FocusEvent","focusEventRelatedTargetDescriptor","MouseEvent","mouseEventRelatedTargetDescriptor","getTheParent","calculateRelatedTarget","calculateTarget","removeEventListener","capture","passive","EventListenerCollection","addListener","attach","removeListener","empty","detach","Event","hostListeners","shadowListeners","eventPhase","CAPTURING_PHASE","invokeListeners","AT_TARGET","getListeners","BUBBLING_PHASE","listeners","calculatedPath","flatten","deleteCaption","caption","deleteTHead","tHead","deleteTFoot","tFoot","deleteRow","rows","deleteCell","cells","$MutationObserver","takeRecords","setNamedItem","setNamedItemNS","removeNamedItem","removeNamedItemNS","ancestorOf","preceding","reverse","Math","abs","min","elementTextContent","nodeHasChildNodesDescriptor","nodeLastChildDescriptor","nodePreviousSiblingDescriptor","nodeNextSiblingDescriptor","nodeNodeValueDescriptor","getRootNode","nodeValue","ATTRIBUTE_NODE","textContent","normalize","isEqualNode","publicId","systemId","prefix","compareDocumentPosition","atttributes","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_DISCONNECTED","insertBefore","replaceChild","removeChild","splitText","_shadowDom","_shadowDom2","installShadowDom","installCustomElements","shadowDomPolyfilled","customElementsPolyfilled","before","after","replaceWith","activeElement","native","previousElementSibling","nextElementSibling","getElementById","id","children","firstElementChild","lastElementChild","childElementCount","prepend","querySelector","querySelectorAll","reflectString","reflectBoolean","hasAttribute","reflectInteger","parseInt","toString","reflectFloat","parseFloat","reflectDOMTokenList","_DOMTokenList","reflectHTMLElement","reflectTextContent","patchAll","interfaces","className","classList","title","lang","translate","dir","hidden","tabIndex","accessKey","draggable","contextMenu","HTMLMenuElement","spellcheck","contentEditable","HTMLAnchorElement","download","rel","rev","relList","hreflang","text","HTMLAreaElement","alt","coords","shape","HTMLBaseElement","href","HTMLButtonElement","autofocus","disabled","formAction","formEnctype","formMethod","formNoValidate","formTarget","menu","HTMLCanvasElement","width","height","HTMLDataElement","HTMLDetailsElement","open","HTMLEmbedElement","src","HTMLFieldSetElement","HTMLFormElement","acceptCharset","action","autocomplete","enctype","encoding","method","noValidate","HTMLIFrameElement","srcdoc","sandbox","allowFullscreen","HTMLImageElement","srcset","crossOrigin","useMap","isMap","HTMLInputElement","accept","defaultChecked","dirName","inputMode","max","maxLength","minLength","multiple","pattern","placeholder","readOnly","required","size","step","defaultValue","HTMLKeygenElement","challenge","keytype","HTMLLabelElement","htmlFor","HTMLLegendElement","HTMLLIElement","HTMLLinkElement","media","sizes","HTMLMapElement","HTMLMediaElement","preload","loop","autoplay","mediaGroup","controls","defaultMuted","label","HTMLMenuItemElement","icon","checked","radiogroup","HTMLMetaElement","httpEquiv","HTMLMeterElement","low","high","optimum","HTMLModElement","cite","dateTime","HTMLObjectElement","typeMustMatch","HTMLOListElement","reversed","start","HTMLOptGroupElement","HTMLOptionElement","defaultSelected","HTMLOutputElement","HTMLParamElement","HTMLProgressElement","HTMLQuoteElement","HTMLScriptElement","charset","async","defer","nonce","HTMLSelectElement","HTMLSourceElement","HTMLStyleElement","HTMLTableCellElement","colSpan","rowSpan","headers","HTMLTableColElement","span","HTMLTableHeaderCellElement","scope","abbr","HTMLTextAreaElement","cols","wrap","HTMLTimeElement","HTMLTrackElement","kind","srclang","HTMLVideoElement","poster","_interopRequireWildcard","hasOwnProperty","inUse","reflect","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","_Attr2","_CharacterData2","_CustomEvent2","_Document2","_DOMTokenList2","_Element2","_Event2","_Event","EventTarget","_EventTarget2","HTMLSlotElement","_HTMLSlotElement2","HTMLTableElement","_HTMLTableElement2","HTMLTableRowElement","_HTMLTableRowElement2","HTMLTableSectionElement","_HTMLTableSectionElement2","_MutationObserver2","_NamedNodeMap2","_Node2","Text","_Text2","DocumentType","_ChildNode2","_DocumentOrShadowRoot2","_NonDocumentTypeChildNode2","_NonElementParentNode2","_ParentNode2","_Slotable2","_reflect","_Attr","_CharacterData","_CustomEvent","_Document","_Element","_EventTarget","_HTMLSlotElement","_HTMLTableElement","_HTMLTableRowElement","_HTMLTableSectionElement","_MutationObserver","_NamedNodeMap","_Node","_Text","_ChildNode","_DocumentOrShadowRoot","_NonDocumentTypeChildNode","_NonElementParentNode","_ParentNode","_Slotable","getOwnPropertyDescriptor","documentCreateElementDescriptor","message","console","error","_shadow","setTimeout","concat","__proto__"],"mappings":"CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,EAAAU,EAAAJ,GCAA,YAUA,SAASK,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAoDvF,QAASsB,KACL,GAAItB,KAEJA,GAAauB,yBAA2BC,IACxCxB,EAAayB,SAAW,GAAIC,GAE5BC,OAAOC,eAAeC,OAAQC,GAC1BC,MAAO/B,EAAayB,SACpBO,UAAA,EACAC,cAAA,EACAC,YAAA,IAGJC,SAASC,UAAUC,cAAgBA,EACnCF,SAASC,UAAUE,gBAAkBA,EAEjCC,IACA,WACI,GAAIvC,GAAW,GAAIuC,GAAuB,SAAUvC,GAChD,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAQgB,OAAQf,IAChC,IAAK,GAAIC,GAAI,EAAGA,EAAIF,EAAQC,GAAGuC,WAAWxB,OAAQd,IAAK,CACnD,GAAIC,GAAQH,EAAQC,GAAGuC,WAAWtC,EAC9BC,GAAMsC,WAAaC,KAAKC,cACxBC,EAAwBzC,KAKxCH,GAAS6C,QAAQhB,OAAOiB,UACpBC,WAAA,EACAC,SAAA,IAEJnB,OAAOiB,SAASG,iBAAiBC,GAAoB,WACjDlD,EAASmD,kBAKrBtB,OAAOiB,SAASG,iBAAiBC,GAAoB,WAEjD,GAAIlD,KACJoD,GAAgCN,SAAU,SAAU7C,GAChDD,EAASqD,KAAKpD,KAElBD,EAASsD,QAAQV,KAChBW,MAAA,IAELvD,EAAawD,+BACbxD,EAAayD,sBACbzD,EAAa0D,8BAAA,EAEbC,EAAgB9B,OAAQ7B,GAG5B,QAAS4D,KACL,GAAI5D,GAAc6D,EAAgBhC,OAE7B7B,KAIL8D,EAA0B9D,EAAYuB,gCAE/BM,QAAOC,GAEdK,SAASC,UAAUC,cAAgB0B,EACnC5B,SAASC,UAAUE,gBAAkB0B,EAErCC,EAAgBpC,OAAQ,SAG5B,QAASqC,KACL,MAAkC,OAA3BC,EAAgBtC,QAG3B,QAASuC,KAGL,IAAK,GAFDpE,MACAC,EAAsB0B,OAAO0C,oBAAoBxC,QAC5C3B,EAAI,EAAGA,EAAID,EAAoBe,OAAQd,IAAK,CACjD,GAAIC,GAAOF,EAAoBC,EAC/B,KAAI,UAAUoE,KAAKnE,GAAnB,CAIA,GAAII,GAASsB,OAAO1B,IAChBI,GAAUA,YAAkBgE,IAAqBhE,IAAWgE,IAC5DvE,EAAyBqD,MAAOmB,KAAMrE,EAAMsE,OAAQlE,EAAQmE,YAAanE,EAAO6B,UAAUsC,eAGlG,MAAO1E,GAGX,QAAS2E,KACL,IAEI,GAAIC,UAAS,kBAKb,KAAK,GAHD5E,GAAuB,GAAI4E,UAAS,oBAAqB,+HAEzD3E,EAA2BmE,IACtBlE,EAAI,EAAGA,EAAID,EAAyBe,OAAQd,IAAK,CACtD,GAAIC,GAAwBF,EAAyBC,GACjDK,EAAOJ,EAAsBqE,KAC7BnE,EAASF,EAAsBsE,OAE/BhE,EAAkBT,EAAqBK,EAC3CI,GAAgB2B,UAAY/B,EAAO+B,UACnCT,OAAOC,eAAevB,EAAO+B,UAAWyC,IACpC9C,MAAOtB,EACPuB,UAAA,EACAC,cAAA,IAEJJ,OAAOtB,GAAQE,GAErB,MAAOT,GACL,QAIR,QAASwB,KAEL,IAAK,GADDxB,GAA2BoE,IACtBnE,EAAI,EAAGA,EAAID,EAAyBgB,OAAQf,IAAK,CACtD,GAAIC,GAAyBF,EAAyBC,GAClDE,EAAOD,EAAuBsE,KAC9BjE,EAASL,EAAuBuE,OAEhCpE,EAAkByE,GACtBzE,GAAgB+B,UAAY7B,EAAO6B,UACnCT,OAAOC,eAAerB,EAAO6B,UAAWyC,IACpC9C,MAAO1B,EACP2B,UAAA,EACAC,cAAA,IAEJJ,OAAO1B,GAAQE,EAEnB,MAAOL,GAGX,QAAS8D,GAA0B9D,GAC/B,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAyBgB,OAAQf,IAAK,CACtD,GAAIC,GAAyBF,EAAyBC,GAClDE,EAAOD,EAAuBsE,KAC9BjE,EAASL,EAAuBuE,OAChCpE,EAAeH,EAAuBwE,WAE1C/C,QAAOC,eAAerB,EAAO6B,UAAWyC,IACpC9C,MAAO1B,EACP2B,UAAA,EACAC,cAAA,IAEJJ,OAAO1B,GAAQI,GAIvB,QAASuE,KACL,MAAO,SAAS9E,KACZ,GAAIC,GAAgB0B,OAAOoD,eAAeC,MAGtC9E,EAAW2B,OAAOC,GAClB3B,EAAgB0D,EAAgB3D,EAGpC,IAAID,EAAcyE,cAAgB1E,EAC9B,KAAM,IAAIiF,WAAU,sBAKxB,KAAK,GADD1E,GAAa,OACRF,EAAI,EAAGA,EAAIF,EAAc+E,YAAYlE,OAAQX,IAAK,CACvD,GAAII,GAAUN,EAAc+E,YAAY7E,EACxC,IAAII,EAAQiE,cAAgBzE,EAAcyE,YAAa,CACnDnE,EAAaE,CACb,QAGR,IAAKF,EACD,KAAM,IAAI0E,UAKd,IAAIjF,IAAoBO,EAAW4E,gBAE/B,KAAM,IAAIF,WAAU,sBAIxB,IAAIpE,GAAYZ,EAMZK,EAAoBC,EAAW6E,iBACnC,IAAiC,IAA7B9E,EAAkBU,OAAc,CAChC,GAAIqE,GAAWtB,EAAoBhD,KAAKc,OAAOiB,SAAUvC,EAAW+E,UAMpE,OALAC,GAAQlE,QAAQmE,eAAeH,EAAUxE,GACzCoD,EAAgBoB,GACZI,mBAAoBC,EACpBC,wBAAyBpF,IAEtB8E,EAGX,GAAIjF,GAAYE,EAAkBU,OAAS,EAEvC4E,EAAUtF,EAAkBF,EAEhC,IAAIwF,IAAYC,EACZ,KAAMN,GAAQlE,QAAQyE,iBAAiB,oBAAqB,+CAOhE,OAJAP,GAAQlE,QAAQmE,eAAeI,EAAS/E,GAExCP,EAAkBF,GAAayF,EAExBD,GAMf,QAASG,GAAgB/F,EAAUC,EAAsBC,EAAWC,EAAQI,EAAIF,GAC5EE,EAAKA,GAAM,IACX,IAAIE,GAAS,KACTI,EAAamF,EAA8BhG,EAAUE,EAAWD,EAAsBM,EAC1F,IAAIM,GAAcA,EAAW2D,MAAQ3D,EAAWyE,UAC5C7E,EAASsD,EAAoBhD,KAAKf,EAAUC,GAC5CgE,EAAgBxD,GACZgF,mBAAoBQ,EACpBN,wBAAyB,KACzBO,QAAS3F,IAETF,EACA8F,EAAe1F,EAAQI,GAEvBuF,EAAuB3F,EAAQI,OAEhC,IAAIA,EACP,GAAIR,EACA,IAEI,GADAI,EAAS,GAAII,GAAW6D,cAClBjE,YAAkB4F,cACpB,KAAM,IAAIpB,WAAU,sBAExB,IAAiC,IAA7BxE,EAAO6F,WAAWtF,QAAgBP,EAAO8F,iBAAmB9F,EAAO+F,YAAc/F,EAAOgG,gBAAkBzG,GAAYS,EAAOiG,eAAiBC,GAAiBlG,EAAO6E,YAAcrF,EAAsB,CAC1M,GAAIK,GAAQ,GAAIK,OAAM,gEAEtB,MADAL,GAAMkE,KAAO,oBACPlE,GAEZ,MAAOJ,GACLqF,EAAQlE,QAAQuF,YAAY1G,GAC5BO,EAASsD,EAAoBhD,KAAKf,EAAUC,GAE5CgE,EAAgBxD,GACZgF,mBAAoBoB,QAI5BpG,GAASsD,EAAoBhD,KAAKf,EAAUC,GAC5CsF,EAAQlE,QAAQmE,eAAe/E,EAAQ4F,YAAYjE,WACnDgE,EAAuB3F,EAAQI,OAGnCJ,GAASP,EAAY8D,EAAsBjD,KAAKf,EAAUE,EAAWD,GAAwB8D,EAAoBhD,KAAKf,EAAUC,EAIpI,OAAOQ,GAGX,QAAS4B,GAAcrC,EAAWC,GAC9B,GAAIC,GAAY,IAEhBF,GAAYA,EAAU8G,cACtB5G,EAAYyG,CAEZ,IAAIxG,GAAKF,EAAUA,EAAQ8G,IAAM,KAAO,KACpCxG,EAAUwF,EAAgBf,KAAMhF,EAAWE,EAAW,KAAMC,GAAA,EAIhE,OAHU,OAANA,GACAI,EAAQyG,aAAaC,GAAc9G,GAEhCI,EAGX,QAAS+B,GAAgBtC,EAAWC,EAAeC,GAC/C,GAAIC,GAAKD,EAAUA,EAAQ6G,IAAM,KAAO,KACpCxG,EAAUwF,EAAgBf,KAAM/E,EAAeD,EAAW,KAAMG,GAAA,EAIpE,OAHU,OAANA,GACAI,EAAQyG,aAAaC,GAAc9G,GAEhCI,EAKX,QAAS2G,GAASlH,GACd,GAAIA,EAAKyC,UAAYC,KAAKC,aACtB,OAAA,CAEJ,IAAI1C,GAAY4D,EAAgB7D,EAChC,SAAKC,GAGEA,EAAUwF,qBAAuBC,EAG5C,QAASyB,GAAyBnH,GAE9B,OAAQA,GACJ,IAAK,iBACL,IAAK,gBACL,IAAK,YACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,gBACD,OAAA,EAGR,GAAIC,GAAaD,EAAUgB,MAE3B,IAAIf,EAAa,EACb,OAAA,CAGJ,IAAIC,GAAYF,EAAUoH,WAAW,EACrC,IAAIlH,EAAY,IAAgBA,EAAY,IACpC,OAAA,CAKR,KAAK,GAFDC,IAAA,EAEKI,EAAI,EAAGA,EAAIN,EAAYM,IAAK,CACjC,GAAIF,GAAOL,EAAUoH,WAAW7G,EAChC,MAAIF,GAAQ,IAAgBA,GAAQ,KAGpC,GAAa,KAATA,GAIJ,GAAa,KAATA,GAAkC,KAATA,GAAkC,MAATA,KAGlDA,GAAQ,IAAgBA,GAAQ,IAApC,CAGA,GAAIA,EAAO,IACP,OAAA,CAEJ,MAAIA,GAAQ,KAAQA,GAAQ,KAGxBA,GAAQ,KAAQA,GAAQ,KAGxBA,GAAQ,KAAQA,GAAQ,KAGxBA,GAAQ,KAASA,GAAQ,MAGzBA,GAAQ,MAAUA,GAAQ,MAG1BA,GAAQ,MAAUA,GAAQ,MAG1BA,GAAQ,MAAUA,GAAQ,MAG1BA,GAAQ,OAAUA,GAAQ,OAG1BA,GAAQ,OAAUA,GAAQ,OAG1BA,GAAQ,OAAUA,GAAQ,OAG1BA,GAAQ,OAAUA,GAAQ,OAG1BA,GAAQ,OAAWA,GAAQ,QAG/B,OAAA,OAhDQF,IAAA,EAmDZ,MAAOA,GAGX,QAAS6F,GAA8BhG,EAAUC,EAAWC,EAAWC,GACnE,GAAIF,IAAc0G,EACd,MAAO,KAEX,KAAK3G,EAASqH,YACV,MAAO,KAIX,KAAK,GAFD9G,GAAWP,EAASqH,YAAYC,eAChCjH,EAAewD,EAAgBtD,GAC1BE,EAAI,EAAGA,EAAIJ,EAAa6E,YAAYlE,OAAQP,IAAK,CACtD,GAAII,GAAaR,EAAa6E,YAAYzE,EAC1C,IAAII,EAAWyE,YAAcpF,IACrBW,EAAW2D,OAAStE,GAAaW,EAAW2D,OAASrE,GACrD,MAAOU,GAInB,MAAO,MAGX,QAASa,KACLuC,EAAgBe,MACZE,eACAqC,4BAAA,EACAC,2BA8HR,QAASrB,GAAenG,EAASC,GAE7B,GAAIC,GAAe2D,EAAgB7D,EACnC,IAAKE,GAKE,GAAIuH,EAAiBvH,GACxB,WALAA,GAAe+D,EAAgBjE,GAC3B0H,iBACA/B,wBAAyB1F,GAMjC,KAAK,GADDE,GAAaH,EAAQsG,WAChB/F,EAAI,EAAGA,EAAIJ,EAAWa,OAAQT,IAAK,CACxC,GAAIF,GAAYF,EAAWI,GACvBE,GAAQJ,EAAUiF,UAAW,KAAMjF,EAAU0B,MAAO1B,EAAUqG,aAClEiB,GAAwB3H,EAAS4H,GAA+BnH,GAEhET,EAAQ6H,aACRF,EAAwB3H,EAAS8H,MAErC7H,EAAWmF,kBAAkB/B,KAAKrD,EAClC,IAAIa,GAAS,IACb,KACI,GAAIP,GAAkB,GAAIL,GAAWyE,WACrC,IAAIpE,IAAoBN,EACpB,KAAMuF,GAAQlE,QAAQyE,iBAAiB,qBAE7C,MAAO7F,GACLY,EAASZ,QACFD,GAAQoC,UACflC,EAAauF,mBAAqBoB,EAClC3G,EAAayF,wBAA0B,KACvCzF,EAAawH,cAAcK,OAAO,EAAG7H,EAAawH,cAAc1G,QAGpE,GADAf,EAAWmF,kBAAkB4C,MACzBnH,EACA,KAAMA,EAEVX,GAAauF,mBAAqBC,EAGtC,QAAS9C,GAAwB5C,GAC7B,GAAIC,GAAe4D,EAAgB7D,GAC/BE,EAAU,IACd,IAAID,EAAc,CACd,GAAIwH,EAAiBxH,GACjB,MAEJC,GAAUD,EAAaiG,QAE3B,GAAI/F,GAAa6F,EAA8BhG,EAAQyG,cAAezG,EAAQ0G,aAAc1G,EAAQsF,UAAWpF,EAC3GC,IACAgG,EAAenG,EAASG,GAIhC,QAAS8H,GAAoBjI,GACzB,GAAIC,GAAe4D,EAAgB7D,GAC/BE,EAAU,IACd,IAAID,EAAc,CACd,GAAIwH,EAAiBxH,GACjB,MAEJC,GAAUD,EAAaiG,QAE3B,GAAI/F,GAAa6F,EAA8BhG,EAAQyG,cAAezG,EAAQ0G,aAAc1G,EAAQsF,UAAWpF,EAC3GC,IACAiG,EAAuBpG,EAASG,GAIxC,QAAS+H,GAAwClI,GAC7C,GAAIC,GAAekE,EAAgBtC,OACnC,IAAK5B,EAAL,CAKA,GAAIC,GAAQD,EAAauD,2BACzB,IAAqB,IAAjBtD,EAAMc,OAAc,CAIpB,GAFAf,EAAawD,mBAAmBJ,KAAKrD,GAEjCC,EAAayD,6BACb,MAGJzD,GAAayD,8BAAA,EAEb6B,EAAQlE,QAAQ8G,aAAa,WAEzBC,EAAgBnI,EAAawD,oBAE7BxD,EAAayD,8BAAA,QAKbxD,GAAMA,EAAMc,OAAS,GAAGqC,KAAKrD,IAIzC,QAAS2H,GAAwB3H,EAASC,EAAcC,GAEpD,GAAIC,GAAe0D,EAAgB7D,GAC/BO,EAAaJ,EAAawF,wBAC1BtF,EAAWE,EAAW8H,mBAAmBpI,EAC7C,IAAgB,MAAZI,EAAJ,CAGA,GAAIJ,IAAiB2H,GAA+B,CAChD,GAAInH,GAAgBP,EAAK,EACzB,IAAIK,EAAW+H,mBAAmBC,QAAQ9H,MAAA,EACtC,OAGHN,EAAauH,gBACdvH,EAAauH,kBAEjBvH,EAAauH,cAAcrE,MAAOmF,KAAMC,EAAsBC,SAAUrI,EAAUsI,KAAMzI,IACxFgI,EAAwClI,IAG5C,QAAS4I,GAAyB5I,EAASC,GACvC0H,EAAwB3H,EAAS8H,EAAuB7H,GAG5D,QAAS4I,GAA4B7I,EAASC,GAC1C0H,EAAwB3H,EAAS8I,EAA0B7I,GAG/D,QAAS8I,GAAuB/I,EAASC,GACrC0H,EAAwB3H,EAASgJ,GAAqB/I,GAG1D,QAASgJ,GAAgCjJ,EAASC,GAC9C0H,EAAwB3H,EAAS4H,GAA+B3H,GAGpE,QAASmG,GAAuBpG,EAASC,GAErC,GAAIC,GAAe2D,EAAgB7D,IAAYiE,EAAgBjE,GAAW0H,kBAC1ExH,GAAayF,wBAA0B1F,EACvCC,EAAawH,cAAcrE,MAAOmF,KAAMU,EAAqBC,WAAYlJ,IACzEiI,EAAwClI,GAG5C,QAASoI,GAAgBpI,GAErB,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAMgB,OAAQf,IAG9B,IAFA,GAAIC,GAAYF,EAAMC,GAClBE,EAAY0D,EAAgB3D,GAAWwH,cACpCvH,EAAUa,QACb,IACI,GAAIT,GAAaJ,EAAU4H,OAAO,EAAG,GACjC1H,EAAWE,EAAW,EAC1B,QAAQF,EAASmI,MACb,IAAKU,GACD/C,EAAejG,EAAWG,EAAS8I,WACnC,MACJ,KAAKV,GACDpI,EAASqI,SAASU,MAAMlJ,EAAWG,EAASsI,OAGtD,MAAO3I,GACLuF,EAAQlE,QAAQuF,YAAY5G,IAM5C,QAASqJ,GAAmBrJ,GACxB,GAAIC,GAAekE,EAAgBtC,OACnC,IAAI5B,EAAc,CACd,GAAIC,GAAQD,EAAauD,2BACzBtD,GAAMmD,QACN,IAAIlD,GAASH,GAEb,OADAoI,GAAgBlI,EAAM8H,OACf7H,EAEX,MAAOH,KAKX,QAASyH,GAAiBzH,GACtB,MAAOA,KAAiBA,EAAayF,qBAAuBC,GAAmB1F,EAAayF,qBAAuBoB,GAGvH,QAASyC,GAAYtJ,EAAWC,GAC5B,GAAIC,GAAWF,EAAUC,EACzB,OAAIC,IAAgC,kBAAbA,GACZA,EAEJ,KAGX,QAAS2D,GAAgB7D,GACrB,MAAOA,GAAOuJ,QAGlB,QAAStF,GAAgBjE,EAAQC,GAC7B,MAAOD,GAAOuJ,QAAUtJ,EAG5B,QAASkE,GAAgBnE,GACrB,MAAOA,GAAOuJ,QAGlB,QAAS5F,GAAgB3D,EAAQC,GAC7BD,EAAOuJ,QAAUtJ,EAGrB,QAASmD,GAAgCpD,EAAMC,GAC3CA,EAASD,EACT,IAAIE,GAAaF,EAAKwJ,UAClBtJ,IACAkD,EAAgClD,EAAYD,EAGhD,KAAK,GADDE,GAAaH,EAAKyJ,WACblJ,EAAI,EAAGA,EAAIJ,EAAWa,OAAQT,IACnC6C,EAAgCjD,EAAWI,GAAIN,GA1zBvD0B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAI2H,GAASlJ,EAAQ,cAEjB+E,EAAUpE,EAAuBuI,GAUjCnF,EAAoB1C,OAAOwE,YAE3BtC,EAAsB5B,SAASC,UAAUC,cACzC2B,EAAwB7B,SAASC,UAAUE,gBAC3CC,EAAyBV,OAAO8H,iBAGhChD,GAF4BpB,EAAQlE,QAAQuI,WAAWlH,KAAM,eAE7C,gCAChBmD,EAA2B,EAC3BqD,EAAsB,EACtBT,EAAuB,EACvB5B,EAAkB,SAClBnB,EAAkB,SAClBO,EAAqB,YACrBnE,EAAe,iBACfgG,EAAwB,oBACxBgB,EAA2B,uBAC3BE,GAAsB,kBACtBpB,GAAgC,2BAChC1E,GAAqB,mBACrB2B,GAAiB,cACjBoC,GAAe,KAEf4C,GAAgB/H,IAAgBD,QAChCiI,GAAoB,WAAajI,OAErCf,GAAQO,SACJwI,cAAeA,GACfvI,QAASA,EACTsC,UAAWA,EACXM,YAAaA,EACbS,8BAA+BA,EAC/BuC,SAAUA,EACVe,oBAAqBA,EACrBW,yBAA0BA,EAC1BC,4BAA6BA,EAC7BE,uBAAwBA,EACxBE,gCAAiCA,EACjCI,mBAAoBA,EACpBlC,yBAA0BA,GA4a9BzF,EAAsBU,WAClB2H,OAAQ,SAAgB/J,EAAMC,EAAaC,GACvC,GAAIC,GAAe0D,EAAgBmB,KACnC,IAAI/E,IAAgBA,EAAYmC,UAAUsC,YACtC,KAAM,IAAIO,WAAU,4CAExB,KAAKkC,EAAyBnH,GAC1B,KAAMuF,GAAQlE,QAAQyE,iBAAiB,cAI3C,IAAIvF,GAAYP,EACZK,EAAcH,EAAUA,EAAQ8J,QAAU,KAC1CvJ,EAAkBoB,OAAOwE,WAC7B,IAAmB,MAAfhG,EAAqB,CACrB,GAAI8G,EAAyB9G,GACzB,KAAMkF,GAAQlE,QAAQyE,iBAAiB,oBAE3C,IAAIjF,GAAckD,EAAoBhD,KAAKc,OAAOiB,SAAUzC,EACxDQ,aAAuBoJ,oBAG3B1J,EAAYF,EACZI,EAAkBkB,OAAOoD,eAAelE,GAAa6D,YAEzD,GAAIvE,EAAaoH,2BACb,KAAMhC,GAAQlE,QAAQyE,iBAAiB,oBAE3C3F,GAAaoH,4BAAA,CACb,IAAIjH,GAAS,KACT+E,KACAjF,EAAqB,MAEzB,KACI,GAAIwF,GAAY3F,EAAYmC,SAC5B,MAAMwD,YAAqBjE,SACvB,KAAM,IAAIsD,WAAU,oBAOxB,IALA7E,KACAA,EAAmB0H,GAAyBwB,EAAY1D,EAAWkC,GACnE1H,EAAmB0I,GAA4BQ,EAAY1D,EAAWkD,GACtE1I,EAAmB4I,IAAuBM,EAAY1D,EAAWoD,IACjE5I,EAAmBwH,IAAiC0B,EAAY1D,EAAWgC,IACvExH,EAAmBwH,IAAgC,CACnD,GAAIsC,GAA6BjK,EAAYqI,kBACzC4B,KACA7E,EAAqB6E,EAA2BC,UAG1D,MAAOnK,GACLM,EAASN,EAGb,GADAG,EAAaoH,4BAAA,EACTjH,EACA,KAAMA,EAEV,IAAI8J,IACA5F,KAAMxE,EACNsF,UAAW/E,EACXmE,YAAazE,EACbqI,mBAAoBjD,EACpBgD,mBAAoBjI,EACpBgF,qBACAD,gBAAiB1E,EAErBN,GAAa+E,YAAY7B,KAAK+G,EAC9B,IAAI1J,GAAWmB,OAAOiB,QACtBM,GAAgC1C,EAAU,SAAUV,GAChD,GAAIA,EAAKyC,WAAaC,KAAKC,cAAgB3C,EAAK0G,eAAiBC,GAAiB3G,EAAKsF,YAAc/E,EAAW,CAC5G,GAAIF,EAAa,CACb,GAAIJ,GAAY4D,EAAgB7D,EAChC,IAAIC,EAAUiG,UAAY7F,EACtB,OAGR+F,EAAuBiE,QAASD,KAGxC,IAAIE,GAAQnK,EAAaqH,sBAAsBxH,EAC3CsK,IACA/E,EAAQlE,QAAQ8G,aAAa,WACzBmC,EAAMC,UACNpK,EAAaqH,sBAAsBxH,GAAQ,QAIvDwK,IAAK,SAAaxK,GAEd,IAAK,GADDC,GAAe4D,EAAgBmB,MAC1B9E,EAAI,EAAGA,EAAID,EAAaiF,YAAYlE,OAAQd,IAAK,CACtD,GAAIC,GAAaF,EAAaiF,YAAYhF,EAC1C,IAAIC,EAAWqE,OAASxE,EACpB,MAAOG,GAAWuE,cAK9B+F,YAAa,SAAqBzK,GAC9B,IAAK8J,GACD,KAAM,IAAInJ,OAAM,qCAEpB,KAAKwG,EAAyBnH,GAC1B,KAAMuF,GAAQlE,QAAQyE,iBAAiB,cAAe,8BAG1D,KAAK,GADD7F,GAAe4D,EAAgBmB,MAC1B9E,EAAI,EAAGA,EAAID,EAAaiF,YAAYlE,OAAQd,IAAK,CACtD,GAAIC,GAAaF,EAAaiF,YAAYhF,EAC1C,IAAIF,IAASG,EAAWqE,KACpB,MAAOkG,SAAQH,UAGvB,GAAIhK,GAAQN,EAAauH,sBAAsBxH,EAQ/C,OAPKO,KACDA,GAAUoK,QAAS,KAAMJ,QAAS,MAClChK,EAAMoK,QAAU,GAAID,SAAQ,SAAU1K,EAASC,GAC3CM,EAAMgK,QAAUvK,IAEpBC,EAAauH,sBAAsBxH,GAAQO,GAExCA,EAAMoK,iDC3lBrB,YAcA,SAASxJ,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GA8EvF,QAAS4K,GAAiC5K,EAAMC,GAC5C,GAAIE,GAAc,KACdD,EAAa,MACZC,EAAcoF,GAAQlE,QAAQwJ,eAAe7K,MAAWE,EAAaC,EAAYqJ,cAClFvJ,EAAOC,GACP4K,EAA0C5K,EAAYD,GAG1D,KAAK,GADDM,GAAaP,EAAKyJ,WACb5I,EAAI,EAAGA,EAAIN,EAAWS,OAAQH,IAAK,CACxC,GAAIR,GAAYE,EAAWM,EAC3BZ,GAAOI,GACPyK,EAA0CzK,EAAWJ,IAI7D,QAAS6K,GAA0C9K,EAAMC,GACrDA,EAAOD,EACP,IAAIG,GAAc,KACdD,EAAa,MACZC,EAAcoF,GAAQlE,QAAQwJ,eAAe7K,MAAWE,EAAaC,EAAYqJ,aAClFsB,EAA0C5K,EAAYD,EAG1D,KAAK,GADDM,GAAaP,EAAKyJ,WACb5I,EAAI,EAAGA,EAAIN,EAAWS,OAAQH,IACnCiK,EAA0CvK,EAAWM,GAAIZ,GAIjE,QAAS8K,GAA4B/K,EAAMC,EAASE,GAC5CA,EAAMH,KACNC,EAAQA,EAAQe,QAAUhB,EAE9B,IAAIE,GAAaF,EAAKgL,UAClB9K,IACA6K,EAA4B7K,EAAYD,EAASE,EAErD,IAAII,GAAcP,EAAKiL,WACnB1K,IACAwK,EAA4BxK,EAAaN,EAASE,GAI1D,QAAS+K,GAA8BlL,EAAMC,GACzC,GAAIA,EAAMD,GACN,MAAOA,EAEX,IAAIG,GAAaH,EAAKgL,UACtB,IAAI7K,EAAY,CACZ,GAAID,GAASgL,EAA8B/K,EAAYF,EACvD,IAAIC,EACA,MAAOA,GAGf,GAAIK,GAAcP,EAAKiL,WACvB,OAAI1K,GACO2K,EAA8B3K,EAAaN,GAE/C,KAGX,QAASkL,GAAanL,EAAMC,GAIxB,IAAK,GAHDE,GAAciL,EAAKpL,GACnBE,EAAW,GAAImL,OAAMpL,EAAYe,QACjCT,EAAgB,EACXM,EAAI,EAAGA,EAAIZ,EAAYe,OAAQH,IAAK,CACzC,GAAIR,GAAOJ,EAAYY,EACnBuK,GAAK/K,KAAUF,IACfD,EAASK,KAAmBF,GAIpC,MADAH,GAASc,OAAST,EACXL,EAGX,QAASoL,GAAatL,GAClB,MAAOA,GAAKuL,WAAaC,GAS7B,QAASC,GAAkBzL,EAAQC,GAC/B,GAAIE,GAAWF,EAAQwG,cACnBvG,EAAgBqF,GAAQlE,QAAQwJ,eAAe1K,IAAaoF,GAAQlE,QAAQqK,eAAevL,MAC3FI,EAAiBL,EAAcyL,cAC9BpL,KACDA,EAAiBL,EAAcyL,eAAiBxL,EAASkC,cAAc,OAE3E,IAAIxB,GAAkBX,EAAc0L,eAC/B1L,GAAc0L,kBACf/K,EAAkBX,EAAc0L,gBAAkBzL,EAAS0L,0BAE/DC,GAA2BC,IAAIhL,KAAKR,EAAgBP,EAEpD,KADA,GAAIK,GAAa,OACVA,EAAa2L,GAAyBxB,IAAIzJ,KAAKR,IAClD0L,GAA0BlK,MAAMhB,KAAKF,EAAiBR,EAE1D,OAAOQ,GAGX,QAASqL,GAAsBlM,GAoF3B,QAASC,GAAaD,EAAQC,GAC1B,MAAKD,IAAWA,EAAOgB,QAIvBhB,EAASA,EAAOmM,QAAQ,IAAK,SAC7BnM,EAASA,EAAOmM,QAAQ,IAAQ,UAE5BlM,EACAD,EAASA,EAAOmM,QAAQ,IAAK,WAE7BnM,EAASA,EAAOmM,QAAQ,IAAK,QAC7BnM,EAASA,EAAOmM,QAAQ,IAAK,SAG1BnM,GAbIoM,GAgBf,QAASjM,GAAuBH,GAC5B,GAAIC,GAAeD,EAAU0G,aACzBvG,EAAYH,EAAUsF,SAC1B,KAAKrF,EACD,MAAOE,EAEX,QAAQF,GACJ,IAAKoM,IACD,MAAO,OAASlM,CACpB,KAAKmM,IACD,MAAkB,UAAdnM,EACOA,EAEJ,SAAWA,CACtB,KAAKoM,IACD,MAAO,SAAWpM,CACtB,SACI,MAAOH,GAAUwE,MAnH7B,GAAItE,GAAIkM,EAIR,IAAuB,aAAnBpM,EAAKsF,UAA0B,CAC/B,GAAI/E,GAAUP,EAAKwM,OACfjM,KACAP,EAAOO,GAMf,IAAK,GADDM,GAAab,EAAKyJ,WACbpJ,EAAI,EAAGA,EAAIQ,EAAWG,OAAQX,IAAK,CAExC,GAAID,GAAcS,EAAWR,EAE7B,QAAQD,EAAYqC,UAChB,IAAKC,MAAKC,aACN,GAAIlC,GAAU,MACd,QAAQL,EAAYsG,cAChB,IAAK+F,IACL,IAAKC,IACL,IAAKC,IACDlM,EAAUL,EAAYkF,SACtB,MACJ,SACI7E,EAAUL,EAAYwM,cAG9B1M,GAAK,IAAMO,CAEX,KAAK,GADDH,GAAauM,GAA4BrC,IAAIzJ,KAAKX,GAC7CiF,EAAI,EAAGA,EAAI/E,EAAWU,OAAQqE,IAAK,CACxC,GAAI+E,GAAY9J,EAAW+E,EAC3BnF,IAAK,IAAMC,EAAuBiK,GAClClK,GAAK,KAAOD,EAAamK,EAAUrI,OAAS,IAGhD,OADA7B,GAAK,IACGE,EAAYkF,WAChB,IAAK,OAAO,IAAK,OAAO,IAAK,WAAW,IAAK,UAC7C,IAAK,KAAK,IAAK,MAAM,IAAK,QAAQ,IAAK,QAAQ,IAAK,KACpD,IAAK,MAAM,IAAK,QAAQ,IAAK,SAAS,IAAK,OAAO,IAAK,OACvD,IAAK,QAAQ,IAAK,SAAS,IAAK,QAAQ,IAAK,MACzC,QACJ,KAAK,MAAM,IAAK,WAAW,IAAK,UAC5B,GAAI5E,GAAaN,EAAY4K,UACzBtK,IAAcA,EAAW+B,WAAaC,KAAKoK,WAAoC,OAAvBpM,EAAWqM,KAAK,KACxE7M,GAAK,MAIjBA,GAAKgM,EAAsB9L,GAC3BF,GAAK,KAAOO,EAAU,GACtB,MACJ,KAAKiC,MAAKoK,UACN,OAAQ1M,EAAYoG,WAAWlB,WAC3B,IAAK,QAAQ,IAAK,SAAS,IAAK,MAAM,IAAK,SAC3C,IAAK,UAAU,IAAK,WAAW,IAAK,YAAY,IAAK,WACjDpF,GAAKE,EAAY2M,IACjB,MACJ,SACI7M,GAAKD,EAAaG,EAAY2M,MAGtC,KACJ,KAAKrK,MAAKsK,aACN9M,GAAK,OAASE,EAAY2M,KAAO,KACjC,MACJ,KAAKrK,MAAKuK,4BACN/M,GAAK,KAAOE,EAAY8M,OAAS,IAAM9M,EAAY2M,KAAO,GAC1D,MACJ,KAAKrK,MAAKyK,mBACNjN,GAAK,aAAeE,EAAYoE,KAAO,KAMnD,MAAOtE,GA4CX,QAASkL,GAAKpL,GAIV,IAHA,GAAIC,GAAOD,EACPG,EAASF,EAAKuG,WAED,MAAVrG,GACHF,EAAOE,EACPA,EAASF,EAAKuG,UAGlB,OAAOvG,GAoBX,QAASmN,GAASpN,EAAOC,GAGrB,IAFA,GAAIE,GAASF,EAAMuG,WAEF,MAAVrG,GAAgB,CACnB,GAAIH,IAAUG,EACV,OAAA,CAEJA,GAASA,EAAOqG,WAGpB,OAAA,EAGJ,QAAS6G,GAAkBrN,EAAOC,GAC9B,MAAOD,KAAUC,GAASmN,EAASpN,EAAOC,GAK9C,QAASqN,GAAsBtN,EAAOC,GAGlC,IAAK,GAFDE,GAAO,KAEFD,EAAI,EAAGA,EAAIF,EAAMgB,OAAQd,IAAK,CACnC,GAAIK,GAAOP,EAAME,EAEG,iBAATK,KACPP,EAAME,GAAKD,EAASsN,eAAehN,IAI3C,GAAqB,IAAjBP,EAAMgB,OACNb,EAAOH,EAAM,OACV,CACHG,EAAOF,EAAS4L,wBAEhB,KAAK,GAAIhL,GAAK,EAAGA,EAAKb,EAAMgB,OAAQH,IAChCV,EAAKqN,YAAYxN,EAAMa,IAI/B,MAAOV,GAKX,QAASsN,GAAMzN,EAAMC,EAAUE,GAK3BF,EAAWA,GAAYD,EAAKyG,aAW5B,IAAIvG,GAAOwN,GAAwB3L,MAAMhB,KAAKf,GAAA,EAQ9C,IAPI2N,GAAiBtM,QAAQ6C,eACzByJ,GAAiBtM,QAAQ4G,oBAAoB/H,GAM7CC,KAAA,EAEA,IAAK,GADDI,GAAaP,EAAKyJ,WACb5I,EAAI,EAAGA,EAAIN,EAAWS,OAAQH,IACnC+M,EAAOrN,EAAWM,GAAGgN,WAAA,GAAiB3N,EAI9C,OAAOA,GAGX,QAAS4N,GAAM9N,EAAMC,GAIjB,GAAIE,GAAcH,EAAKyG,cAGnBvG,EAASF,EAAKwG,UACJ,OAAVtG,GACA6N,GAAO/N,EAAME,GAIbD,GAAYE,GAAewN,GAAiBtM,QAAQ6C,eACpD4G,EAA0C9K,EAAM,SAAUA,GAClD2N,GAAiBtM,QAAQ6F,SAASlH,IAClC2N,GAAiBtM,QAAQ0H,uBAAuB/I,GAAsBG,EAAaF,MAQnG,QAAS+N,GAA+BhO,EAAOC,GAC3C,GAAIoN,EAAkBrN,EAAOC,GACzB,OAAA,CAGJ,IAAIE,GAAOiL,EAAKnL,GAAOgO,IAEvB,UAAI9N,IAAQ6N,EAA+BhO,EAAOG,IAStD,QAAS+N,GAAoBlO,GACzB,GAAIC,GAAWmL,EAAKpL,EAIpB,OAHIsL,GAAarL,KACbA,EAAWiO,EAAoBjO,EAASgO,OAErChO,EAGX,QAASkO,GAA0BnO,EAAOC,GACtC,EAMI,IAJID,EADAsL,EAAatL,GACLA,EAAMiO,KAENjO,EAAMwG,WAEdxG,IAAUC,EACV,OAAA,QAEU,MAATD,EAET,QAAA,EAOJ,QAASoO,GAAwBpO,EAAOC,GACpC,MAAOkO,GAA0BlO,EAAOD,GAG5C,QAASqO,GAAiCrO,EAAOC,GAC7C,MAAOD,KAAUC,GAASmO,EAAwBpO,EAAOC,GAG7D,QAASqO,GAAmBtO,EAAOC,GAE/B,GAAIE,GAAWiL,EAAKpL,EAEpB,UAAKsL,EAAanL,IAIdkO,EAAiClO,EAAUF,IAI3CE,EAASoO,OAASC,KAAsBF,EAAmBnO,EAAS8N,KAAMhO,IAOlF,QAASwO,GAASzO,EAAOC,GAMrB,IADA,GAAIE,GAAW,OACRA,EAAWiL,EAAKpL,IAAQ,CAG3B,IAAKsL,EAAanL,IAAakO,EAAiClO,EAAUF,GACtE,MAAOD,EAGXA,GAAQG,EAAS8N,MAMzB,QAASS,GAAe1O,EAASC,EAAWE,EAAUD,EAAOK,GAEzD,GAAIP,EAAQsF,YAAcqJ,IAClB1O,IAAc2O,IAA0B,MAAbrO,EAAmB,CAC9C,GAAIL,IAAUC,EACV,MAEJ,IAAa,MAATD,GAAiBC,IAAaiM,GAC9B,MAEJ,IAAIlM,IAAUkM,IAA4B,MAAZjM,EAC1B,MAES,OAATD,GAAiBA,IAAUkM,GAC3ByC,GAA8B9M,MAAMhB,KAAKf,EAAS4O,GAAWxC,IAE7DyC,GAA8B9M,MAAMhB,KAAKf,EAAS4O,GAAW1O,GAEjE4O,EAAwB9O,IAKpC,QAAS+O,GAAmB/O,EAASC,EAAWE,EAAUD,EAAOK,GAE7D,GAAIN,IAAc0O,IAAyB,MAAbpO,EAAmB,CAC7C,GAAIL,IAAUC,EACV,MAEJ,IAAa,MAATD,GAAiBC,IAAaiM,GAC9B,MAEJ,IAAIlM,IAAUkM,IAA4B,MAAZjM,EAC1B,MAES,OAATD,GAAiBA,IAAUkM,GAC3ByC,GAA8B9M,MAAMhB,KAAKf,EAAS2O,GAAUvC,IAE5DyC,GAA8B9M,MAAMhB,KAAKf,EAAS2O,GAAUzO,EAEhE,IAAIW,GAAe0E,GAAQlE,QAAQwJ,eAAe7K,EAC9Ca,IAAgBA,EAAamO,cAC7BC,EAAgBpO,EAAamO,cAEjCE,EAAYlP,IAIpB,QAASmP,GAAqBnP,EAASC,EAAWE,EAAUD,EAAOK,GAC/DmO,EAAe1O,EAASC,EAAWE,EAAUD,EAAOK,GACpDwO,EAAmB/O,EAASC,EAAWE,EAAUD,EAAOK,GAG5D,QAAS6O,GAAgBpP,EAAWC,EAASE,GAGzC,GAAID,GAAOF,EAAUsF,UACjB/E,EAAYP,EAAU0G,aACtB7F,EAAWwO,GAAoB7E,IAAIzJ,KAAKf,GACxCK,EAAWF,CAMf,IAHAmP,GAAoBC,GAAoBtP,EAASC,EAAMK,EAAWM,GAG9D8M,GAAiBtM,QAAQ6C,eAAiByJ,GAAiBtM,QAAQ6F,SAASjH,GAAU,CACtF,GAAIG,IAAQF,EAAMW,EAAUR,EAAUE,EACtCoN,IAAiBtM,QAAQ4H,gCAAgChJ,EAASG,GAItE+O,EAAqBlP,EAASC,EAAMW,EAAUR,EAAUE,GAGxD8O,GAAoBtD,IAAIhL,KAAKf,EAAWK,GAG5C,QAASmP,GAAgBxP,EAAWC,GAGhC,GAAIE,GAAOH,EAAUsF,UACjBpF,EAAYF,EAAU0G,aACtBnG,EAAW,KACXM,EAAWwO,GAAoB7E,IAAIzJ,KAAKf,EAM5C,IAHAsP,GAAoBC,GAAoBtP,EAASE,EAAMD,EAAWK,GAG9DoN,GAAiBtM,QAAQ6C,eAAiByJ,GAAiBtM,QAAQ6F,SAASjH,GAAU,CACtF,GAAII,IAAQF,EAAMI,EAAUM,EAAUX,EACtCyN,IAAiBtM,QAAQ4H,gCAAgChJ,EAASI,GAItE8O,EAAqBlP,EAASE,EAAMI,EAAUM,EAAUX,GAS5D,QAASuP,GAAgBzP,EAAWC,GAGhC,GAAIE,GAAOH,EAAUsF,UACjBpF,EAAYF,EAAU0G,aACtBnG,EAAW8O,GAAoB7E,IAAIzJ,KAAKf,GACxCa,EAAW,IAMf,IAHAyO,GAAoBC,GAAoBtP,EAASE,EAAMD,EAAWK,GAG9DoN,GAAiBtM,QAAQ6C,eAAiByJ,GAAiBtM,QAAQ6F,SAASjH,GAAU,CACtF,GAAII,IAAQF,EAAMI,EAAUM,EAAUX,EACtCyN,IAAiBtM,QAAQ4H,gCAAgChJ,EAASI,GAItE8O,EAAqBlP,EAASE,EAAMI,EAAU,KAAML,GAGpDwP,GAAmC3N,MAAMhB,KAAKb,EAAWC,GAM7D,QAASwP,GAAiB3P,EAASC,EAASE,GAIxC,GAAID,GAAOF,EAAQsF,UACf/E,EAAYP,EAAQ0G,aACpB7F,EAAWwO,GAAoB7E,IAAIzJ,KAAKf,GACxCK,EAAWgP,GAAoB7E,IAAIzJ,KAAKd,EAM5C,IAHAqP,GAAoBC,GAAoBpP,EAASD,EAAMK,EAAWM,GAG9D8M,GAAiBtM,QAAQ6C,eAAiByJ,GAAiBtM,QAAQ6F,SAAS/G,GAAU,CACtF,GAAIC,IAAQF,EAAMW,EAAUR,EAAUE,EACtCoN,IAAiBtM,QAAQ4H,gCAAgC9I,EAASC,GAItE+O,EAAqBhP,EAASD,EAAMW,EAAUR,EAAUE,GAY5D,QAASyG,GAAahH,EAAMC,EAASE,GACjC,GAAyB,MAArBH,EAAK4P,cAAwB5P,EAAK4P,eAAiB3P,EACnD,KAAMsF,IAAQlE,QAAQyE,iBAAiB+J,GAE3C,IAAI3P,GAAa2M,GAA4BrC,IAAIzJ,KAAKd,GAClDM,EAAUL,EAAW4P,eAAe9P,EAAK0G,aAAc1G,EAAKsF,UAChE,OAAI/E,KAAYP,EACLA,GAEX+P,GAAqChO,MAAMhB,KAAKb,EAAYF,GACxDO,EACAoP,EAAiBpP,EAASP,EAAMC,GAEhCuP,EAAgBxP,EAAMC,GAEnBM,GAGX,QAASyP,GAAkBhQ,EAASC,EAAWE,EAAOD,EAAQK,GAC1DL,EAASA,GAAU,KACnBK,EAAKA,GAAM,IACX,IAAIM,GAAagM,GAA4BrC,IAAIzJ,KAAKf,GAClDK,EAAYQ,EAAWiP,eAAevP,EAAIN,EAC9C,OAAKI,OAML+O,GAAgB/O,EAAWL,EAASG,IALhC0O,GAA8B9M,MAAMhB,KAAKf,EAASC,EAAWE,GAC7DE,EAAYQ,EAAWiP,eAAevP,EAAIN,OAC1CuP,GAAgBnP,EAAWL,IAMnC,QAASiQ,GAAsBjQ,EAAeC,GAC1C,GAAIE,GAAa0M,GAA4BrC,IAAIzJ,KAAKd,GAClDC,EAAOC,EAAW+P,aAAalQ,EAInC,OAHIE,IACAuP,EAAgBvP,EAAMD,GAEnBC,EAGX,QAASiQ,GAA2BnQ,EAAWC,EAAWE,GACtD,GAAID,GAAa2M,GAA4BrC,IAAIzJ,KAAKZ,GAClDI,EAAOL,EAAW4P,eAAe9P,EAAWC,EAIhD,OAHIM,IACAkP,EAAgBlP,EAAMJ,GAEnBI,EAGX,QAAS6P,GAAepQ,EAASC,EAAOE,GACpC,KAAMA,YAAgBuC,OAClB,KAAM,IAAIuC,UAEd,IAAI/E,GAAS,MAEb,SAASD,GAASmM,IAActF,eAC5B,IAAK,cACD,OAAI5G,EAASF,EAAQwG,YACV6J,EAAUlQ,EAAMD,EAAQF,GAE5B,IACX,KAAK,aACD,MAAOqQ,GAAUlQ,EAAMH,EAASA,EAAQgL,WAC5C,KAAK,YACD,MAAOqF,GAAUlQ,EAAMH,EAAS,KACpC,KAAK,WACD,OAAIE,EAASF,EAAQwG,YACV6J,EAAUlQ,EAAMD,EAAQF,EAAQiL,aAEpC,IACX,SACI,KAAM1F,IAAQlE,QAAQyE,iBAAiBwK,KAMnD,QAASC,GAA0BvQ,EAAWC,GACZ,MAA1BD,EAAU4P,aACVP,GAAoBtD,IAAIhL,KAAKf,EAAWC,GAExCmP,EAAgBpP,EAAWA,EAAU4P,aAAc3P,GAM3D,QAASuQ,GAAYxQ,EAAMC,EAAQE,EAAOD,GAE1B,MAARA,IACAA,EAAOkM,GAEX,IAAI7L,GAAWkQ,GAA4BjG,IAAIzJ,KAAKf,GAChDa,EAASN,EAASS,MACtB,IAAIf,EAASY,EACT,KAAM0E,IAAQlE,QAAQyE,iBAAiB4K,GAEvCzQ,GAASE,EAAQU,IACjBV,EAAQU,EAASZ,GAErBqP,GAAoBqB,GAAwB3Q,EAAM,KAAM,KAAMO,EAC9D,IAAIF,GAAWE,EAAS4J,MAAM,EAAGlK,GAAUC,EAAOK,EAAS4J,MAAMlK,EAASE,EAC1EsQ,IAA4B1E,IAAIhL,KAAKf,EAAMK,GAM/C,QAASuQ,GAAU5Q,EAAUC,GAMzB,GAAIE,GAASH,EAASwG,UACtB,KAAKrG,EACD,MAAO,KAIX,IAAID,GAAcqF,GAAQlE,QAAQwJ,eAAe1K,EAGjD,KAAKD,IAAgBA,EAAYsJ,WAC7B,MAAO,KAIX,IAAIvJ,KAAA,GAAiBC,EAAYsJ,WAAW+E,OAASsC,GACjD,MAAO,KAIX,KAAK3Q,EAAYsJ,WAAWwB,WACxB,MAAO,KAGX,IAAIzK,GAAOP,YAAoB8Q,SAAU9Q,EAAS+Q,KAAO3E,EAEzD,OAAOlB,GAA8BhL,EAAYsJ,WAAWwB,WAAY,SAAUhL,GAC9E,MAAOA,GAAKsF,YAAcqJ,IAAY3O,EAAKwE,OAASjE,IAI5D,QAASyQ,GAAchR,GAMnB,GAAIC,GAAS,OAGTE,EAAWiL,EAAKpL,EACpB,KAAKsL,EAAanL,GAEd,QAIJ,IAAID,GAAOC,EAAS8N,KAGhB1N,EAAmBL,EAAKuJ,UAE5BxJ,GAAS,GAAIoL,OAAM9K,EAAiBS,OAEpC,KAAK,GADDH,GAAS,EACJR,EAAI,EAAGA,EAAIE,EAAiBS,OAAQX,IAAK,CAC9C,GAAID,GAAWG,EAAiBF,EAChC,IAAID,EAASqC,WAAaC,KAAKC,cAAgBvC,EAASqC,WAAaC,KAAKoK,UAAW,CAEjF,GAAIrM,GAAYmQ,EAAUxQ,EAEtBK,KAAcT,IACdC,EAAOY,KAAYT,IAQ/B,MAHAH,GAAOe,OAASH,EAGTZ,EAGX,QAASgR,GAAuBjR,GAK5B,GAAIC,MAGAE,EAAY6Q,EAAchR,EAG9B,IAAyB,IAArBG,EAAUa,OAAc,CACxB,GAAId,GAAmBF,EAAKyJ,WACxBlJ,EAAyBL,EAAiBc,MAC9Cb,GAAUa,OAAST,CAEnB,KAAK,GADDM,GAAkB,EACbR,EAAI,EAAGA,EAAIE,EAAwBF,IAAK,CAC7C,GAAID,GAAgBF,EAAiBG,EACjCD,GAAcqC,WAAaC,KAAKC,cAAgBvC,EAAcqC,WAAaC,KAAKoK,YAChF3M,EAAUU,KAAqBT,GAGvCD,EAAUa,OAASH,EAIvB,IAAK,GAAIJ,GAAM,EAAGA,EAAMN,EAAUa,OAAQP,IAAO,CAC7C,GAAIH,GAAOH,EAAUM,EAErB,IAAIH,EAAKgF,YAAcqJ,GAAU,CAC7B,GAAItJ,GAAkB4L,EAAuB3Q,GACzC8J,EAAeA,CACnBnK,GAAOe,QAAUqE,EAAgBrE,MACjC,KAAK,GAAIN,GAAI,EAAGA,EAAI2E,EAAgBrE,OAAQN,IACxCT,EAAOmK,EAAe1J,GAAK2E,EAAgB6L,OAG/CjR,GAAOA,EAAOe,QAAUV,EAKhC,MAAOL,GAKX,QAASgP,GAAgBjP,EAAMC,GAa3B,IAAK,GAPDE,GAAY6Q,EAAchR,GAI1BE,GAAA,EACAK,EAAYgF,GAAQlE,QAAQwJ,eAAe7K,IAASuF,GAAQlE,QAAQqK,eAAe1L,MACnFa,EAAgBN,EAAU4Q,kBACrB9Q,EAAI,EAAGA,EAAIF,EAAUa,OAAQX,IAClC,GAAIF,EAAUE,KAAOQ,EAAcR,GAAI,CACnCH,GAAA,CACA,OAGHD,GAAsBC,GACvBkR,EAAkBpR,GAItBO,EAAU4Q,cAAgBhR,CAG1B,KAAK,GAAIC,GAAM,EAAGA,EAAMD,EAAUa,OAAQZ,IAAO,CAC7C,GAAIK,GAAWN,EAAUC,EAEzBmF,IAAQlE,QAAQwJ,eAAepK,GAAUuO,aAAehP,EAI5D,IAAKO,EAAUkJ,WAAY,CACvB,GAAInJ,GAAiB+Q,GAAyB7G,IAAIzJ,KAAKf,GACnDqF,EAAuB/E,EAAeU,MAC1CT,GAAUkJ,WAAa,GAAI4B,OAAMhG,EACjC,KAAK,GAAI+E,GAAM,EAAGA,EAAM/E,EAAsB+E,IAC1C7J,EAAUkJ,WAAWW,GAAO9J,EAAe8J,GAK9ClK,GACDqF,GAAQlE,QAAQ8G,aAAamJ,EAAsBtR,GAI3D,QAASsR,GAAqBtR,GAM1B,IALA,GAAIC,GAAYsF,GAAQlE,QAAQwJ,eAAe7K,GAC3CG,EAAYF,EAAUkR,cAGtBjR,EAAa,OACVA,EAAa8L,GAAyBxB,IAAIzJ,KAAKf,IAClDuR,GAA0BxP,MAAMhB,KAAKf,EAAME,EAI/C,KAAK,GAAIK,GAAI,EAAGA,EAAIJ,EAAUa,OAAQT,IAAK,CACvC,GAAIM,GAAWV,EAAUI,EACzB0L,IAA0BlK,MAAMhB,KAAKf,EAAMa,GAI/C,IAAKV,EAAUa,OAEX,IAAK,GADDX,GAAaJ,EAAUwJ,WAClBrJ,EAAM,EAAGA,EAAMC,EAAWW,OAAQZ,IACvC6L,GAA0BlK,MAAMhB,KAAKf,EAAMK,EAAWD,IAKlE,QAAS0O,GAAwB9O,EAAMC,GAInC,GAAIE,KAEAH,GAAKsF,YAAcqJ,KACnBxO,EAAM,GAAKH,GAGf+K,EAA4B/K,EAAMG,EAAO,SAAUH,GAC/C,MAAOA,GAAWsF,YAAcqJ,IAGpC,KAAK,GAAIzO,GAAI,EAAGA,EAAIC,EAAMa,OAAQd,IAAK,CACnC,GAAIK,GAAOJ,EAAMD,GAGbW,EAAoBZ,GAAiBA,EAAcsI,QAAQhI,MAAA,CAG/D0O,GAAgB1O,EAAMM,IAI9B,QAASqO,GAAYlP,GACjB,GAAIC,GAAO2Q,EAAU5Q,EAET,OAARC,GACAgP,EAAgBhP,GAMxB,QAASmR,GAAkBpR,GAOnBwR,GAAejJ,QAAQvI,MAAA,GACvBwR,GAAenO,KAAKrD,GAIxByR,KAKJ,QAASC,GAA2B1R,EAAMC,EAAQE,GAQ9C,GAAI6N,EAA+BhO,EAAMC,GACrC,KAAMsF,IAAQlE,QAAQyE,iBAAiB6L,GAI3C,IAAa,MAATxR,GAAiBA,EAAMqG,aAAevG,EACtC,KAAMsF,IAAQlE,QAAQyE,iBAAiB8L,IAgB/C,QAASvB,GAAUrQ,EAAMC,EAAQE,GAK7BuR,EAA2B1R,EAAMC,EAAQE,EAGzC,IAAID,GAAiBC,CAcrB,OAXAD,KAAmBF,IAASE,EAAiBF,EAAKiL,aAIlD6C,EAAM9N,EAAMC,EAAOwG,eAInBoL,EAAO7R,EAAMC,EAAQC,GAGdF,EAGX,QAAS6R,GAAO7R,EAAMC,EAAQE,EAAOD,GAKjC,GAAIK,GAAQ,EACRM,EAAiB,MACjBb,GAAKyC,WAAaC,KAAKoP,yBACvBjR,EAAiBb,EAAKyJ,WACtBlJ,EAAQM,EAAeG,OAQ3B,IAAIX,GAAQ,GAAIgL,OAAM9K,EAGtB,IAAIP,EAAKyC,WAAaC,KAAKoP,uBAAwB,CAC/C,IAAK,GAAI1R,GAAI,EAAGA,EAAIG,EAAOH,IACvBC,EAAMD,GAAKS,EAAeT,EAE9B,KAAK,GAAIK,GAAM,EAAGA,EAAMF,EAAOE,IAC3BsN,GAAO1N,EAAMI,GAAMT,GAAA,EAGvBsP,IAAoByC,GAAoB/R,EAAM,KAAM,KAAM,KAAM,KAAMK,OAEtEA,GAAM,GAAKL,CAQf,KAAK,GAJDM,GAAciF,GAAQlE,QAAQwJ,eAAe5K,GAC7CoF,EAAiBiG,EAAarL,GAC9BmK,EAAwB9J,EAAcA,EAAYmJ,WAAa,KAC/D/I,EAAoBT,EAAO4H,YACtBmK,EAAM,EAAGA,EAAMzR,EAAOyR,IAAO,CAClC,GAAI9H,GAAQ7J,EAAM2R,EAElB,IAAI5H,EAAuB,CACvB,GAAIjK,EAAO,CACP,GAAImK,GAAaF,EAAsB7B,QAAQpI,EAG/CiK,GAAsBrC,OAAOuC,EAAY,EAAGJ,OAE5CE,GAAsB/G,KAAK6G,EAE/B,IAAI+H,GAAY1M,GAAQlE,QAAQwJ,eAAeX,IAAU3E,GAAQlE,QAAQqK,eAAexB,KACxF+H,GAAUzL,WAAavG,EAEnBoF,GACA6M,GAA2BnQ,MAAMhB,KAAKT,EAAY2N,KAAM/D,EAAO/J,OAGnE+R,IAA2BnQ,MAAMhB,KAAKd,EAAQiK,EAAO/J,EAIrDG,IAAeA,EAAYkJ,YAAc2I,KAAsBjI,IAC/DgF,EAAYhF,GAKZjK,EAAOqF,YAAcqJ,IAAcrO,GAAgBA,EAAY6Q,eAAsD,IAArC7Q,EAAY6Q,cAAcnQ,SAE1GiL,GAA0BlK,MAAMhB,KAAKd,EAAQiK,GAE7CkH,EAAkBnR,GAKtB,IAAImS,KACAlI,GAAM5E,YAAcqJ,KACpByD,EAAyB,GAAKlI,GAElCa,EAA4Bb,EAAOkI,EAA0B,SAAUpS,GACnE,MAAOA,GAAWsF,YAAcqJ,KAEpCG,EAAwB5E,EAAOkI,GAE3B1R,GAAqBiN,GAAiBtM,QAAQ6C,eAG9C4G,EAA0CZ,EAAO,SAAUlK,GAUnD2N,GAAiBtM,QAAQ6F,SAASlH,GAClC2N,GAAiBtM,QAAQuH,yBAAyB5I,MAI9C2N,GAAiBtM,QAAQ4G,oBAAoBjI,KASjE,IAAKE,EAAmB,CACpB,GAAImS,GAAkBlS,EAAQA,EAAMmS,gBAAkBrS,EAAOsS,SAC7DjD,IAAoByC,GAAoB9R,EAAQ,KAAM,KAAM,KAAMI,EAAO,KAAMgS,EAAiBlS,IAIxG,QAASyN,GAAO5N,EAAMC,GAGlB,MAAOoQ,GAAUrQ,EAAMC,EAAQ,MAGnC,QAASkM,GAAQnM,EAAOC,EAAME,GAQ1B,GAAI6N,EAA+B/N,EAAME,GACrC,KAAMoF,IAAQlE,QAAQyE,iBAAiB6L,GAI3C,IAAI3R,EAAMwG,aAAerG,EACrB,KAAMoF,IAAQlE,QAAQyE,iBAAiB8L,GAa3C,IAAI1R,GAAiBF,EAAMiL,WAGvB/K,KAAmBD,IACnBC,EAAiBD,EAAKgL,YAI1B,IAAI1K,GAAkBP,EAAMsS,eAG5BxE,GAAM7N,EAAME,EAAOsG,cAGnB,IAAI5F,MAGAR,EAAcL,EAAMwG,UACL,OAAfnG,IAEAQ,EAAa,GAAKb,EAElB+N,GAAO/N,EAAOG,GAAA,GAIlB,IAAIC,GAAQ,MACZ,IAAIH,YAAgBuS,kBAAkB,CAClC,GAAI/R,GAAaR,EAAKwJ,WAClBnJ,EAAmBG,EAAWO,MAClCZ,GAAQ,GAAIiL,OAAM/K,EAClB,KAAK,GAAI+E,GAAI,EAAGA,EAAI/E,EAAkB+E,IAClCjF,EAAMiF,GAAK5E,EAAW4E,OAG1BjF,IAASH,EAIb4R,GAAO5R,EAAME,EAAQD,GAAA,GAIrBoP,GAAoByC,GAAoB5R,EAAQ,KAAM,KAAM,KAAMC,EAAOS,EAAcN,EAAiBL,GAG5G,QAASuS,GAAWzS,EAAMC,GAKV,MAARD,GACA8N,EAAM9N,EAAMC,EAAOwG,cAOvB,KAAK,GAHDtG,GAAmBF,EAAOwJ,WAC1BvJ,EAAoBC,EAAiBa,OACrCT,EAAe,GAAI8K,OAAMnL,GACpBW,EAAI,EAAGA,EAAIX,EAAmBW,IACnCN,EAAaM,GAAKV,EAAiBU,EAKvC,IAAIR,GAAa,MACjB,IAAY,MAARL,EACAK,SACG,IAAIL,EAAKyC,WAAaC,KAAKoP,uBAAwB,CACtD,GAAI1R,GAAiBJ,EAAKyJ,WACtBhJ,EAAuBL,EAAeY,MAC1CX,GAAa,GAAIgL,OAAM5K,EACvB,KAAK,GAAIH,GAAM,EAAGA,EAAMG,EAAsBH,IAC1CD,EAAWC,GAAOF,EAAeE,OAGrCD,IAAcL,EAIlB,KAAK,GAAIqF,GAAM,EAAGA,EAAMnF,EAAmBmF,IACvC0I,GAAOxN,EAAa8E,GAAMpF,GAAA,EAIlB,OAARD,GACA6R,EAAO7R,EAAMC,EAAQ,MAAA,GAIzBqP,GAAoByC,GAAoB9R,EAAQ,KAAM,KAAM,KAAMI,EAAYE,GAGlF,QAASmS,IAAU1S,EAAOC,GAKtB,GAAID,EAAMwG,aAAevG,EACrB,KAAMsF,IAAQlE,QAAQyE,iBAAiB8L,GAO3C,OAHA7D,IAAO/N,EAAOC,GAGPD,EAGX,QAAS+N,IAAO/N,EAAMC,EAAQE,GAgB1B,GAAID,GAAqBF,EAAKsS,gBAG1B/R,EAAiBP,EAAKiL,YAGtBpK,EAAY0E,GAAQlE,QAAQwJ,eAAe7K,GAC3CK,EAAckF,GAAQlE,QAAQwJ,eAAe5K,EACjD,IAAII,GAAeA,EAAYoJ,WAAY,CACvC,GAAIrJ,GAAYC,EAAYoJ,WAAWlB,QAAQvI,EAC/CK,GAAYoJ,WAAW1B,OAAO3H,EAAW,GAEzCS,EAAU2F,WAAa,IACvB,IAAI/F,GAAakS,GAAyBnI,IAAIzJ,KAAKf,EACnDuR,IAA0BxP,MAAMhB,KAAKN,EAAYT,OAEjDuR,IAA0BxP,MAAMhB,KAAKd,EAAQD,EAI7Ca,IAAaA,EAAUmO,eACvBC,EAAgBpO,EAAUmO,cAC1BnO,EAAUmO,aAAe,MAKzB/O,EAAOqF,YAAcqJ,IAActO,GAAgBA,EAAY8Q,eAAsD,IAArC9Q,EAAY8Q,cAAcnQ,QAC1GoQ,EAAkBnR,EAItB,IAAIK,KACAN,GAAKsF,YAAcqJ,KACnBrO,EAAyB,GAAKN,GAElC+K,EAA4B/K,EAAMM,EAA0B,SAAUN,GAClE,MAAOA,GAAWsF,YAAcqJ,KAEhCrO,EAAyBU,SAEzB8N,EAAwB7O,GAGxB6O,EAAwB9O,EAAMM,IAM9BqN,GAAiBtM,QAAQ6C,gBAGrByJ,GAAiBtM,QAAQ6F,SAASlH,IAClC2N,GAAiBtM,QAAQwH,4BAA4B7I,MAKzD4K,EAAiC5K,EAAM,SAAUA,GAOzC2N,GAAiBtM,QAAQ6F,SAASlH,IAClC2N,GAAiBtM,QAAQwH,4BAA4B7I,QAOjE,KADA,GAAIqF,GAAoBpF,EACjBoF,GAAmB,CAGtB,GAAI+E,GAAgB7E,GAAQlE,QAAQwJ,eAAexF,EACnD,IAAI+E,GAAiBA,EAAcwI,UAE/B,IAAK,GADDlS,GAAoB0J,EAAcwI,UAC7BZ,EAAI,EAAGA,EAAItR,EAAkBM,OAAQgR,IAAK,CAC/C,GAAI9H,GAAqBxJ,EAAkBsR,EAC3C,IAAI9H,EAAmB2I,QAAQ7P,QAAS,CAIpC,GAAIsH,GAAWJ,EAAmB4I,SAC9Bb,EAAU/H,EAAmB2I,QAC7BT,EAAoBW,GAAwBzI,EAAUtK,EAAMiS,EAChEe,IAAkB3P,KAAK+O,IAInC/M,EAAoBA,EAAkBmB,WAMrCrG,GACDmP,GAAoByC,GAAoB9R,EAAQ,KAAM,KAAM,KAAM,MAAOD,GAAOE,EAAoBK,GAY5G,QAAS0S,IAAyBjT,GAC9B,GAAIC,GAAYsF,GAAQlE,QAAQwJ,eAAe7K,IAASuF,GAAQlE,QAAQqK,eAAe1L,MACnFG,EAAYF,EAAU2S,SAC1B,OAAOzS,GAAYA,EAAYF,EAAU2S,aAG7C,QAASM,IAAuBlT,GAC5B,OACI0I,SAAU1I,EACVmT,SACAC,SACAvQ,QAAS,SAAiB7C,EAAMC,GACF,IAAtB+E,KAAKoO,MAAMpS,QACXgS,GAAkB3P,KAAK2B,KAE3B,IAAI7E,GAAgB8S,GAAyBjT,EAC7CG,GAAckD,MAAOyP,SAAU9N,KAAM6N,QAAS5S,IAC9C+E,KAAKoO,MAAM/P,KAAKrD,IAEpBmD,WAAY,WACR,GAAInD,GAAQgT,GAAkBzK,QAAQvD,KACtCgO,IAAkBjL,OAAO/H,EAAO,EAChC,KAAK,GAAIC,GAAI,EAAGA,EAAI+E,KAAKoO,MAAMpS,OAAQf,IAEnC,IAAK,GADDE,GAAgB8S,GAAyBjO,KAAKoO,MAAMnT,IAC/CC,EAAI,EAAGA,EAAIC,EAAca,OAAQd,IACtC,GAAIC,EAAcD,GAAG4S,WAAa9N,KAAM,CACpC7E,EAAc4H,OAAO7H,EAAG,EACxB,OAIZ8E,KAAKoO,WAKjB,QAASL,IAAwB/S,EAAUC,EAAME,GAC7C,GAAID,IACAmT,SAAUrT,EACV0I,SAAU1I,EAAS0I,SACnBmK,QAAS1S,EACTgT,SACAG,KAAMrT,EACNkD,WAAY,WAER,IAAK,GADDnD,GAAgBiT,GAAyBjO,KAAKsO,MACzCrT,EAAI,EAAGA,EAAID,EAAcgB,OAAQf,IACtC,GAAID,EAAcC,GAAG6S,WAAa9N,KAAM,CACpChF,EAAc+H,OAAO9H,EAAG,EACxB,UAMZM,EAAgB0S,GAAyBhT,EAG7C,OAFAM,GAAc8C,MAAOyP,SAAU5S,EAAmB2S,QAAS1S,IAEpDD,EASX,QAASoP,IAAoBtP,EAAMC,EAAQE,EAAMD,EAAWK,EAAUM,EAAYR,EAAcD,EAAiBK,GAE7G,GAAiC,IAA7BuS,GAAkBhS,OAAtB,CAYA,IALA,GAAIV,MACA+E,KAEA+E,GAASnK,GACTS,EAAWT,EACRS,EAAWA,EAAS8F,YACvB4D,EAAM/G,KAAK3C,EAGf,KAAK,GAAIsR,GAAI,EAAGA,EAAI5H,EAAMpJ,OAAQgR,IAAK,CACnC,GAAI9H,GAAOE,EAAM4H,GACb1H,EAAY/E,GAAQlE,QAAQwJ,eAAeX,EAC/C,IAAKI,GAAcA,EAAUsI,UAM7B,IAAK,GAAIX,GAAI,EAAGA,EAAI3H,EAAUsI,UAAU5R,OAAQiR,IAAK,CACjD,GAAIG,GAAqB9H,EAAUsI,UAAUX,GACzCI,EAAUD,EAAmBS,OAGjC,IAAI3I,GAAQjK,GAAWoS,EAAQrP,QAA/B,CAGA,GAAIhD,IAASuP,GAAoB,CAC7B,IAAK8C,EAAQ/L,WACT,QAIJ,IAAI+L,EAAQkB,kBAAoBlB,EAAQkB,gBAAgBhL,QAAQpI,MAAA,GAA6B,MAAbD,GAC5E,SAGR,IAAIF,IAAS2Q,IAA2B0B,EAAQmB,iBAG5CxT,IAAS+R,IAAuBM,EAAQtP,WAA5C,CAMA,GAAI0Q,GAAWrB,EAAmBU,SAC9BY,EAAQpT,EAAoBiI,QAAQkL,EACpCC,MAAA,IACAA,EAAQpT,EAAoBU,OAC5BV,EAAoBoT,GAASD,IAK7BzT,IAASuP,IAAsB8C,EAAQsB,mBAAqB3T,IAAS2Q,IAA0B0B,EAAQuB,yBACvGvO,EAAcqO,GAASnT,MAMnC,GAAmC,IAA/BD,EAAoBU,OAAxB,CAKA,IAAK,GAAI4E,GAAO,EAAGA,EAAOtF,EAAoBU,OAAQ4E,IAAQ,CAC1D,GAAIiO,GAAYvT,EAAoBsF,GAEhCkO,GACAtL,KAAMxI,EACNkN,OAAQjN,EACR8T,cAAe,KACfC,mBAAoB,KACpBxR,WAAYyR,GACZC,aAAcD,GACd3B,gBAAiB,KACjBrH,YAAa,KACbkJ,SAAU,KAGVhU,KACA2T,EAAOC,cAAgB5T,EACvB2T,EAAOE,mBAAqB9T,GAG5BW,IACAiT,EAAOtR,WAAab,OAAOyS,OAAOvT,IAGlCR,IACAyT,EAAOI,aAAevS,OAAOyS,OAAO/T,IAGpCD,IACA0T,EAAOxB,gBAAkBlS,GAGzBK,IACAqT,EAAO7I,YAAcxK,GAGzBqT,EAAOK,SAAW9O,EAAcO,GAEhCiO,EAAUV,MAAM9P,KAAKyQ,GAIzBrC,OAGJ,QAASA,MACD4C,KAGJA,IAAA,EACA9O,GAAQlE,QAAQ8G,aAAamM,KAGjC,QAASA,MACLD,IAAA,CAGA,KAAK,GAFDrU,GAA0BgT,GAAkBhS,OAC5Cf,EAAa,GAAIoL,OAAMrL,GAClBG,EAAI,EAAGA,EAAIH,EAAyBG,IACzCF,EAAWE,GAAK6S,GAAkB7S,EAGtC,KAAK,GADDD,GAAasR,GAAezJ,OAAO,EAAGyJ,GAAexQ,QAChDT,EAAO,EAAGA,EAAON,EAAWe,OAAQT,IAAQ,CAGjD,IAAK,GAFDM,GAAWZ,EAAWM,GACtBF,EAAQQ,EAASsS,MAAMpL,OAAO,EAAGlH,EAASsS,MAAMnS,QAC3CZ,EAAI4S,GAAkBhS,OAAS,EAAGZ,GAAK,EAAGA,IAAK,CACpD,GAAIK,GAAoBuS,GAAkB5S,EACtCK,GAAkB4S,WAAaxS,IAC/BmS,GAAkBjL,OAAO3H,EAAG,GAC5BK,EAAkB0C,cAG1B,GAAI9C,EAAMW,OACN,IACIH,EAAS6H,SAAS3H,KAAKF,EAAS0T,UAAWlU,EAAOQ,EAAS0T,WAC7D,MAAOvU,GACLuF,GAAQlE,QAAQuF,YAAY5G,IAIxC,IAAK,GAAIM,GAAO,EAAGA,EAAOJ,EAAWc,OAAQV,IAAQ,CACjD,GAAI+E,GAAOnF,EAAWI,GAClB8J,EAAQ/E,EAAKoB,cAAc+N,YAAYC,GAC3CrK,GAAMsK,UAAUC,IAAA,GAAiB,EACjC,KACItP,EAAKuP,cAAcxK,GACrB,MAAOpK,GACLuF,GAAQlE,QAAQuF,YAAY5G,KAnsDxC2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAI2H,IAASlJ,EAAQ,cAEjB+E,GAAUpE,EAAuBuI,IAEjCmL,GAAkBrU,EAAQ,wBAE1BmN,GAAmBxM,EAAuB0T,GAI9C/T,GAAQO,SACJ0J,4BAA6BA,EAC7BG,8BAA+BA,EAC/BC,aAAcA,EACdG,aAAcA,EACdG,kBAAmBA,EACnBS,sBAAuBA,EACvBd,KAAMA,EACNkC,sBAAuBA,EACvBG,MAAOA,EACPK,MAAOA,EACPI,oBAAqBA,EACrBG,iCAAkCA,EAClCC,mBAAoBA,EACpBG,SAAUA,EACVW,gBAAiBA,EACjBI,gBAAiBA,EACjBC,gBAAiBA,EACjBzI,aAAcA,EACdgJ,kBAAmBA,EACnBC,sBAAuBA,EACvBE,2BAA4BA,EAC5BC,eAAgBA,EAChBG,0BAA2BA,EAC3BC,YAAaA,EACbS,uBAAwBA,EACxBZ,UAAWA,EACXwB,OAAQA,EACRjE,OAAQA,EACRzB,QAASA,EACTsG,WAAYA,EACZC,UAAWA,GACX3E,OAAQA,GACRmF,uBAAwBA,GAI5B,IAAI7D,IAAsB9J,GAAQlE,QAAQuI,WAAWkL,KAAM,SACvDrE,GAA8BlL,GAAQlE,QAAQuI,WAAWmL,cAAe,QACxElI,GAA8BtH,GAAQlE,QAAQuI,WAAWkH,QAAS,eAAiBvL,GAAQlE,QAAQuI,WAAWlH,KAAM,cACpHoJ,GAA6BvG,GAAQlE,QAAQuI,WAAWkH,QAAS,cAAgBvL,GAAQlE,QAAQuI,WAAWvD,YAAa,aACzHqJ,GAAqCnK,GAAQlE,QAAQuI,WAAWkH,QAAS,qBACzEjC,GAAgCtJ,GAAQlE,QAAQuI,WAAWkH,QAAS,gBACpEf,GAAuCxK,GAAQlE,QAAQuI,WAAWoL,aAAc,kBAChF/I,GAA4B1G,GAAQlE,QAAQuI,WAAWlH,KAAM,eAC7D2O,GAA2B9L,GAAQlE,QAAQuI,WAAWlH,KAAM,cAC5DgL,GAA0BnI,GAAQlE,QAAQuI,WAAWlH,KAAM,aAC3DsJ,GAA2BzG,GAAQlE,QAAQuI,WAAWlH,KAAM,cAC5DwP,GAA6B3M,GAAQlE,QAAQuI,WAAWlH,KAAM,gBAC9DiQ,GAA2BpN,GAAQlE,QAAQuI,WAAWlH,KAAM,cAC5D6O,GAA4BhM,GAAQlE,QAAQuI,WAAWlH,KAAM,eAE7DkM,GAAY,OACZxC,GAAe,GACfyD,GAAyB,sBACzB8B,GAA0B,wBAC1BjB,GAAmB,iBACnBkB,GAAkB,gBAClBtB,GAAe,cACfmE,GAAQ,QACRE,GAAkB,aAClBpF,GAAqB,aACrBwC,GAAqB,YACrBpB,GAAyB,gBACzBlE,GAAU,+BACVC,GAAY,qCACZC,GAAS,6BACTN,GAAS,uCACTC,GAAW,gCACXC,GAAW,+BACX4F,GAAqB,eACrBtB,GAAmB,OACnBrC,GAAqB,SACrBhD,GAAmB,eACnBmD,GAAW,OAo8CX0F,IAAA,EAEArB,MACAxB,MACAyC,GAAetS,OAAOyS,2ECliD1B,YAkBA,SAASjT,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAhBvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAIjC2F,EAAsB9J,EAAQlE,QAAQuI,WAAWkL,KAAM,QAE3DhU,GAAQO,SAEJU,GAAIA,SACA,MAAOsN,GAAoB7E,IAAIzJ,KAAKiE,OAGxCjD,GAAIA,OAAM/B,GACN,GAAIC,GAAQ+E,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C6L,EAAM7T,QAAQkP,0BAA0BtQ,EAAOD,uFChC3D,YAcA,SAASmB,GAAuBlB,GAAO,MAAOA,IAAOA,EAAImB,WAAanB,GAAQoB,QAASpB,GAZvF0B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAMjC+G,EAA8BlL,EAAQlE,QAAQuI,WAAWmL,cAAe,OAE5EjU,GAAQO,SAEJ0L,GAAIA,QACA,MAAO0D,GAA4BjG,IAAIzJ,KAAKiE,OAGhD+H,GAAIA,MAAK9M,GACL,GAAID,GAASyQ,EAA4BjG,IAAIzJ,KAAKiE,MAAMhE,MACxDkU,GAAM7T,QAAQmP,YAAYxL,KAAM,EAAGhF,EAAQC,IAG/CkV,WAAY,SAAoBlV,GAC5B,GAAID,GAASyQ,EAA4BjG,IAAIzJ,KAAKiE,MAAMhE,MACxDkU,GAAM7T,QAAQmP,YAAYxL,KAAMhF,EAAQ,EAAGC,IAE/CmV,WAAY,SAAoBnV,EAAQD,GACpCkV,EAAM7T,QAAQmP,YAAYxL,KAAM/E,EAAQ,EAAGD,IAE/CqV,WAAY,SAAoBpV,EAAQD,GACpCkV,EAAM7T,QAAQmP,YAAYxL,KAAM/E,EAAQD,EAAO,KAEnDwQ,YAAa,SAAqBvQ,EAAQD,EAAOO,GAC7C2U,EAAM7T,QAAQmP,YAAYxL,KAAM/E,EAAQD,EAAOO,2DC1CvD,YAWA,SAASY,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAEvF,QAASsV,GAAatV,EAAMC,GACxB,GAAIK,IAAA,EACAD,GAAA,EACAH,GAAA,EACAE,EAAS,IACTH,KACAK,EAAUL,EAAKsV,WAAA,EACflV,EAAaJ,EAAKuV,cAAA,EAClBtV,EAAWD,EAAKwV,YAAA,EAChBrV,EAASH,EAAKyV,QAAU,KAE5B,IAAI7U,GAAQiC,SAAS0R,YAAY,cAGjC,OAFA3T,GAAM8U,gBAAgB3V,EAAMM,EAASD,EAAYD,GACjDmF,EAAQlE,QAAQqK,eAAe7K,GAAS4U,SAAUvV,IAC3CW,EAzBXc,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAEJjB,EAAQO,QAAUiU,CAElB,IAAI5L,GAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAqBrC4L,GAAalT,UAAYP,OAAO+T,YAAYxT,kDC9B5C,YAmBA,SAASjB,GAAuBlB,GAAO,MAAOA,IAAOA,EAAImB,WAAanB,GAAQoB,QAASpB,GA2HvF,QAAS4V,GAAe5V,GACpB,IAAK,GAAID,GAAI,EAAGA,EAAIC,EAAOe,OAAQhB,IAC/B8V,EAAc7V,EAAOD,IAI7B,QAAS8V,GAAc7V,GACnB,GAAa,IAATA,EACA,KAAMsF,GAAQlE,QAAQyE,iBAAiB,cAE3C,IAAI,KAAKxB,KAAKrE,GACV,KAAMsF,GAAQlE,QAAQyE,iBAAiB,yBAI/C,QAASiQ,GAAmB9V,EAASD,GAEjC,GAAIK,GAAgBJ,EAAQ+V,aAAahW,GACrCE,EAASG,EAAgBA,EAAc4V,MAAM,MAAMC,UACnD3V,EAAYoB,OAAOwU,OAAOC,aAAahU,UAE3C,OADAmD,GAAQlE,QAAQqK,eAAenL,GAAa8J,QAASpK,EAASqF,UAAWtF,EAAWqW,OAAQnW,IACrFK,EAGX,QAAS+V,GAAwBrW,EAASD,GACtC,GAAIK,GAAekF,EAAQlE,QAAQwJ,eAAe5K,IAAYsF,EAAQlE,QAAQqK,eAAezL,GAAWsW,eACnGlW,GAAakW,aACdlW,EAAakW,cAEjB,IAAIrW,GAAY,MAChB,QAAIA,EAAYG,EAAakW,WAAWvW,IAC7BE,EAEJG,EAAakW,WAAWvW,GAAa+V,EAAmB9V,EAASD,GA7K5E2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAEJjB,EAAQwV,wBAA0BA,CAElC,IAAIrB,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAIrC5I,GAAQO,SAEJL,GAAIA,UACA,GAAIf,GAAQsF,EAAQlE,QAAQwJ,eAAe7F,KAC3C,OAAO/E,GAAMoW,OAAOrV,QAIxBwV,KAAM,SAAcvW,GAChB,GAAID,GAAQuF,EAAQlE,QAAQwJ,eAAe7F,KAC3C,OAAO/E,IAASD,EAAMqW,OAAOrV,OAAS,KAAOhB,EAAMqW,OAAOpW,IAE9DwW,SAAU,SAAkBxW,GACxB,GAAID,GAAQuF,EAAQlE,QAAQwJ,eAAe7F,KAC3C,OAAOhF,GAAMqW,OAAO9N,QAAQtI,MAAA,GAEhCyW,IAAK,WAGD,IAAK,GAFDzW,GAAQ+E,KAEHhF,EAAO2W,UAAU3V,OAAQX,EAASgL,MAAMrL,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC3EG,EAAOH,GAAQyW,UAAUzW,EAG7B,OAAOyN,GAAiBtM,QAAQgI,mBAAmB,WAC/CwM,EAAexV,EAEf,KAAK,GADDL,GAAQuF,EAAQlE,QAAQwJ,eAAe5K,GAClCC,EAAI,EAAGA,EAAIG,EAAOW,OAAQd,IAAK,CACpC,GAAIK,GAAQF,EAAOH,GACfE,EAAQJ,EAAMqW,OAAO9N,QAAQhI,EAC7BH,MAAA,GACAJ,EAAMqW,OAAOhT,KAAK9C,GAG1BP,EAAMqW,OAAOH,OACbhB,EAAM7T,QAAQ2O,kBAAkBhQ,EAAMqK,QAASrK,EAAMsF,UAAWtF,EAAMqW,OAAOO,KAAK,SAG1F7I,OAAQ,WAGJ,IAAK,GAFD9N,GAAS+E,KAEJhF,EAAQ2W,UAAU3V,OAAQX,EAASgL,MAAMrL,GAAQE,EAAQ,EAAGA,EAAQF,EAAOE,IAChFG,EAAOH,GAASyW,UAAUzW,EAG9B,OAAOyN,GAAiBtM,QAAQgI,mBAAmB,WAC/CwM,EAAexV,EAEf,KAAK,GADDL,GAAQuF,EAAQlE,QAAQwJ,eAAe5K,GAClCC,EAAI,EAAGA,EAAIG,EAAOW,OAAQd,IAAK,CACpC,GAAIK,GAAQF,EAAOH,GACfE,EAAQJ,EAAMqW,OAAO9N,QAAQhI,EAC7BH,MAAA,GACAJ,EAAMqW,OAAOtO,OAAO3H,EAAO,GAGnC8U,EAAM7T,QAAQ2O,kBAAkBhQ,EAAMqK,QAASrK,EAAMsF,UAAWtF,EAAMqW,OAAOO,KAAK,SAG1FC,OAAQ,SAAgB5W,EAAOD,GAC3B,GAAIK,GAAS2E,KACT9E,EAAayW,SAEjB,OAAOhJ,GAAiBtM,QAAQgI,mBAAmB,WAC/CyM,EAAc7V,EACd,IAAIM,GAAQgF,EAAQlE,QAAQwJ,eAAexK,GACvCD,EAAQG,EAAM8V,OAAO9N,QAAQtI,EACjC,OAAIG,MAAA,EAC0B,IAAtBF,EAAWc,QAAgBhB,KAAA,IAC3BO,EAAM8V,OAAOtO,OAAO3H,EAAO,GAC3B8U,EAAM7T,QAAQ2O,kBAAkBzP,EAAM8J,QAAS9J,EAAM+E,UAAW/E,EAAM8V,OAAOO,KAAK,OAAA,GAMlF5W,KAAA,IAGAO,EAAM8V,OAAOhT,KAAKpD,GAClBM,EAAM8V,OAAOH,OACbhB,EAAM7T,QAAQ2O,kBAAkBzP,EAAM8J,QAAS9J,EAAM+E,UAAW/E,EAAM8V,OAAOO,KAAK,OAAA,MAMlGzK,QAAS,SAAiBlM,EAAOD,GAC7B,GAAIK,GAAS2E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/CyM,EAAc7V,GACd6V,EAAc9V,EACd,IAAIE,GAAQqF,EAAQlE,QAAQwJ,eAAexK,GACvCE,EAAQL,EAAMmW,OAAO9N,QAAQtI,EAC7BM,MAAA,IAGJL,EAAMmW,OAAO9V,GAASP,EACtBE,EAAMmW,OAAOH,OACbhB,EAAM7T,QAAQ2O,kBAAkB9P,EAAMmK,QAASnK,EAAMoF,UAAWpF,EAAMmW,OAAOO,KAAK,UAK1F7U,GAAIA,SACA,GAAI9B,GAAQsF,EAAQlE,QAAQwJ,eAAe7F,KAC3C,OAAO/E,GAAMoK,QAAQ2L,aAAa/V,EAAMqF,YAAc,IAG1DvD,GAAIA,OAAM9B,GACN,GAAID,GAASgF,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIhJ,GAAQkF,EAAQlE,QAAQwJ,eAAe7K,EAC3CkV,GAAM7T,QAAQ2O,kBAAkB3P,EAAMgK,QAAShK,EAAMiF,UAAWrF,GAEhEI,EAAMgW,OAAShL,MAAMjJ,UAAU+H,MAAMpJ,KAAKf,uFCxItD,YAkBA,SAASmB,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAhBvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAIjCoN,EAAyCvR,EAAQlE,QAAQuI,WAAWkH,QAAS,wBAE7EiG,EAA2CxR,EAAQlE,QAAQuI,WAAWkH,QAAS,0BAC/EkG,EAA2CzR,EAAQlE,QAAQuI,WAAWkH,QAAS,yBAEnFhQ,GAAQO,SAGJ4V,qBAAsB,SAA8BjX,GAChD,GAAIC,GAAU6W,EAAuC/U,MAAMhB,KAAKiE,KAAMhF,EACtE,OAAOkV,GAAM7T,QAAQ8J,aAAanG,KAAM/E,IAK5CiX,uBAAwB,SAAgClX,EAAIC,GACxD,GAAII,GAAU0W,EAAyChV,MAAMhB,KAAKiE,KAAMhF,EAAIC,EAC5E,OAAOiV,GAAM7T,QAAQ8J,aAAanG,KAAM3E,IAK5C8W,uBAAwB,SAAgCnX,GACpD,GAAIC,GAAU+W,EAAyCjV,MAAMhB,KAAKiE,KAAMR,KACxE,OAAO0Q,GAAM7T,QAAQ8J,aAAanG,KAAM/E,IAK5CmX,WAAY,SAAoBpX,EAAMC,GAClC,GAAII,GAAQ2E,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIrJ,EAAKyC,WAAaC,KAAK2U,eAAiBnC,EAAM7T,QAAQiK,aAAatL,GACnE,KAAMuF,GAAQlE,QAAQyE,iBAAiB,oBAG3C,OAAOoP,GAAM7T,QAAQoM,MAAMzN,EAAMK,EAAOJ,MAMhDqX,UAAW,SAAmBtX,GAC1B,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,MAAO6L,GAAM7T,QAAQyM,MAAM9N,EAAMC,uFCnE7C,YAsBA,SAASkB,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GApBvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAEjC6N,EAAc/W,EAAQ,+BAEtBgX,EAAerW,EAAuBoW,GAMtC1K,EAA8BtH,EAAQlE,QAAQuI,WAAWkH,QAAS,eAAiBvL,EAAQlE,QAAQuI,WAAWlH,KAAM,cACpH+U,EAAwClS,EAAQlE,QAAQuI,WAAWkH,QAAS,wBAC5E4G,EAA0CnS,EAAQlE,QAAQuI,WAAWkH,QAAS,0BAC9E6G,EAA0CpS,EAAQlE,QAAQuI,WAAWkH,QAAS,0BAC9EjC,EAAgCtJ,EAAQlE,QAAQuI,WAAWkH,QAAS,gBACpE8G,EAAkCrS,EAAQlE,QAAQuI,WAAWkH,QAAS,kBACtEO,EAA2B9L,EAAQlE,QAAQuI,WAAWlH,KAAM,cAC5D6O,EAA4BhM,EAAQlE,QAAQuI,WAAWlH,KAAM;AAEjE5B,EAAQO,SAGJiF,GAAIA,cACA,GAAItG,GAAa6M,EAA4BrC,IAAIzJ,KAAKiE,MAClD/E,EAAcsF,EAAQlE,QAAQwJ,eAAe7K,EAIjD,OAHKC,IACDsF,EAAQlE,QAAQqK,eAAe1L,GAAcqK,QAASrF,OAEnDhF,GAIXgH,aAAc,SAAsBhH,EAAeC,GAC/C,GAAIM,GAAQyE,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIhJ,GAAawM,EAA4BrC,IAAIzJ,KAAKR,GAClDJ,EAAYE,EAAW6P,aAAalQ,EACnCG,GAKD+U,EAAM7T,QAAQ+N,gBAAgBjP,EAAWI,EAAON,IAJhD4O,EAA8B9M,MAAMhB,KAAKR,EAAOP,EAAeC,GAC/DE,EAAYE,EAAW6P,aAAalQ,GACpCkV,EAAM7T,QAAQmO,gBAAgBrP,EAAWI,OASrDsX,eAAgB,SAAwB7X,EAAWC,EAAeM,GAC9D,GAAIF,GAAS2E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIlJ,GAAa0M,EAA4BrC,IAAIzJ,KAAKV,GAClDC,EAAYH,EAAW2P,eAAe9P,EAAWC,EAChDK,GAKD4U,EAAM7T,QAAQ+N,gBAAgB9O,EAAWD,EAAQE,IAJjDqX,EAAgC7V,MAAMhB,KAAKV,EAAQL,EAAWC,EAAeM,GAC7ED,EAAYH,EAAW2P,eAAe9P,EAAWC,GACjDiV,EAAM7T,QAAQmO,gBAAgBlP,EAAWD,OASrDoP,gBAAiB,SAAyBzP,GACtC,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C6L,EAAM7T,QAAQ4O,sBAAsBjQ,EAAeC,MAM3D6X,kBAAmB,SAA2B9X,EAAWC,GACrD,GAAIM,GAASyE,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C6L,EAAM7T,QAAQ8O,2BAA2BnQ,EAAWC,EAAWM,MAMvEwX,iBAAkB,SAA0B/X,GACxC,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,MAAO6L,GAAM7T,QAAQ2F,aAAahH,EAAMC,MAMhD+X,mBAAoB,SAA4BhY,GAC5C,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,MAAO6L,GAAM7T,QAAQ2F,aAAahH,EAAMC,MAMhDgY,oBAAqB,SAA6BjY,GAC9C,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIrJ,EAAK4P,eAAiB3P,EACtB,KAAMsF,GAAQlE,QAAQyE,iBAAiB,gBAG3C,OADAoP,GAAM7T,QAAQoO,gBAAgBzP,EAAMC,GAC7BD,KAGfkY,aAAc,SAAsBlY,GAEhC,IAAKA,GAAsB,SAAdA,EAAKuO,MAAiC,WAAdvO,EAAKuO,KACtC,KAAMhJ,GAAQlE,QAAQyE,iBAAiB,YAG3C,IAA0B,iCAAtBd,KAAK0B,aACL,KAAMnB,GAAQlE,QAAQyE,iBAAiB,oBAG3C,QAAQd,KAAKM,WACT,IAAK,UAAU,IAAK,QAAQ,IAAK,aAAa,IAAK,OACnD,IAAK,MAAM,IAAK,SAAS,IAAK,KAAK,IAAK,KAAK,IAAK,KAClD,IAAK,KAAK,IAAK,KAAK,IAAK,KAAK,IAAK,SAAS,IAAK,OACjD,IAAK,MAAM,IAAK,IAAI,IAAK,UAAU,IAAK,OACpC,KACJ,SACI,GAAIqI,EAAiBtM,QAAQ8F,yBAAyBnC,KAAKM,WACvD,KAEJ,MAAMC,GAAQlE,QAAQyE,iBAAiB,qBAG/C,GAAId,KAAKwE,WACL,KAAMjE,GAAQlE,QAAQyE,iBAAiB,oBAG3C,IAAI7F,GAAS+E,KAAKyB,cAAcoF,wBAEhCtG,GAAQlE,QAAQ8W,OAAOlY,EAAQuX,EAAanW,SAE5CkE,EAAQlE,QAAQqK,eAAezL,GAC3BgO,KAAMjJ,KACNuJ,KAAMvO,EAAKuO,KACX9E,eAQJ,KALA,GAAIlJ,GAAqB8Q,EAAyB7G,IAAIzJ,KAAKiE,MACvD3E,EAAckR,EAA0BxP,MACxC5B,EAAkB,GAAIkL,OAAM9K,EAAmBS,QAC/CV,EAAa,OACbF,EAAI,EACDE,EAAaC,EAAmB,IAAI,CACvC,GAAIE,GAAa8E,EAAQlE,QAAQwJ,eAAevK,IAAeiF,EAAQlE,QAAQqK,eAAepL,KAC9FG,GAAW+F,WAAaxB,KACxB7E,EAAgBC,KAAOE,EACvBD,EAAYU,KAAKiE,KAAM1E,GAG3B,GAAIJ,GAAYqF,EAAQlE,QAAQwJ,eAAe7F,KAQ/C,OAPK9E,KACDA,KACAqF,EAAQlE,QAAQqK,eAAe1G,KAAM9E,IAEzCA,EAAUsJ,WAAavJ,EACvBC,EAAUuJ,WAAatJ,EAEhBF,GAIXuJ,GAAIA,cAEA,GAAIxJ,GAAa,KACbC,EAAcsF,EAAQlE,QAAQwJ,eAAe7F,KACjD,OAAI/E,KACAD,EAAaC,EAAYuJ,YACpBxJ,GAAkC,WAApBA,EAAWuO,MACnB,KAGRvO,GAIXoY,QAAS,SAAiBpY,GACtB,GAAIC,GAAU+E,IAEd,GACI,IAAI/E,EAAQoY,QAAQrY,GAChB,MAAOC,SAENA,EAAUA,EAAQqY,gBAK/BrB,qBAAsB,SAA8BjX,GAChD,GAAIC,GAAUwX,EAAsC1V,MAAMhB,KAAKiE,KAAMhF,EACrE,OAAOkV,GAAM7T,QAAQ8J,aAAanG,KAAM/E,IAK5CiX,uBAAwB,SAAgClX,EAAIC,GACxD,GAAIM,GAAUmX,EAAwC3V,MAAMhB,KAAKiE,KAAMhF,EAAIC,EAC3E,OAAOiV,GAAM7T,QAAQ8J,aAAanG,KAAMzE,IAK5C4W,uBAAwB,SAAgCnX,GACpD,GAAIC,GAAU0X,EAAwC5V,MAAMhB,KAAKiE,KAAMR,KACvE,OAAO0Q,GAAM7T,QAAQ8J,aAAanG,KAAM/E,IAK5CsY,sBAAuB,SAA+BvY,EAAOC,GACzD,GAAIM,GAASyE,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAE/C,MAAO6L,GAAM7T,QAAQ+O,eAAe7P,EAAQP,EAAOC,MAM3DuY,mBAAoB,SAA4BxY,EAAOC,GAEnD,GAAIM,GAAOyE,KAAKyB,cAAc8G,eAAetN,EAC7CiV,GAAM7T,QAAQ+O,eAAepL,KAAMhF,EAAOO,IAQ9CkY,GAAIA,aAEA,MAAOvD,GAAM7T,QAAQ6K,sBAAsBlH,OAI/CyT,GAAIA,WAAUzY,GACV,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAE/C,GAAI9I,GAAW2U,EAAM7T,QAAQoK,kBAAkBzL,EAAOC,GAClDI,EAAUJ,EAAO,UACjBI,aAAmBmS,kBACnB0C,EAAM7T,QAAQoR,WAAWlS,EAAUF,GAEnC6U,EAAM7T,QAAQoR,WAAWlS,EAAUN,MAM/CyY,GAAIA,aAEA,MAAOxD,GAAM7T,QAAQ6K,uBAAwBzC,YAAazE,SAI9D0T,GAAIA,WAAU1Y,GACV,GAAIC,GAAU+E,IAEd,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAE/C,GAAI9I,GAASN,EAAQuG,UACrB,IAAe,OAAXjG,EAAJ,CAGA,GAAIA,EAAOkC,WAAaC,KAAK2U,cACzB,KAAM9R,GAAQlE,QAAQyE,iBAAiB,6BAEvCvF,GAAOkC,WAAaC,KAAKoP,yBACzBvR,EAASN,EAAQwG,cAAcpE,cAAc,QAEjD,IAAIhC,GAAW6U,EAAM7T,QAAQoK,kBAAkBzL,EAAOO,EACtD2U,GAAM7T,QAAQ8K,QAAQlM,EAASI,EAAUJ,EAAQuG,gBAKzDmS,mBAAoB,SAA4B3Y,EAAUC,GACtD,GAAIM,GAAUyE,IAEd,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAG/C,GAAIhJ,GAAW6U,EAAM7T,QAAQoK,kBAAkBxL,EAAMM,EACrD2U,GAAM7T,QAAQ+O,eAAe7P,EAASP,EAAUK,wHCjU5D,YAgBA,SAASc,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAIvF,QAAS4Y,GAAO5Y,EAAMC,GAClB,GAAII,IAAA,EACAC,GAAA,EACAC,GAAA,CACAN,KACAI,EAAUJ,EAAKsV,WAAA,EACfjV,EAAaL,EAAKuV,cAAA,EAClBjV,EAAWN,EAAKwV,YAAA,EAEpB,IAAIrV,GAAQ0C,SAAS0R,YAAY,QAGjC,OAFApU,GAAMsU,UAAU1U,EAAMK,EAASC,GAC/BiF,EAAQlE,QAAQqK,eAAetL,GAASqV,SAAUlV,IAC3CH,EA9BXuB,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAEJjB,EAAQ+X,iBAAmB,OAC3B/X,EAAQO,QAAUuX,CAElB,IAAI3D,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAqBrCkP,GAAOxW,WAEH0W,GAAIA,iBACA,MAAOvT,GAAQlE,QAAQwJ,eAAe7F,MAAM8T,eAGhD5L,GAAIA,UACA,MAAO3H,GAAQlE,QAAQwJ,eAAe7F,MAAMkI,QAGhD6L,yBAA0B,WACtB/T,KAAKgU,kBACLzT,EAAQlE,QAAQwJ,eAAe7F,MAAMiU,8BAAA,GAEzCC,aAAc,QAASlZ,KAInB,GAAIA,MAGAC,EAAgB+E,KAAK8T,cAGrBzY,EAAOkF,EAAQlE,QAAQwJ,eAAe7F,MAAMmU,IAEhD,IAAI9Y,EAEA,IAAK,GADDC,GAAI,EACCC,EAAI,EAAGA,EAAIF,EAAKW,OAAQT,IAAK,CAClC,GAAIH,GAAOC,EAAKE,GAAG,EACfN,aAAyBmZ,QACnBhZ,YAAgBsC,OAAUwS,EAAM7T,QAAQiN,mBAAmBlO,EAAM8U,EAAM7T,QAAQ6M,oBAAoB9N,MACrGJ,EAAaM,KAAOF,GAEjBH,YAAyByC,MAC3BwS,EAAM7T,QAAQiN,mBAAmBlO,EAAMH,KACxCD,EAAaM,KAAOF,GAGxBJ,EAAaM,KAAOF,EAMhC,MAAOJ,IAIXyV,GAAIA,YAEA,MAAOlQ,GAAQlE,QAAQwJ,eAAe7F,MAAMyQ,UAAY4D,EAAsB9Q,QAAQvD,KAAKwD,SAAA,GASnG,IAQI6Q,IARmBvY,EAAQ+X,kBAE3BS,GAAIA,iBACA,MAAO/T,GAAQlE,QAAQwJ,eAAe7F,MAAMsU,iBAOpD,OAAQ,QAAS,UAAW,WAE5B,QAAS,WAAY,YAAa,aAAc,aAAc,YAAa,WAAY,YAAa,UAEpG,QAEA,cAAe,QAEf,UAAW,QAEX,mBAAoB,oBAAqB,iBAEzC,cAEA,aAAc,cAEd,oECzHA,YA0EA,SAASnY,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GA4KvF,QAASuZ,GAAcvZ,GAGnB,GAAIC,MACAE,EAAI,EAEJI,EAASiZ,EAAsBhP,IAAIzJ,KAAKf,GAExCE,EAA0B,IAE1BF,aAAiByZ,YACjBvZ,EAA0BwZ,EACnB1Z,YAAiB2Z,cACxBzZ,EAA0B0Z,EAQ9B,IAAIxZ,GAAiBG,EAIjBE,EAAwB,KACxBJ,EAAgB,IAChBH,KACAO,EAAwBP,EAAwBsK,IAAIzJ,KAAKf,GACrDS,IACAJ,EAAgB6U,EAAM7T,QAAQoN,SAAShO,EAAuBF,KAQtEN,EAAKE,MAAQI,EAAQH,EAAgBC,EAcrC,KAHA,GAAIQ,GAASgZ,EAAatZ,EAAQP,EAAOC,GAGxB,MAAVY,GAQH,GALIJ,IACAJ,EAAgB6U,EAAM7T,QAAQoN,SAAShO,EAAuBI,IAI9DqU,EAAM7T,QAAQgN,iCAAiC6G,EAAM7T,QAAQ+J,KAAK7K,GAASM,GAC3EZ,EAAKE,MAAQU,EAAQ,KAAMR,GAC3BQ,EAASgZ,EAAahZ,EAAQb,EAAOC,OAFzC,CAMK,GAAIY,IAAWR,EACZ,KAKIE,GAASM,EACTZ,EAAKE,MAAQU,EAAQN,EAAQF,GAC7BQ,EAASgZ,EAAahZ,EAAQb,EAAOC,GAQrD,MAAOA,GAGX,QAAS4Z,GAAa7Z,EAAMC,EAAOE,GAkB/B,GAAIH,YAAgB0C,MAAM,CACtB,GAAI1C,EAAKyC,WAAaC,KAAK2U,cACvB,MAAmB,SAAfpX,EAAMuI,KAEC,KAEJxI,EAAKqH,WACT,IAAI6N,EAAM7T,QAAQiK,aAAatL,GAAO,CACzC,IAAKC,EAAMwV,SAAU,CACjB,GAAIlV,GAAOJ,EAAK,GAAG,EACnB,IAAI+U,EAAM7T,QAAQ+J,KAAK7K,KAAUP,EAC7B,MAAO,MAGf,MAAOA,GAAKiO,KAEhB,MAAOjO,GAAKgP,cAAgBhP,EAAKwG,WAGrC,MAAO,MAGX,QAASsT,GAAuB9Z,EAAeC,GAC3C,IAAK,GAAIE,GAAI,EAAGA,EAAIF,EAAKe,OAAQb,IAAK,CAClC,GAAII,GAAON,EAAKE,GAAG,GACfD,EAAgBD,EAAKE,GAAG,EAC5B,IAAII,IAASP,EACT,MAAOE,GAGf,MAAO,MAGX,QAAS6Z,GAAgB/Z,EAAeC,GACpC,IAAK,GAAIE,GAAI,EAAGA,EAAIF,EAAKe,OAAQb,IAAK,CAClC,GAAII,GAAON,EAAKE,GAAG,EACnB,IAAII,IAASP,EAAe,CACxB,IAAK,GAAIE,GAAIC,EAAGD,GAAK,EAAGA,IAAK,CACzB,GAAIE,GAASH,EAAKC,GAAG,EACrB,IAAc,MAAVE,EACA,MAAOA,GAGf,MAAO,OAGf,MAAO,MAzYXuB,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,GAAIC,IACAgD,iBAAkBjD,EAAKoC,UAAUa,iBACjC+W,oBAAqBha,EAAKoC,UAAU4X,oBACpCpF,cAAe5U,EAAKoC,UAAUwS,cAGlC,QACI3R,iBAAkB,SAA0BjD,EAAMG,EAAUI,GACxD,GAAwB,kBAAbJ,GAAX,CAIA,GAAID,IAAawI,SAAUvI,GACvBC,GAAA,CAEmB,kBAAZG,GACPH,EAAUG,EACgB,mBAAZA,KACdH,EAAUG,EAAQ0Z,WAAA,EAClB/Z,EAASqD,KAAOhD,EAAQgD,QAAA,EAExBrD,EAASga,QAAU3Z,EAAQ2Z,WAAA,EAG/B,IAAIzZ,GAAa0Z,EAAwB3P,IAAIxF,KAAMhF,EAAMI,IAAY+Z,EAAwBhE,OAAOnR,KAAMhF,EAAMI,EAEhHK,GAAW2Z,YAAYpV,KAAM9E,GAC7BO,EAAW4Z,OAAOpa,EAAOgD,oBAE7B+W,oBAAqB,SAA6Bha,EAAMG,EAAUI,GAC9D,GAAwB,kBAAbJ,GAAX,CAIA,GAAID,IAAawI,SAAUvI,GACvBC,GAAA,CAEmB,kBAAZG,GACPH,EAAUG,EACgB,mBAAZA,KACdH,EAAUG,EAAQ0Z,WAAA,EAGtB,IAAIxZ,GAAa0Z,EAAwB3P,IAAIxF,KAAMhF,EAAMI,EAEpDK,KAILA,EAAW6Z,eAAetV,KAAM9E,GAE5BO,EAAW8Z,OACX9Z,EAAW+Z,OAAOva,EAAO+Z,yBAMzC,IAAI/E,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAMjC8P,EAAwBjU,EAAQlE,QAAQuI,WAAW6Q,MAAO,UAC1Df,EAAoCnU,EAAQlE,QAAQuI,WAAW6P,WAAY,iBAC3EG,EAAoCrU,EAAQlE,QAAQuI,WAAW+P,WAAY,iBAE3EQ,EAA0B,SAAiCna,EAAQC,EAAME,GACzE,GAAII,GAAQyE,IAEZA,MAAKkI,OAASlN,EACdgF,KAAKwD,KAAOvI,EACZ+E,KAAKiV,QAAU9Z,EAEf6E,KAAK0V,iBACL1V,KAAK2V,mBAEL3V,KAAK0D,SAAW,SAAUzI,GACtB,GAAIE,GAAa,KACbD,EAAcqF,EAAQlE,QAAQwJ,eAAe7K,EAIjD,QAHIE,IACAC,EAAaD,EAAYsJ,YAErBvJ,EAAM2a,YACV,IAAKH,OAAMrY,UAAUyY,gBACjBta,EAAMua,gBAAgB7a,EAAOM,EAAM2M,OAAQ3M,EAAMma,eAC7Cva,GACAI,EAAMua,gBAAgB7a,EAAOE,EAAYI,EAAMoa,gBAEnD,MACJ,KAAKF,OAAMrY,UAAU2Y,UACjB,GAAI3a,GAAeoZ,EAAsBhP,IAAIzJ,KAAKd,EAClDM,GAAMua,gBAAgB7a,EAAOG,EAAcG,EAAMya,aAAa5a,GAC9D,MACJ,KAAKqa,OAAMrY,UAAU6Y,eACb9a,GACAI,EAAMua,gBAAgB7a,EAAOE,EAAYI,EAAMoa,iBAEnDpa,EAAMua,gBAAgB7a,EAAOM,EAAM2M,OAAQ3M,EAAMma,iBAMjEP,GAAwB3P,IAAM,SAAUxK,EAAQC,EAAME,GAClD,GAAII,GAAcgF,EAAQlE,QAAQwJ,eAAe7K,GAC7CE,EAAeF,EACfI,EAAoBG,CAKxB,IAJIA,GAAeA,EAAY0N,OAC3B/N,EAAeK,EAAY0N,KAC3B7N,EAAoBmF,EAAQlE,QAAQwJ,eAAe3K,KAElDE,IAAsBA,EAAkB8a,UACzC,MAAO,KAGX,KAAK,GADDza,GAAcL,EAAkB8a,UAC3B7a,EAAI,EAAGA,EAAII,EAAYO,OAAQX,IAAK,CACzC,GAAIQ,GAAaJ,EAAYJ,EAC7B,IAAIQ,EAAWqM,SAAWhN,GAAgBW,EAAW2H,OAASvI,GAAQY,EAAWoZ,UAAY9Z,EACzF,MAAOU,GAGf,MAAO,OAGXsZ,EAAwBhE,OAAS,SAAUnW,EAAQC,EAAME,GACrD,GAAII,GAAcgF,EAAQlE,QAAQwJ,eAAe7K,GAC7CE,EAAeF,EACfI,EAAoBG,CACpBA,IAAeA,EAAY0N,OAC3B/N,EAAeK,EAAY0N,KAC3B7N,EAAoBmF,EAAQlE,QAAQwJ,eAAe3K,IAElDE,EAEOA,EAAkB8a,YAC1B9a,EAAkB8a,cAFlB9a,EAAoBmF,EAAQlE,QAAQqK,eAAexL,GAAgBgb,cAIvE,IAAIza,GAAa,GAAI0Z,GAAwBja,EAAcD,EAAME,EAEjE,OADAC,GAAkB8a,UAAU7X,KAAK5C,GAC1BA,GAGX0Z,EAAwB/X,WAEpBmY,GAAIA,SACA,MAAqC,KAA9BvV,KAAK0V,cAAc1Z,QAAgD,IAAhCgE,KAAK2V,gBAAgB3Z,QAGnEga,aAAc,SAAsBhb,GAChC,GAAIC,GAAcsF,EAAQlE,QAAQwJ,eAAe7K,EACjD,OAAIC,IAAeA,EAAYgO,KACpBjJ,KAAK2V,gBAET3V,KAAK0V,eAEhBN,YAAa,SAAqBpa,EAAQC,GAGtC,IAAK,GAFDE,GAAY6E,KAAKgW,aAAahb,GAEzBO,EAAI,EAAGA,EAAIJ,EAAUa,OAAQT,IAClC,GAAIN,EAASyI,WAAavI,EAAUI,GAAGmI,SACnC,MAIRvI,GAAUkD,KAAKpD,IAEnBqa,eAAgB,SAAwBta,EAAQC,GAG5C,IAAK,GAFDE,GAAY6E,KAAKgW,aAAahb,GAEzBO,EAAI,EAAGA,EAAIJ,EAAUa,OAAQT,IAAK,CACvC,GAAIL,GAAQC,EAAUI,EACtB,IAAIN,EAASyI,WAAaxI,EAAMwI,SAAU,CACtCvI,EAAU4H,OAAOxH,EAAG,EACpB,UAIZua,gBAAiB,SAAyB9a,EAAOC,EAAeE,GAC5D,GAAII,GAAagF,EAAQlE,QAAQwJ,eAAe7K,IAAUuF,EAAQlE,QAAQqK,eAAe1L,MACrFE,EAAOK,EAAW4a,cACjBjb,KACDA,EAAOK,EAAW4a,eAAiB5B,EAAcvZ,GAGrD,IAAII,GAAS2Z,EAAgB9Z,EAAeC,EAC5C,IAAKE,EAEE,CACH,GAAIK,GAAgBqZ,EAAuB7Z,EAAeC,GACtDG,EAAS,MAEbE,GAAW4Y,KAAOjZ,EAClBK,EAAWuY,cAAgB7Y,EAC3BM,EAAW2M,OAAS9M,EACpBG,EAAW+Y,cAAgB7Y,CAE3B,KAAK,GAAII,GAAI,EAAGA,EAAIV,EAAUa,OAAQH,IAAK,CACvC,GAAIP,GAAWH,EAAUU,EASzB,IARaP,EAASoI,SAAS3H,KAAKd,EAAeD,GAC/CM,EAASiD,OACJlD,EAGDA,EAAOgD,KAAK/C,GAFZD,GAAUC,IAKdC,EAAW0Y,6BACX,MAOR,GAHA1Y,EAAW4Y,KAAO,KAClB5Y,EAAWuY,cAAgB,KAEvBzY,EACA,IAAK,GAAIgF,GAAK,EAAGA,EAAKhF,EAAOW,OAAQqE,IAAM,CACvC,GAAI+E,GAAQjK,EAAUoI,QAAQlI,EAAOgF,GACrClF,GAAU4H,OAAOqC,EAAO,QA/BhCpK,GAAM+Y,4BAoCdsB,OAAQ,SAAgBra,GACpBA,EAAWe,KAAKiE,KAAKkI,OAAQlI,KAAKwD,KAAMxD,KAAK0D,SAAU1D,KAAKiV,UAEhEO,OAAQ,SAAgBxa,GACpBA,EAAWe,KAAKiE,KAAKkI,OAAQlI,KAAKwD,KAAMxD,KAAK0D,SAAU1D,KAAKiV,kEClPpE,YAcA,SAAS9Y,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAZvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAMrC5I,GAAQO,SAGJmD,GAAIA,QACA,GAAuB,SAAnBQ,KAAKM,UAIT,MAAON,MAAKgR,aAAa,SAAW,IAIxCxR,GAAIA,MAAKxE,GACkB,SAAnBgF,KAAKM,WAIT4P,EAAM7T,QAAQ2O,kBAAkBhL,KAAM,OAAQhF,IAIlDmR,cAAe,QAASnR,GAAcC,GAClC,GAAuB,SAAnB+E,KAAKM,UAAT,CAQA,IAAKrF,GAAWA,EAAQmb,WAAA,EAAkB,CACtC,GAAIpb,GAAgB,KAChBS,EAAc8E,EAAQlE,QAAQwJ,eAAe7F,KAIjD,OAHIvE,KACAT,EAAgBS,EAAY0Q,eAEzBnR,MAIX,MAAOkV,GAAM7T,QAAQ4P,uBAAuBjM,gEC1DpD,YAcA,SAAS7D,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAZvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAMrC5I,GAAQO,SAGJga,cAAe,WACX,GAAIrb,GAAUgF,KAAKsW,OACftb,IACAkV,EAAM7T,QAAQ0M,OAAO/N,EAASgF,OAMtCuW,YAAa,WACT,GAAIvb,GAAQgF,KAAKwW,KACbxb,IACAkV,EAAM7T,QAAQ0M,OAAO/N,EAAOgF,OAMpCyW,YAAa,WACT,GAAIzb,GAAQgF,KAAK0W,KACb1b,IACAkV,EAAM7T,QAAQ0M,OAAO/N,EAAOgF,OAMpC2W,UAAW,SAAmB3b,GAK1B,GAHIA,KAAA,IACAA,EAAQgF,KAAK4W,KAAK5a,OAAS,GAE3BhB,EAAQ,GAAKA,GAASgF,KAAK4W,KAAK5a,OAChC,KAAMuE,GAAQlE,QAAQyE,iBAAiB,iBAE3Cd,MAAK4W,KAAK5b,GAAO+N,kECxDzB,YAUA,SAAS5M,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GARvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAI2H,GAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAIrC5I,GAAQO,SAGJwa,WAAY,SAAoB7b,GAK5B,GAHIA,KAAA,IACAA,EAAQgF,KAAK8W,MAAM9a,OAAS,GAE5BhB,EAAQ,GAAKA,GAASgF,KAAK8W,MAAM9a,OACjC,KAAMuE,GAAQlE,QAAQyE,iBAAiB,iBAE3Cd,MAAK8W,MAAM9b,GAAO+N,oDCvB1B,YAUA,SAAS5M,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GARvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAI2H,GAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAIrC5I,GAAQO,SAGJsa,UAAW,SAAmB3b,GAE1B,GAAIA,EAAQ,GAAKA,GAASgF,KAAK4W,KAAK5a,OAChC,KAAMuE,GAAQlE,QAAQyE,iBAAiB,iBAE3Cd,MAAK4W,KAAK5b,GAAO+N,oDCpBzB,YAeA,SAAS5M,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAIvF,QAAS+b,GAAkB/b,GACvB,GAAIC,GAAWiV,EAAM7T,QAAQ6R,uBAAuBlT,EACpDuF,GAAQlE,QAAQqK,eAAe1G,MAAQqO,SAAUpT,IACjDA,EAASsU,UAAYvP,KApBzBrD,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAEJjB,EAAQO,QAAU0a,CAElB,IAAI9G,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAYrCqS,GAAkB3Z,WACdS,QAAS,SAAiB7C,EAAQC,GAC9BsF,EAAQlE,QAAQwJ,eAAe7F,MAAMqO,SAASxQ,QAAQ7C,EAAQC,IAElEkD,WAAY,WACRoC,EAAQlE,QAAQwJ,eAAe7F,MAAMqO,SAASlQ,cAElD6Y,YAAa,WACT,GAAIhc,GAAUuF,EAAQlE,QAAQwJ,eAAe7F,MAAMqO,SAASF,KAC5D,OAAOnT,GAAQ+H,OAAO,EAAG/H,EAAQgB,iEClCzC,YAkBA,SAASG,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAhBvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAIrC5I,GAAQO,SAGJ4a,aAAc,SAAsBjc,GAChC,GAAIC,GAAQ+E,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAI/I,GAAciF,EAAQlE,QAAQwJ,eAAe5K,EACjD,OAAOiV,GAAM7T,QAAQ2F,aAAahH,EAAMM,EAAY+J,YAM5D6R,eAAgB,SAAwBlc,GACpC,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAI/I,GAAciF,EAAQlE,QAAQwJ,eAAe5K,EACjD,OAAOiV,GAAM7T,QAAQ2F,aAAahH,EAAMM,EAAY+J,YAM5D8R,gBAAiB,SAAyBnc,GACtC,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAI/I,GAAciF,EAAQlE,QAAQwJ,eAAe5K,GAC7CE,EAAO+U,EAAM7T,QAAQ4O,sBAAsBjQ,EAAeM,EAAY+J,QAC1E,KAAKlK,EACD,KAAMoF,GAAQlE,QAAQyE,iBAAiB,gBAE3C,OAAO3F,MAMfic,kBAAmB,SAA2Bpc,EAAWC,GACrD,GAAIK,GAAS0E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAIlJ,GAAcoF,EAAQlE,QAAQwJ,eAAevK,GAC7CD,EAAO6U,EAAM7T,QAAQ8O,2BAA2BnQ,EAAWC,EAAWE,EAAYkK,QACtF,KAAKhK,EACD,KAAMkF,GAAQlE,QAAQyE,iBAAiB,gBAE3C,OAAOzF,wFCrEnB,YAkBA,SAASc,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAmdvF,QAASqc,GAAWrc,EAAMC,GACtB,GAAIE,GAASH,EAAKwG,UAElB,GACI,IAAIrG,IAAWF,EACX,OAAA,QAECE,EAASA,EAAOqG,WAEzB,QAAA,EAGJ,QAAS8V,GAAUtc,EAAUC,GACzB,QAASE,GAAkBH,EAAQC,EAAUE,GAEzC,IAAK,GADDE,GAAWL,EAAOyJ,WACblJ,EAAM,EAAGA,EAAMF,EAASW,OAAQT,IAAO,CAC5C,GAAIL,GAAUG,EAASE,EACvB,IAAIL,IAAYD,EACZ,OAAA,CACG,IAAIC,IAAYC,EACnB,OAAA,GAMZ,GAAIE,GAAYL,EAASwG,WACrBjG,EAAYN,EAASuG,UAEzB,IAAInG,IAAcE,EACd,MAAOJ,GAAkBH,EAAUC,EAOvC,KAHA,GAAIC,IAAcG,GACdI,GAAcF,GAEXF,EAAYA,EAAUmG,YACzBtG,EAAWmD,KAAKhD,EAGpB,MAAOE,EAAYA,EAAUiG,YACzB/F,EAAW4C,KAAK9C,EAGpBL,GAAWqc,UACX9b,EAAW8b,SAMX,KAJA,GAGIjc,IAHOkc,KAAKC,IAAIvc,EAAWc,OAASP,EAAWO,QACzCwb,KAAKE,IAAIxc,EAAWc,OAAQP,EAAWO,QAEzC,GACDd,EAAWI,KAAOG,EAAWH,IAChCA,GAGJ,OAAOH,GAAkBD,EAAWI,EAAI,GAAIJ,EAAWI,GAAIG,EAAWH,IAG1E,QAASqc,GAAmB3c,GAGxB,IAAK,GAFDC,GAAS,GACTE,EAAaH,EAAQyJ,WAChBpJ,EAAI,EAAGA,EAAIF,EAAWa,OAAQX,IAAK,CACxC,GAAIE,GAAYJ,EAAWE,EAC3B,QAAQE,EAAUkC,UACd,IAAKC,MAAKC,aACN1C,GAAU0c,EAAmBpc,EAC7B,MACJ,KAAKmC,MAAKoK,UACN7M,GAAUwQ,EAA4BjG,IAAIzJ,KAAKR,IAI3D,MAAON,GA5iBX0B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,GAIjC2F,EAAsB9J,EAAQlE,QAAQuI,WAAWkL,KAAM,SAEvDrE,EAA8BlL,EAAQlE,QAAQuI,WAAWmL,cAAe,QACxElI,EAA8BtH,EAAQlE,QAAQuI,WAAWkH,QAAS,eAAiBvL,EAAQlE,QAAQuI,WAAWlH,KAAM,cACpH2O,EAA2B9L,EAAQlE,QAAQuI,WAAWlH,KAAM,cAC5Dka,EAA8BrX,EAAQlE,QAAQuI,WAAWlH,KAAM,iBAC/DsJ,EAA2BzG,EAAQlE,QAAQuI,WAAWlH,KAAM,cAC5Dma,EAA0BtX,EAAQlE,QAAQuI,WAAWlH,KAAM,aAC3Doa,EAAgCvX,EAAQlE,QAAQuI,WAAWlH,KAAM,mBACjEqa,EAA4BxX,EAAQlE,QAAQuI,WAAWlH,KAAM,eAC7DiQ,EAA2BpN,EAAQlE,QAAQuI,WAAWlH,KAAM,cAC5Dsa,EAA0BzX,EAAQlE,QAAQuI,WAAWlH,KAAM,YAE/D5B,GAAQO,SAEJwG,GAAIA,eACA,MAAOqN,GAAM7T,QAAQ6M,oBAAoBlJ,MAAMvC,WAAaC,KAAK2U,eAGrE4F,YAAa,SAAqBjd,GAC9B,GAAIC,GAAWD,GAAWA,EAAQyV,YAAA,CAClC,OAAOxV,GAAWiV,EAAM7T,QAAQ6M,oBAAoBlJ,MAAQkQ,EAAM7T,QAAQ+J,KAAKpG,OAInFwB,GAAIA,cACA,GAAIxG,GAAa,OACbC,EAAYsF,EAAQlE,QAAQwJ,eAAe7F,KAK/C,OAJI/E,KACAD,EAAaC,EAAUuG,YAGpBxG,GAAc2S,EAAyBnI,IAAIzJ,KAAKiE,OAG3DsT,GAAIA,iBACA,GAAItY,GAAagF,KAAKwB,UACtB,OAAIxG,IAAcA,EAAWyC,WAAaC,KAAKC,aACpC3C,EAGJ,MAIXuG,cAAe,WACX,GAAIvG,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUyJ,UAC3B,IAAIxJ,EACA,MAAOA,GAAWe,OAAS,EAInC,MAAO4b,GAA4B7a,MAAMhB,KAAKiE,OAKlDyE,GAAIA,cACA,GAAIzJ,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUyJ,UAC3B,IAAIxJ,EAAY,CAGZ,IAAK,GAFDE,GAAmBF,EAAWe,OAC9BX,EAAS,GAAIgL,OAAMlL,GACdI,EAAI,EAAGA,EAAIJ,EAAkBI,IAClCF,EAAOE,GAAKN,EAAWM,EAE3B,OAAOF,IAIf,MAAOgR,GAAyB7G,IAAIzJ,KAAKiE,OAI7CgG,GAAIA,cACA,GAAIhL,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUyJ,UAC3B,IAAIxJ,EACA,MAAIA,GAAWe,OACJf,EAAW,GAEf,KAIf,MAAO+L,GAAyBxB,IAAIzJ,KAAKiE,OAI7CuN,GAAIA,aACA,GAAIvS,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUyJ,UAC3B,IAAIxJ,EACA,MAAIA,GAAWe,OACJf,EAAWA,EAAWe,OAAS,GAEnC,KAIf,MAAO6b,GAAwBrS,IAAIzJ,KAAKiE,OAI5CsN,GAAIA,mBACA,GAAItS,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUwG,UAC3B,IAAIvG,EAAY,CACZ,GAAIE,GAAaoF,EAAQlE,QAAQwJ,eAAe5K,GAAYwJ,WACxDpJ,EAAeF,EAAWoI,QAAQvD,MAAQ,CAC9C,OAAO3E,GAAe,EAAI,KAAOF,EAAWE,IAIpD,MAAOyc,GAA8BtS,IAAIzJ,KAAKiE,OAIlDiG,GAAIA,eACA,GAAIjL,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,EAAW,CACX,GAAIC,GAAaD,EAAUwG,UAC3B,IAAIvG,EAAY,CACZ,GAAIE,GAAaoF,EAAQlE,QAAQwJ,eAAe5K,GAAYwJ,WACxDpJ,EAAeF,EAAWoI,QAAQvD,MAAQ,CAC9C,OAAO3E,KAAiBF,EAAWa,OAAS,KAAOb,EAAWE,IAItE,MAAO0c,GAA0BvS,IAAIzJ,KAAKiE,OAK9CkY,GAAIA,aACA,MAAOF,GAAwBxS,IAAIzJ,KAAKiE,OAI5CkY,GAAIA,WAAUld,GACV,GAAIC,GAAQ+E,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,OAAQpJ,EAAMwC,UACV,IAAKC,MAAKya,eACNjI,EAAM7T,QAAQkP,0BAA0BtQ,EAAOD,EAC/C,MACJ,KAAK0C,MAAKoK,UACV,IAAKpK,MAAKuK,4BACV,IAAKvK,MAAKsK,aACN,GAAI7M,GAASsQ,EAA4BjG,IAAIzJ,KAAKd,GAAOe,MACzDkU,GAAM7T,QAAQmP,YAAYvQ,EAAO,EAAGE,EAAQH,OAM5Dod,GAAIA,eACA,OAAQpY,KAAKvC,UACT,IAAKC,MAAKoP,uBACV,IAAKpP,MAAKC,aACN,MAAOga,GAAmB3X,KAC9B,KAAKtC,MAAKya,eACN,MAAO9N,GAAoB7E,IAAIzJ,KAAKiE,KACxC,KAAKtC,MAAKoK,UACV,IAAKpK,MAAKuK,4BACV,IAAKvK,MAAKsK,aACN,MAAOyD,GAA4BjG,IAAIzJ,KAAKiE,KAChD,SACI,MAAO,QAKnBoY,GAAIA,aAAYpd,GACZ,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,OAAQpJ,EAAOwC,UACX,IAAKC,MAAKoP,uBACV,IAAKpP,MAAKC,aACN,GAAIxC,GAAO,IACG,MAAVH,IACAG,EAAOF,EAAOwG,cAAc8G,eAAevN,IAE/CkV,EAAM7T,QAAQoR,WAAWtS,EAAMF,EAC/B,MACJ,KAAKyC,MAAKya,eACNjI,EAAM7T,QAAQkP,0BAA0BtQ,EAAQD,EAChD,MACJ,KAAK0C,MAAKoK,UACV,IAAKpK,MAAKuK,4BACV,IAAKvK,MAAKsK,aACNkI,EAAM7T,QAAQmP,YAAYvQ,EAAQ,EAAGA,EAAO8M,KAAK/L,OAAQhB,OAOzEqd,UAAW,WACP,GAAIrd,GAASgF,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAK/C,IAAK,GADDpJ,GAAaD,EAAOyJ,WACftJ,EAAI,EAAGA,EAAIF,EAAWe,OAAQb,IAAK,CACxC,GAAIE,GAAYJ,EAAWE,EAC3B,IAAIE,EAAUoC,WAAaC,KAAKoK,UAAW,CACvC,GAAIvM,GAASkQ,EAA4BjG,IAAIzJ,KAAKV,GAAWW,MAC7D,IAAe,IAAXT,EAAc,CACd2U,EAAM7T,QAAQ0M,OAAO1N,EAAWL,EAChC,UAMJ,IAJA,GAAIE,GAAO,GACPO,EAAsB,GAAI4K,OAAMpL,EAAWe,QAC3CV,EAAkB,EAClB8J,EAAO/J,EACJ+J,EAAOA,EAAKa,aAAeb,EAAK3H,WAAaC,KAAKoK,WACrD5M,GAAQuQ,EAA4BjG,IAAIzJ,KAAKqJ,GAC7C3J,EAAoBH,KAAqB8J,CAE7C8K,GAAM7T,QAAQmP,YAAYnQ,EAAWE,EAAQ,EAAGL,EAEhD,KAAK,GAAIE,GAAI,EAAGA,EAAIE,EAAiBF,IACjC8U,EAAM7T,QAAQ0M,OAAOtN,EAAoBL,GAAIJ,OAGjDK,GAAUgd,gBAQ1BxP,UAAW,SAAmB7N,GAC1B,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAK/C,GAAI6L,EAAM7T,QAAQiK,aAAarL,GAC3B,KAAMsF,GAAQlE,QAAQyE,iBAAiB,oBAI3C,OAAOoP,GAAM7T,QAAQoM,MAAMxN,EAAQ,OAAWD,MAMtDsd,YAAa,SAAqBtd,GAG9B,IAAKA,EACD,OAAA,CAGJ,IAAIgF,KAAKvC,WAAazC,EAAMyC,SACxB,OAAA,CAGJ,IAAIxC,GAAiB,OACjBE,EAAkB,MAEtB,QAAQ6E,KAAKvC,UACT,IAAKC,MAAKyK,mBACN,GAAInI,KAAKR,OAASxE,EAAMwE,MAAQQ,KAAKuY,WAAavd,EAAMud,UAAYvY,KAAKwY,WAAaxd,EAAMwd,SACxF,OAAA,CAEJ,MACJ,KAAK9a,MAAKC,aACN,GAAIqC,KAAK0B,eAAiB1G,EAAM0G,cAAgB1B,KAAKyY,SAAWzd,EAAMyd,QAAUzY,KAAKM,YAActF,EAAMsF,UACrG,OAAA,CAIJ,IAFArF,EAAiB4M,EAA4BrC,IAAIzJ,KAAKiE,MACtD7E,EAAkB0M,EAA4BrC,IAAIzJ,KAAKf,GACnDC,EAAee,QAAUb,EAAgBa,OACzC,OAAA,CAEJ,MACJ,KAAK0B,MAAKya,eACN,GAAInY,KAAK0B,eAAiB1G,EAAM0G,cAAgB1B,KAAKM,YAActF,EAAMsF,WAAaN,KAAKjD,QAAU/B,EAAM+B,MACvG,OAAA,CAEJ,MACJ,KAAKW,MAAKuK,4BACN,GAAIjI,KAAKkI,SAAWlN,EAAMkN,QAAUlI,KAAK+H,OAAS/M,EAAM+M,KACpD,OAAA,CAEJ,MACJ,KAAKrK,MAAKoK,UACV,IAAKpK,MAAKsK,aACN,GAAIhI,KAAK+H,OAAS/M,EAAM+M,KACpB,OAAA,EAKZ,GAAI/H,KAAKvC,UAAYC,KAAKC,aACtB,IAAK,GAAItC,GAAI,EAAGA,EAAIJ,EAAee,OAAQX,IAAK,CAC5C,GAAIE,GAAQN,EAAeI,GACvBH,EAAQC,EAAgBI,EAAMiE,KAClC,IAAIjE,EAAMwB,QAAU7B,EAAM6B,MACtB,OAAA,EAKZ,GAAItB,GAAcuE,KAAKyE,WACnBnJ,EAAcN,EAAMyJ,UACxB,IAAIhJ,EAAYO,SAAWhB,EAAMyJ,WAAWzI,OACxC,OAAA,CAGJ,KAAK,GAAIoJ,GAAK,EAAGA,EAAK3J,EAAYO,OAAQoJ,IACtC,IAAK3J,EAAY2J,GAAIkT,YAAYhd,EAAY8J,IACzC,OAAA,CAIR,QAAA,GAKJsT,wBAAyB,SAAiC1d,GAGtD,GAAIgF,OAAShF,EACT,MAAO,EAGX,IAAIC,GAAQD,EACRG,EAAQ6E,KACR3E,EAAQ,KACRE,EAAQ,IAOZ,IALIN,EAAMwC,UAAYN,SAASC,UAAU+a,iBACrC9c,EAAQJ,EACRA,EAAQI,EAAMuP,cAGdzP,EAAMsC,UAAYN,SAASC,UAAU+a,iBACrC5c,EAAQJ,EACRA,EAAQI,EAAMqP,aAEVvP,GAASJ,GAASE,IAAUF,GAE5B,IAAK,GADDC,GAAQC,EAAMwd,YACTld,EAAI,EAAGA,EAAIP,EAAMc,OAAQP,IAAK,CACnC,GAAIH,GAAOJ,EAAMO,EACjB,IAAIH,EAAKgd,YAAYjd,GACjB,MAAO8B,UAASC,UAAUwb,0CAA4Czb,SAASC,UAAUyb,2BACtF,IAAIvd,EAAKgd,YAAY/c,GACxB,MAAO4B,UAASC,UAAUwb,0CAA4Czb,SAASC,UAAU0b,4BAMzG,MAAK7d,IAAUE,GAAS+U,EAAM7T,QAAQ+J,KAAKnL,KAAWiV,EAAM7T,QAAQ+J,KAAKjL,GAIrEkc,EAAWlc,EAAOF,IAAUA,IAAUE,GAASI,EACxC4B,SAASC,UAAU2b,2BAA6B5b,SAASC,UAAUyb,4BAG1ExB,EAAWpc,EAAOE,IAAUF,IAAUE,GAASE,EACxC8B,SAASC,UAAU2b,2BAA6B5b,SAASC,UAAU0b,4BAG1ExB,EAAUrc,EAAOE,GACVgC,SAASC,UAAUyb,4BAGvB1b,SAASC,UAAU0b,4BAff3b,SAASC,UAAUwb,0CAA4Czb,SAASC,UAAU0b,4BAA8B3b,SAASC,UAAU4b,gCAoBlJvH,SAAU,SAAkBzW,GAGxB,GAAIC,GAASD,EAAKwG,UAElB,KAAKvG,EACD,OAAA,CAGJ,GACI,IAAIA,IAAW+E,KACX,OAAA,QAEC/E,EAASA,EAAOuG,WAEzB,QAAA,GAKJyX,aAAc,SAAsBje,EAAMC,GACtC,GAAIE,GAAS6E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAI/C,MAAO6L,GAAM7T,QAAQgP,UAAUrQ,EAAMG,EAAQF,MAMrDuN,YAAa,SAAqBxN,GAC9B,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAI/C,MAAO6L,GAAM7T,QAAQuM,OAAO5N,EAAMC,MAM1Cie,aAAc,SAAsBle,EAAMC,GACtC,GAAIE,GAAS6E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAI/C,MAAO6L,GAAM7T,QAAQ8K,QAAQlM,EAAOD,EAAMG,MAMlDge,YAAa,SAAqBne,GAC9B,GAAIC,GAAS+E,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAI/C,MAAO6L,GAAM7T,QAAQqR,UAAU1S,EAAOC,wFC/dlD,YAkBA,SAASkB,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAhBvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAIrC5I,GAAQO,SAEJkK,GAAIA,YACA,MAAO,gBAGXgD,GAAIA,QACA,MAAOhJ,GAAQlE,QAAQwJ,eAAe7F,MAAMuJ,MAGhDN,GAAIA,QACA,MAAO1I,GAAQlE,QAAQwJ,eAAe7F,MAAMiJ,MAIhDwK,GAAIA,aACA,MAAOvD,GAAM7T,QAAQ6K,sBAAsBlH,OAI/CyT,GAAIA,WAAUzY,GACV,GAAIC,GAAQ+E,IAEZ,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAC/C,GAAI/I,GAAW4U,EAAM7T,QAAQoK,kBAAkBzL,EAAOC,EACtDiV,GAAM7T,QAAQoR,WAAWnS,EAAUL,wFC7C/C,YAcA,SAASkB,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAZvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,EAMrC5I,GAAQO,SAGJ+c,UAAW,SAAmBpe,GAC1B,GAAIC,GAAS+E,KAAKhE,MAClB,IAAIhB,EAASC,EACT,KAAMsF,GAAQlE,QAAQyE,iBAAiB,iBAE3C,IAAIrF,GAAQR,EAASD,EACjBG,EAAU6E,KAAK+H,KAAK5C,MAAMnK,EAAQS,GAClCH,EAAU0E,KAAKyB,cAAc8G,eAAepN,GAC5CE,EAAS2E,KAAKwB,UAQlB,OAPInG,IACA6U,EAAM7T,QAAQwQ,OAAOvR,EAASD,EAAQ2E,KAAKiG,aAG/CiK,EAAM7T,QAAQmP,YAAYxL,KAAMhF,EAAQS,EAAO,IAGxCH,2DCrCf,YAUA,SAASa,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GARvF,GAAIqe,GAAa7d,EAAQ,mBAErB8d,EAAcnd,EAAuBkd,GAErCxJ,EAAkBrU,EAAQ,wBAE1BmN,EAAmBxM,EAAuB0T,GAI1C0J,GAAA,EACAC,GAAA,GAEA3c,OAAO,2BAA8Byc,EAAYjd,QAAQwI,gBACzD0U,GAAA,IAGA1c,OAAO,gCAAmC8L,EAAiBtM,QAAQwI,gBACnE0U,GAAA,EACAC,GAAA,GAGAD,IACAD,EAAYjd,QAAQC,UACpBO,OAAO4c,qBAAA,GAGPD,GACA7Q,EAAiBtM,QAAQC,UACzBO,OAAO6c,0BAAA,GAGP/Q,EAAiBtM,QAAQsD,sGClC7B,YAyKA,SAASxD,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAvKvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,OAGI2e,OAAQ,WAGJ,IAAK,GAFD3e,GAAQgF,KAEH/E,EAAO0W,UAAU3V,OAAQd,EAAQmL,MAAMpL,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC1ED,EAAMC,GAAQwW,UAAUxW,EAG5B,OAAOwN,GAAiBtM,QAAQgI,mBAAmB,WAK/C,GAAIpJ,GAASD,EAAMwG,UAGnB,IAAKvG,EAAL,CAOA,IADA,GAAIE,GAAwBH,EAAMsS,gBAC3BnS,GAAyBD,EAAMqI,QAAQpI,MAAA,GAC1CA,EAAwBA,EAAsBmS,eAKlD,IAAIjS,GAAO6U,EAAM7T,QAAQiM,sBAAsBpN,EAAOF,EAAMyG,cAKxDtG,GAD0B,OAA1BA,EACwBF,EAAO+K,WAEP7K,EAAsB8K,YAKlDiK,EAAM7T,QAAQgP,UAAUhQ,EAAMJ,EAAQE,OAM9Cye,MAAO,WAGH,IAAK,GAFD5e,GAASgF,KAEJ/E,EAAQ0W,UAAU3V,OAAQd,EAAQmL,MAAMpL,GAAQE,EAAQ,EAAGA,EAAQF,EAAOE,IAC/ED,EAAMC,GAASwW,UAAUxW,EAG7B,OAAOwN,GAAiBtM,QAAQgI,mBAAmB,WAK/C,GAAIpJ,GAASD,EAAOwG,UAGpB,IAAKvG,EAAL,CAOA,IADA,GAAIE,GAAoBH,EAAOiL,YACxB9K,GAAqBD,EAAMqI,QAAQpI,MAAA,GACtCA,EAAoBA,EAAkB8K,WAK1C,IAAI5K,GAAO6U,EAAM7T,QAAQiM,sBAAsBpN,EAAOF,EAAOyG,cAI7DyO,GAAM7T,QAAQgP,UAAUhQ,EAAMJ,EAAQE,OAM9C0e,YAAa,WAGT,IAAK,GAFD7e,GAASgF,KAEJ/E,EAAQ0W,UAAU3V,OAAQd,EAAQmL,MAAMpL,GAAQE,EAAQ,EAAGA,EAAQF,EAAOE,IAC/ED,EAAMC,GAASwW,UAAUxW,EAG7B,OAAOwN,GAAiBtM,QAAQgI,mBAAmB,WAK/C,GAAIpJ,GAASD,EAAOwG,UAGpB,IAAKvG,EAAL,CAOA,IADA,GAAIE,GAAoBH,EAAOiL,YACxB9K,GAAqBD,EAAMqI,QAAQpI,MAAA,GACtCA,EAAoBA,EAAkB8K,WAK1C,IAAI5K,GAAO6U,EAAM7T,QAAQiM,sBAAsBpN,EAAOF,EAAOyG,cAIzDzG,GAAOwG,YAAcvG,EACrBiV,EAAM7T,QAAQ8K,QAAQnM,EAAQK,EAAMJ,GAKhCiV,EAAM7T,QAAQgP,UAAUhQ,EAAMJ,EAAQE,OAOtD4N,OAAQ,WACJ,GAAI/N,GAASgF,IAEb,OAAO2I,GAAiBtM,QAAQgI,mBAAmB,WAK/C,GAAIpJ,GAASD,EAAOwG,UAEfvG,IAKLiV,EAAM7T,QAAQ0M,OAAO/N,EAAQC,OAM7C,IAAIgV,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,mECvK9C,YAUA,SAAS1T,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GARvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIkT,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,EAInCnU,GAAQO,SAQJyd,GAAIA,iBACA,GAAI9e,GAAWgF,KAAKyB,eAAiBzB,KACjC/E,EAAsB8e,OAAOD,cAActU,IAAIzJ,KAAKf,EAExD,OAAKC,IAAuBD,GAAYkV,EAAM7T,QAAQ6M,oBAAoBlJ,MAInEkQ,EAAM7T,QAAQoN,SAASxO,EAAqB+E,MAHxC,6CCzBnB,YA4EA,SAAS7D,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GA1EvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,GAAIC,GAAgCsF,EAAQlE,QAAQuI,WAAWlH,KAAM,mBACjEvC,EAA4BoF,EAAQlE,QAAQuI,WAAWlH,KAAM,eAC7DjC,EAAuC8E,EAAQlE,QAAQuI,WAAW5J,EAAM,0BACxEM,EAAmCiF,EAAQlE,QAAQuI,WAAW5J,EAAM,qBAExE,QAGIgf,GAAIA,0BACA,GAAIhf,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,GAAaA,EAAUwG,WAAY,CAGnC,IAFA,GAAIrG,GAAaoF,EAAQlE,QAAQwJ,eAAe7K,EAAUwG,YAAYiD,WAClEnJ,EAAQH,EAAWoI,QAAQvD,MACxB1E,EAAQ,GAAG,CACd,GAAIO,GAAWV,IAAaG,EAC5B,IAAIO,EAAS4B,WAAaC,KAAKC,aAC3B,MAAO9B,GAGf,MAAO,MACJ,GAAIJ,EACP,MAAOA,GAAqC+J,IAAIzJ,KAAKiE,KAIrD,KAFA,GAAI9E,GAAqBD,EAA8BuK,IACnDnK,EAAkB2E,KACf3E,EAAkBH,EAAmBa,KAAKV,IAC7C,GAAIA,EAAgBoC,WAAaC,KAAKC,aAClC,MAAOtC,EAGf,OAAO,OAKf4e,GAAIA,sBACA,GAAIjf,GAAYuF,EAAQlE,QAAQwJ,eAAe7F,KAC/C,IAAIhF,GAAaA,EAAUwG,WAAY,CAGnC,IAFA,GAAIvG,GAAasF,EAAQlE,QAAQwJ,eAAe7K,EAAUwG,YAAYiD,WAClEhJ,EAAQR,EAAWsI,QAAQvD,MACxBvE,EAAQR,EAAWe,OAAS,GAAG,CAClC,GAAIH,GAAOZ,IAAaQ,EACxB,IAAII,EAAK4B,WAAaC,KAAKC,aACvB,MAAO9B,GAGf,MAAO,MACJ,GAAIP,EACP,MAAOA,GAAiCkK,IAAIzJ,KAAKiE,KAIjD,KAFA,GAAI9E,GAAiBC,EAA0BqK,IAC3CnK,EAAc2E,KACX3E,EAAcH,EAAea,KAAKV,IACrC,GAAIA,EAAYoC,WAAaC,KAAKC,aAC9B,MAAOtC,EAGf,OAAO,QAOvB,IAAIqJ,GAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,4CC1ErC,YAiCA,SAASvI,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GA/BvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,OACIkf,eAAgB,SAAwBlf,GAGpC,GAAW,KAAPA,GAAa,KAAKsE,KAAKtE,GACvB,MAAO,KAGX,IAAIC,GAAa+E,KAAKgG,UAEtB,OAAK/K,GAIEiV,EAAM7T,QAAQ6J,8BAA8BjL,EAAY,SAAUA,GACrE,MAAOA,GAAKkf,KAAOnf,IAJZ,OAUvB,IAAIiV,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,yCC/BnC,YAyNA,SAAS9T,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAvNvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,GAAIC,IACAmf,SAAU7Z,EAAQlE,QAAQuI,WAAW5J,EAAM,YAC3Cqf,kBAAmB9Z,EAAQlE,QAAQuI,WAAW5J,EAAM,qBACpDsf,iBAAkB/Z,EAAQlE,QAAQuI,WAAW5J,EAAM,oBACnDuf,kBAAmBha,EAAQlE,QAAQuI,WAAW5J,EAAM,qBAGxD,QAEIof,GAAIA,YACA,GAAIpf,GAAa,OAEbG,EAAcoF,EAAQlE,QAAQwJ,eAAe7F,KAKjD,IAJI7E,IACAH,EAAaG,EAAYsJ,aAGxBzJ,EAAY,CACb,GAAIC,EAAOmf,SACP,MAAOnf,GAAOmf,SAAS5U,IAAIzJ,KAAKiE,KAEpChF,GAAagF,KAAKyE,WAMtB,IAAK,GAHD5I,GAAmBb,EAAWgB,OAC9BP,EAAW,GAAI4K,OAAMxK,GACrBX,EAAS,EACJG,EAAI,EAAGA,EAAIQ,EAAkBR,IAAK,CACvC,GAAIC,GAAON,EAAWK,EAClBC,GAAKmC,UAAYC,KAAKC,eACtBlC,EAASP,KAAYI,GAK7B,MAFAG,GAASO,OAASd,EAEXO,GAGX4e,GAAIA,qBACA,GAAIrf,GAAa,OAEbG,EAAcoF,EAAQlE,QAAQwJ,eAAe7F,KAKjD,IAJI7E,IACAH,EAAaG,EAAYsJ,aAGxBzJ,EAAY,CACb,GAAIC,EAAOof,kBACP,MAAOpf,GAAOof,kBAAkB7U,IAAIzJ,KAAKiE,KAE7ChF,GAAagF,KAAKyE,WAGtB,IAAK,GAAI5I,GAAI,EAAGA,EAAIb,EAAWgB,OAAQH,IAAK,CACxC,GAAIJ,GAAOT,EAAWa,EACtB,IAAIJ,EAAKgC,UAAYC,KAAKC,aACtB,MAAOlC,GAIf,MAAO,OAGX6e,GAAIA,oBACA,GAAItf,GAAa,OAEbG,EAAcoF,EAAQlE,QAAQwJ,eAAe7F,KAKjD,IAJI7E,IACAH,EAAaG,EAAYsJ,aAGxBzJ,EAAY,CACb,GAAIC,EAAOqf,iBACP,MAAOrf,GAAOqf,iBAAiB9U,IAAIzJ,KAAKiE,KAE5ChF,GAAagF,KAAKyE,WAGtB,IAAK,GAAI5I,GAAIb,EAAWgB,OAAS,EAAGH,GAAK,EAAGA,IAAK,CAC7C,GAAIJ,GAAOT,EAAWa,EACtB,IAAIJ,EAAKgC,UAAYC,KAAKC,aACtB,MAAOlC,GAIf,MAAO,OAGX8e,GAAIA,qBACA,GAAIvf,GAAa,OAEbG,EAAcoF,EAAQlE,QAAQwJ,eAAe7F,KAKjD,IAJI7E,IACAH,EAAaG,EAAYsJ,aAGxBzJ,EAAY,CACb,GAAIC,EAAOsf,kBACP,MAAOtf,GAAOsf,kBAAkB/U,IAAIzJ,KAAKiE,KAE7ChF,GAAagF,KAAKyE,WAKtB,IAAK,GAFD5I,GAAQ,EAEHJ,EAAI,EAAGA,EAAIT,EAAWgB,OAAQP,IAAK,CACxC,GAAIP,GAAOF,EAAWS,EAClBP,GAAKuC,UAAYC,KAAKC,cACtB9B,IAIR,MAAOA,IAIX2e,QAAS,WAGL,IAAK,GAFDxf,GAAQgF,KAEH/E,EAAO0W,UAAU3V,OAAQb,EAAQkL,MAAMpL,GAAOY,EAAO,EAAGA,EAAOZ,EAAMY,IAC1EV,EAAMU,GAAQ8V,UAAU9V,EAG5B,OAAO8M,GAAiBtM,QAAQgI,mBAAmB,WAM/C,GAAIpJ,GAAOiV,EAAM7T,QAAQiM,sBAAsBnN,EAAOH,EAAMyG,eAAiBzG,EAI7EkV,GAAM7T,QAAQgP,UAAUpQ,EAAMD,EAAOA,EAAMgL,eAMnD4C,OAAQ,WAGJ,IAAK,GAFD5N,GAASgF,KAEJ/E,EAAQ0W,UAAU3V,OAAQb,EAAQkL,MAAMpL,GAAQY,EAAQ,EAAGA,EAAQZ,EAAOY,IAC/EV,EAAMU,GAAS8V,UAAU9V,EAG7B,OAAO8M,GAAiBtM,QAAQgI,mBAAmB,WAM/C,GAAIpJ,GAAOiV,EAAM7T,QAAQiM,sBAAsBnN,EAAOH,EAAOyG,eAAiBzG,EAG9EkV,GAAM7T,QAAQuM,OAAO3N,EAAMD,MAMnCyf,cAAe,SAAuBzf,GAClC,GAAIC,GAAU+E,KAAK0a,iBAAiB1f,EAEpC,OAAIC,GAAQe,OACDf,EAAQ,GAGZ,MAKXyf,iBAAkB,SAA0B1f,GAOxC,GAAIC,MAEAE,EAAa6E,KAAKgG,UAEtB,OAAK7K,IAIL+U,EAAM7T,QAAQ0J,4BAA4B5K,EAAYF,EAAS,SAAUA,GACrE,MAAOA,GAAKwC,WAAaC,KAAKC,cAAgB1C,EAAKoY,QAAQrY,KAGxDC,GAPIA,IAYvB,IAAIgV,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BJ,EAAkBrU,EAAQ,yBAE1BmN,EAAmBxM,EAAuB0T,GAE1CnL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,oFCvNrC,YAmCA,SAASvI,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAjCvF2B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAGJjB,EAAQO,QAAU,SAAUrB,GAExB,OAEIgP,GAAIA,gBAGA,GAAIhP,GAAcuF,EAAQlE,QAAQwJ,eAAe7F,KACjD,IAAIhF,EAAa,CACb,GAAIC,GAAOD,EAAYgP,YACvB,OAAI/O,IAAQiV,EAAM7T,QAAQiN,mBAAmBrO,EAAM+E,MACxC,KAEJ/E,EAEX,MAAO,QAMnB,IAAIgV,GAAOzU,EAAQ,aAEf0U,EAAQ/T,EAAuB8T,GAE/BvL,EAASlJ,EAAQ,eAEjB+E,EAAUpE,EAAuBuI,0DCjCrC,YAiBA,SAASvI,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GA0WvF,QAAS2f,GAAc3f,GACnB,MAAO,UAAUC,EAAME,GACnBH,EAAgBA,GAAiBG,EAAK2G,aACtC,IAAIjG,GAAa0E,EAAQlE,QAAQuI,WAAW3J,EAAME,EAClDwB,QAAOC,eAAe3B,EAAKmC,UAAWjC,GAClC8B,cAAA,EACAC,YAAA,EACAsI,IAAK3J,EAAaA,EAAW2J,IAAM,WAC/B,MAAOxF,MAAKgR,aAAahW,IAAkB,IAE/C+L,IAAK,SAAa9L,GACdiV,EAAM7T,QAAQ2O,kBAAkBhL,KAAMhF,EAAeC,OAMrE,QAAS2f,GAAe5f,GACpB,MAAO,UAAUC,EAAME,GACnBH,EAAgBA,GAAiBG,EAAK2G,cACtCnF,OAAOC,eAAe3B,EAAKmC,UAAWjC,GAClC8B,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,MAAOxF,MAAK6a,aAAa7f,IAE7B+L,IAAK,SAAa9L,GACVA,KAAA,EACAiV,EAAM7T,QAAQ4O,sBAAsBjQ,EAAegF,MAEnDkQ,EAAM7T,QAAQ2O,kBAAkBhL,KAAMhF,EAAeC,OAQzE,QAAS6f,GAAe9f,EAAUC,GAC9B,MAAO,UAAUD,EAAMG,GACnB,GAAIU,GAAgBV,EAAK2G,aACzB7G,GAAeA,GAAgB,EAC/B0B,OAAOC,eAAe5B,EAAKoC,UAAWjC,GAClC8B,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,GAAIxK,GAAQgF,KAAKgR,aAAanV,EAC9B,OAAOkf,UAAS/f,IAAUC,GAE9B8L,IAAK,SAAa/L,GACd,GAAqB,gBAAVA,GACP,KAAMuF,GAAQlE,QAAQyE,iBAAiB,YAE3CoP,GAAM7T,QAAQ2O,kBAAkBhL,KAAMnE,EAAeb,EAAMggB,gBAO3E,QAASC,GAAajgB,EAAUC,GAC5B,MAAO,UAAUD,EAAMG,GACnB,GAAIU,GAAgBV,EAAK2G,aACzB7G,GAAeA,GAAgB,EAC/B0B,OAAOC,eAAe5B,EAAKoC,UAAWjC,GAClC8B,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,GAAIxK,GAAQgF,KAAKgR,aAAanV,EAC9B,OAAOqf,YAAWlgB,IAAUC,GAEhC8L,IAAK,SAAa/L,GACd,GAAqB,gBAAVA,GACP,KAAMuF,GAAQlE,QAAQyE,iBAAiB,YAE3CoP,GAAM7T,QAAQ2O,kBAAkBhL,KAAMnE,EAAeb,EAAMggB,gBAM3E,QAASG,GAAoBngB,GACzB,MAAO,UAAUC,EAAME,GACnBwB,OAAOC,eAAe3B,EAAKmC,UAAWjC,GAClC8B,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,OAAA,EAAW4V,EAAc9J,yBAAyBtR,KAAMhF,IAE5D+L,IAAK,SAAa9L,IAAA,EACVmgB,EAAc9J,yBAAyBtR,KAAMhF,GAAW+B,MAAQ9B,MAMpF,QAASogB,GAAmBrgB,EAAeC,GACvC,MAAO,UAAUE,EAAMU,GACnB,GAAIX,GAAgBW,EAAKiG,aACzBnF,QAAOC,eAAezB,EAAKiC,UAAWvB,GAClCoB,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,IAAKxF,KAAK6a,aAAa3f,GACnB,MAAO,KAEX,IAAID,GAAK+E,KAAKgR,aAAa9V,GACvBC,EAAY6E,KAAKyB,cAAcyY,eAAejf,EAClD,OAAiB,OAAbE,GAAuBA,YAAqBH,GAGzCG,EAFI,MAIf4L,IAAK9L,EAAW,OAAY,SAAUA,GAClC,KAAMA,YAAiBD,IACnB,KAAMuF,GAAQlE,QAAQyE,iBAAiB,YAE3C,IAAI7F,EAAM4f,aAAa,MAAO,CAC1B,GAAI1f,GAAQ6E,KAAKyB,cAAcyY,eAAejf,EAAMkf,GACpD,IAAIlf,IAAUE,EAEV,WADA6E,MAAKgC,aAAa9G,EAAeD,EAAMkf,IAI/Cna,KAAKgC,aAAa9G,EAAe,QAMjD,QAASogB,KACL,MAAO,UAAUtgB,EAAMC,GACnB0B,OAAOC,eAAe5B,EAAKoC,UAAWnC,GAClCgC,cAAA,EACAC,YAAA,EACAsI,IAAK,WACD,MAAOxF,MAAKoY,aAEhBrR,IAAK,SAAa/L,GACdgF,KAAKoY,YAAcpd,MAMnC,QAASugB,KAEL,IAAK,GADDvgB,GAAc2B,OAAO0C,oBAAoBmc,GACpCvgB,EAAI,EAAGA,EAAID,EAAYgB,OAAQf,IAAK,CACzC,GAAIE,GAAaH,EAAYC,EAC7B,IAAIE,IAAc0B,QAGd,IAAK,GAFDhB,GAAOgB,OAAO1B,GACdD,EAAayB,OAAO0C,oBAAoBmc,EAAWrgB,IAC9CkF,EAAI,EAAGA,EAAInF,EAAWc,OAAQqE,IAAK,CACxC,GAAI5E,GAAYP,EAAWmF,EAC3Bmb,GAAWrgB,GAAYM,GAAWI,EAAMJ,KAnhBxDkB,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,IAEJjB,EAAQyf,SAAWA,CAEnB,IAAI7W,GAASlJ,EAAQ,cAEjB+E,EAAUpE,EAAuBuI,GAEjCuL,EAAOzU,EAAQ,YAEf0U,EAAQ/T,EAAuB8T,GAE/BmL,EAAgB5f,EAAQ,gCAgBxBggB,GACA1P,SACIqO,GAAMQ,IACNc,UAAad,EAAc,SAC3Be,UAAaP,EAAoB,SACjCpP,KAAQ4O,KAEZtZ,aACIsa,MAAShB,IACTiB,KAAQjB,IACRkB,UAAalB,IACbmB,IAAOnB,IAGPoB,OAAUnB,IACVoB,SAAYlB,EAAe,KAAM,GACjCmB,UAAatB,IACbuB,UAAavB,IACbwB,YAAed,EAAmBxe,OAAOuf,iBACzCC,WAAc1B,IAEd2B,gBAAmB3B,KAEvB4B,mBACIrU,OAAUyS,IACV6B,SAAY7B,IACZ8B,IAAO9B,IACP+B,IAAO/B,IACPgC,QAAWxB,EAAoB,OAC/ByB,SAAYjC,IACZnX,KAAQmX,IACRkC,KAAQvB,KAEZwB,iBACIC,IAAOpC,IACPqC,OAAUrC,IACVsC,MAAStC,IACTzS,OAAUyS,IACV6B,SAAY7B,IACZ8B,IAAO9B,IACPgC,QAAWxB,EAAoB,OAC/ByB,SAAYjC,IACZnX,KAAQmX,KAEZuC,iBACIC,KAAQxC,IACRzS,OAAUyS,KAEdyC,mBACIC,UAAazC,IACb0C,SAAY1C,IAEZ2C,WAAc5C,IACd6C,YAAe7C,IACf8C,WAAc9C,IACd+C,eAAkB9C,IAClB+C,WAAchD,IACdnb,KAAQmb,IACRnX,KAAQmX,IACR5d,MAAS4d,IACTiD,KAAQvC,EAAmBxe,OAAOuf,kBAEtCyB,mBACIC,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,IAEnCkD,iBACIjhB,MAAS4d,KAEbsD;AACIC,KAAQtD,KAEZuD,kBACIC,IAAOzD,IACPnX,KAAQmX,IACRmD,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,IAEnCuD,qBACIf,SAAY1C,IAEZpb,KAAQmb,KAEZ2D,iBACIC,cAAiB5D,EAAc,kBAC/B6D,OAAU7D,IACV8D,aAAgB9D,IAChB+D,QAAW/D,IACXgE,SAAYhE,EAAc,WAC1BiE,OAAUjE,IACVnb,KAAQmb,IACRkE,WAAcjE,IACd1S,OAAUyS,KAEdmE,mBACIV,IAAOzD,IACPoE,OAAUpE,IACVnb,KAAQmb,IACRqE,QAAW7D,EAAoB,WAC/B8D,gBAAmBrE,IACnBkD,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,IAEnCoE,kBACInC,IAAOpC,IACPyD,IAAOzD,IACPwE,OAAUxE,IACVyE,YAAezE,IACf0E,OAAU1E,IACV2E,MAAS1E,IACTkD,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,IAGnCyE,kBACIC,OAAU7E,IACVoC,IAAOpC,IACP8D,aAAgB9D,IAChB0C,UAAazC,IACb6E,eAAkB7E,EAAe,WACjC8E,QAAW/E,IACX2C,SAAY1C,IAEZ2C,WAAc5C,IACd6C,YAAe7C,IACf8C,WAAc9C,IACd+C,eAAkB9C,IAClB+C,WAAchD,IACdoD,OAAUjD,EAAe,KAAM,GAC/B6E,UAAahF,IAMbiF,IAAOjF,IACPkF,UAAa/E,EAAe,EAAG,GAC/BpD,IAAOiD,IACPmF,UAAahF,EAAe,EAAG,GAC/BiF,SAAYnF,IACZpb,KAAQmb,IACRqF,QAAWrF,IACXsF,YAAetF,IACfuF,SAAYtF,IACZuF,SAAYvF,IACZwF,KAAQtF,EAAe,EAAG,GAC1BsD,IAAOzD,IACP0F,KAAQ1F,IACRnX,KAAQmX,IACR2F,aAAgB3F,EAAc,SAC9BmD,MAAShD,EAAe,KAAM,IAElCyF,mBACIlD,UAAazC,IACb4F,UAAa7F,IACb2C,SAAY1C,IAEZ6F,QAAW9F,IACXnb,KAAQmb,KAEZ+F,kBAEIC,QAAWhG,EAAc,QAE7BiG,qBAGAC,eACI9jB,MAAS4d,KAEbmG,iBACI3D,KAAQxC,IACRyE,YAAezE,IACf8B,IAAO9B,IACP+B,IAAO/B,IACPgC,QAAWxB,EAAoB,OAC/B4F,MAASpG,IACTiC,SAAYjC,IACZnX,KAAQmX,IACRqG,MAAS7F,EAAoB,UAEjC8F,gBACIzhB,KAAQmb,KAEZuG,kBACI9C,IAAOzD,IACPyE,YAAezE,IACfwG,QAAWxG,IACXyG,KAAQxG,IACRyG,SAAYzG,IACZ0G,WAAc3G,IACd4G,SAAY3G,IACZ4G,aAAgB5G,EAAe,UAEnCwB,iBACI5Y,KAAQmX,IACR8G,MAAS9G,KAEb+G,qBACIle,KAAQmX,IACR8G,MAAS9G,IACTgH,KAAQhH,IACR2C,SAAY1C,IACZgH,QAAWhH,EAAe,WAC1BiH,WAAclH,IACdte,QAAWue,KAEfkH,iBACItiB,KAAQmb,IACRoH,UAAapH,EAAc,cAC3BnT,QAAWmT,KAEfqH,kBACIjlB,MAASke,EAAa,KAAM,GAC5BvD,IAAOuD,EAAa,KAAM,GAC1B2E,IAAO3E,EAAa,KAAM,GAC1BgH,IAAOhH,EAAa,KAAM,GAC1BiH,KAAQjH,EAAa,KAAM,GAC3BkH,QAAWlH,EAAa,KAAM,IAElCmH,gBACIC,KAAQ1H,IACR2H,SAAY3H,KAEhB4H,mBACIxa,KAAQ4S,IACRnX,KAAQmX,IACR6H,cAAiB5H,IACjBpb,KAAQmb,IAERmD,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,IAEnC2H,kBACIC,SAAY9H,IACZ+H,MAAS7H,EAAe,KAAM,GAC9BtX,KAAQmX,KAEZiI,qBACItF,SAAY1C,IACZ6G,MAAS9G,KAEbkI,mBACIvF,SAAY1C,IAEZ6G,MAAS9G,IACTmI,gBAAmBlI,EAAe,YAClC7d,MAAS4d,KAEboI,mBACIpC,QAAWxF,EAAoB,OAE/B3b,KAAQmb,IACR2F,aAAgB3F,EAAc,UAElCqI,kBACIxjB,KAAQmb,IACR5d,MAAS4d,KAEbsI,qBACIlmB,MAASke,EAAa,KAAM,GAC5B2E,IAAO3E,EAAa,KAAM,IAE9BiI,kBACIb,KAAQ1H,KAEZwI,mBACI/E,IAAOzD,IACPnX,KAAQmX,IACRyI,QAAWzI,IACX0I,MAASzI,IACT0I,MAAS1I,IACTwE,YAAezE,IAGf4I,MAAS5I,KAEb6I,mBACI/E,aAAgB9D,IAChB0C,UAAazC,IACb0C,SAAY1C,IAEZmF,SAAYnF,IACZpb,KAAQmb,IACRwF,SAAYvF,IACZwF,KAAQtF,EAAe,EAAG,IAE9B2I,mBACIrF,IAAOzD,IACPnX,KAAQmX,IACRoG,MAASpG,KAEb+I,kBACI3C,MAASpG,IACT4I,MAAS5I,IACTnX,KAAQmX,KAEZgJ,sBACIC,QAAW9I,EAAe,GAAA,GAC1B+I,QAAW/I,EAAe,GAAA,GAC1BgJ,QAAW3I,EAAoB,YAEnC4I,qBACIC,KAAQlJ,EAAe,EAAG,IAE9BmJ,4BACIC,MAASvJ,IACTwJ,KAAQxJ,KAEZyJ,qBACI3F,aAAgB9D,IAChB0C,UAAazC,IACbyJ,KAAQ1J,IACR+E,QAAW/E,IACX2C,SAAY1C,IAEZ+E,UAAahF,IACbkF,UAAa/E,EAAe,EAAG,GAC/BgF,UAAahF,EAAe,EAAG,GAC/Btb,KAAQmb,IACRsF,YAAetF,IACfuF,SAAYtF,IACZuF,SAAYvF,IACZhE,KAAQkE,EAAe,EAAG,GAC1BwJ,KAAQ3J,IACR2F,aAAgBhF,KAEpBiJ,iBACIjC,SAAY3H,KAEhB6J,kBACIC,KAAQ9J,IACRyD,IAAOzD,IACP+J,QAAW/J,IACX8G,MAAS9G,IACTte,QAAWue,KAEf+J,kBACI7G,MAAShD,EAAe,KAAM,GAC9BiD,OAAUjD,EAAe,KAAM,GAC/B8J,OAAUjK,4FCnXlB,YA0GA,SAASkK,GAAwB7pB,GAAO,GAAIA,GAAOA,EAAIoB,WAAc,MAAOpB,EAAc,IAAIC,KAAa,IAAW,MAAPD,EAAe,IAAK,GAAIE,KAAOF,GAAW2B,OAAOS,UAAU0nB,eAAe/oB,KAAKf,EAAKE,KAAMD,EAAOC,GAAOF,EAAIE,GAAgC,OAAtBD,GAAOoB,QAAUrB,EAAYC,EAElQ,QAASkB,GAAuBnB,GAAO,MAAOA,IAAOA,EAAIoB,WAAapB,GAAQqB,QAASrB,GAUvF,QAASsB,KAGLO,OAAO,aAAgBkoB,OAAA,GAGvBC,EAAQzJ,WAKHzP,QAAQ1O,UAAUiW,UACnBvH,QAAQ1O,UAAUiW,QAAUvH,QAAQ1O,UAAU6nB,iBAAmBnZ,QAAQ1O,UAAU8nB,oBAAsBpZ,QAAQ1O,UAAU+nB,mBAAqBrZ,QAAQ1O,UAAUgoB,kBAAoBtZ,QAAQ1O,UAAUioB,uBAI5M9kB,EAAQlE,QAAQ8W,OAAOrD,KAAMwV,EAAOjpB,SAGpCkE,EAAQlE,QAAQ8W,OAAOpD,cAAewV,EAAgBlpB,SAGtDQ,OAAO+T,YAAc4U,EAAcnpB,QAGnCkE,EAAQlE,QAAQ8W,OAAOhW,SAAUsoB,EAAWppB,SAGxC,gBAAkBQ,SAElB0D,EAAQlE,QAAQ8W,OAAO/B,aAAcsU,EAAerpB,SAIxDkE,EAAQlE,QAAQ8W,OAAOrH,QAAS6Z,EAAUtpB,SAG1CkE,EAAQlE,QAAQ8W,OAAOsC,MAAOmQ,EAAQvpB,SACtCkE,EAAQlE,QAAQ8W,OAAOsB,WAAYoR,EAAOhS,kBAC1CtT,EAAQlE,QAAQ8W,OAAOwB,WAAYkR,EAAOhS,kBAC1C+R,EAAQvpB,QAAQe,UAAYqY,MAAMrY,UAClCP,OAAO4Y,MAAQmQ,EAAQvpB,QAGnB,eAAiB+X,QACjB7T,EAAQlE,QAAQ8W,OAAO2S,aAAA,EAAiBC,EAAc1pB,SAASypB,eAI/DvlB,EAAQlE,QAAQ8W,OAAOiB,QAAA,EAAY2R,EAAc1pB,SAAS+X,SAC1D7T,EAAQlE,QAAQ8W,OAAOzV,MAAA,EAAUqoB,EAAc1pB,SAASqB,QAI5D6C,EAAQlE,QAAQ8W,OAAO,mBAAqBtW,QAASmpB,gBAAkB/gB,mBAAoBghB,EAAkB5pB,SAG7GkE,EAAQlE,QAAQ8W,OAAO+S,iBAAkBC,EAAmB9pB,SAG5DkE,EAAQlE,QAAQ8W,OAAOiT,oBAAqBC,EAAsBhqB,SAGlEkE,EAAQlE,QAAQ8W,OAAOmT,wBAAyBC,EAA0BlqB,SAG1EQ,OAAO8H,iBAAmB6hB,EAAmBnqB,QAG7CkE,EAAQlE,QAAQ8W,OAAOnD,aAAcyW,EAAepqB,SAGpDkE,EAAQlE,QAAQ8W,OAAOzV,KAAMgpB,EAAOrqB,SAKpCkE,EAAQlE,QAAQ8W,OAAOwT,KAAMC,EAAOvqB,SAGpCkE,EAAQlE,QAAQ8W,OAAO0T,cAAA,EAAkBC,EAAYzqB,SAASwqB,eAC9DtmB,EAAQlE,QAAQ8W,OAAOrH,SAAA,EAAagb,EAAYzqB,SAASyP,UACzDvL,EAAQlE,QAAQ8W,OAAOpD,eAAA,EAAmB+W,EAAYzqB,SAAS0T,gBAG/DxP,EAAQlE,QAAQ8W,OAAOhW,SAAU4pB,EAAuB1qB,SACxDkE,EAAQlE,QAAQ8W,OAAOX,EAAanW,QAAS0qB,EAAuB1qB,SAGpEkE,EAAQlE,QAAQ8W,OAAOrH,SAAA,EAAakb,EAA2B3qB,SAASyP,UACxEvL,EAAQlE,QAAQ8W,OAAOpD,eAAA,EAAmBiX,EAA2B3qB,SAAS0T,gBAG9ExP,EAAQlE,QAAQ8W,OAAOhW,UAAA,EAAc8pB,EAAuB5qB,SAASc,WACrEoD,EAAQlE,QAAQ8W,OAAO3F,kBAAA,EAAsByZ,EAAuB5qB,SAASmR,mBAG7EjN,EAAQlE,QAAQ8W,OAAOhW,UAAA,EAAc+pB,EAAa7qB,SAASc,WAC3DoD,EAAQlE,QAAQ8W,OAAO3F,kBAAA,EAAsB0Z,EAAa7qB,SAASmR,mBACnEjN,EAAQlE,QAAQ8W,OAAOrH,SAAA,EAAaob,EAAa7qB,SAASyP,UAG1DvL,EAAQlE,QAAQ8W,OAAOrH,SAAA,EAAaqb,GAAW9qB,SAASyP,UACxDvL,EAAQlE,QAAQ8W,OAAOwT,MAAA,EAAUQ,GAAW9qB,SAASsqB,aAG9CjpB,MAAKN,UAAUkE,iBACfD,aAAYjE,UAAUse,gBACtBra,aAAYjE,UAAUgd,eACtB/Y,aAAYjE,UAAUkW,oBACtBjS,aAAYjE,UAAUqW,gBACtBpS,aAAYjE,UAAUsW,gBACtBrS,aAAYjE,UAAUoW,yBACtBnS,aAAYjE,UAAUmW,4BACtBlS,aAAYjE,UAAUuW,mBAtOjChX,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAI2H,GAASlJ,EAAQ,cAEjB+E,EAAUpE,EAAuBuI,GAEjC0iB,EAAW5rB,EAAQ,gBAEnBwpB,EAAUH,EAAwBuC,GAElCC,EAAQ7rB,EAAQ,wBAEhB8pB,EAASnpB,EAAuBkrB,GAEhCC,EAAiB9rB,EAAQ,iCAEzB+pB,EAAkBppB,EAAuBmrB,GAEzCC,EAAe/rB,EAAQ,+BAEvBgqB,EAAgBrpB,EAAuBorB,GAEvCC,EAAYhsB,EAAQ,4BAEpBiqB,EAAatpB,EAAuBqrB,GAEpCpM,EAAgB5f,EAAQ,gCAExBkqB,EAAiBvpB,EAAuBif,GAExCqM,EAAWjsB,EAAQ,2BAEnBmqB,EAAYxpB,EAAuBsrB,GAEnC5B,EAASrqB,EAAQ,yBAEjBoqB,EAAUzpB,EAAuB0pB,GAEjC6B,EAAelsB,EAAQ,+BAEvBuqB,EAAgB5pB,EAAuBurB,GAEvCC,EAAmBnsB,EAAQ,mCAE3ByqB,EAAoB9pB,EAAuBwrB,GAE3CC,EAAoBpsB,EAAQ,oCAE5B2qB,EAAqBhqB,EAAuByrB,GAE5CC,EAAuBrsB,EAAQ,uCAE/B6qB,EAAwBlqB,EAAuB0rB,GAE/CC,EAA2BtsB,EAAQ,2CAEnC+qB,EAA4BpqB,EAAuB2rB,GAEnDC,EAAoBvsB,EAAQ,oCAE5BgrB,EAAqBrqB,EAAuB4rB,GAE5CC,EAAgBxsB,EAAQ,gCAExBirB,EAAiBtqB,EAAuB6rB,GAExCC,EAAQzsB,EAAQ,wBAEhBkrB,EAASvqB,EAAuB8rB,GAEhC1V,EAAc/W,EAAQ,8BAEtBgX,EAAerW,EAAuBoW,GAEtC2V,EAAQ1sB,EAAQ,wBAEhBorB,EAASzqB,EAAuB+rB,GAEhCC,EAAa3sB,EAAQ,yBAErBsrB,EAAc3qB,EAAuBgsB,GAErCC,EAAwB5sB,EAAQ,oCAEhCurB,EAAyB5qB,EAAuBisB,GAEhDC,EAA4B7sB,EAAQ,wCAEpCwrB,EAA6B7qB,EAAuBksB,GAEpDC,EAAwB9sB,EAAQ,oCAEhCyrB,EAAyB9qB,EAAuBmsB,GAEhDC,EAAc/sB,EAAQ,0BAEtB0rB,EAAe/qB,EAAuBosB,GAEtCC,GAAYhtB,EAAQ,wBAEpB2rB,GAAahrB,EAAuBqsB,IAMpC3jB,GAAgB,gBAAkBiH,SAAQ1O,SAE9CtB,GAAQO,SACJwI,cAAeA,GACfvI,QAASA,izBClHb,YAsDA,SAASsI,GAAW5J,EAAMC,GACtB,MAAO0B,QAAO8rB,yBAAyBztB,EAAKoC,UAAWnC,GAI3D,QAAS6F,GAAiB9F,EAAMC,GAC5B,IACI,GAAIE,GAAYutB,EAAgC3rB,MAAMhB,KAAKc,OAAOiB,SAAU,MAC5EmJ,GAA0BlK,MAAMhB,KAAKZ,EAAWA,GAClD,MAAOA,GACL,MAAOwB,QAAOwU,OAAOhW,GACjBwtB,SACInjB,IAAK,WACD,MAAOvK,KAGfuE,MACIgG,IAAK,WACD,MAAOxK,KAGfY,MACI4J,IAAK,WACD,MAAOrK,GAAOS,OAGtBof,UACIje,MAAO,WACH,MAAI9B,GACOD,EAAO,KAAOC,EAElBD,OAO3B,QAAS4G,GAAY5G,GACb,WAAa6B,SAAU,SAAWA,QAAO+rB,SACzC/rB,OAAO+rB,QAAQC,MAAM7tB,GAI7B,QAASmY,GAAOnY,GACZ,IAAK,GAAIC,GAAQ0W,UAAU3V,OAAQb,EAASkL,MAAMpL,EAAQ,EAAIA,EAAQ,EAAI,GAAII,EAAQ,EAAGA,EAAQJ,EAAOI,IACpGF,EAAOE,EAAQ,GAAKsW,UAAUtW,EAGlC,KAAK,GAAIH,GAAI,EAAGA,EAAIC,EAAOa,OAAQd,IAI/B,IAAK,GAHDmF,GAAQlF,EAAOD,GACfO,EAAY4E,EAAMjD,WAAaiD,EAC/B9E,EAAQoB,OAAO0C,oBAAoB5D,GAC9B6J,EAAI,EAAGA,EAAI/J,EAAMS,OAAQsJ,IAAK,CACnC,GAAIF,GAAO7J,EAAM+J,EACjB,IAAa,gBAATF,EAAJ,CAGA,GAAIhK,GAAeuB,OAAO8rB,yBAAyBhtB,EAAW2J,EAC9DzI,QAAOC,eAAe5B,EAAOoC,WAAapC,EAAQoK,EAAMhK,KAKpE,QAASyK,GAAe7K,GACpB,MAAOA,GAAO8tB,QAGlB,QAASpiB,GAAe1L,EAAQC,GAC5B,MAAOD,GAAO8tB,QAAU7tB,EAzH5B0B,OAAOC,eAAed,EAAS,cAC3BiB,OAAA,GAGJ,IAAIoG,GAAe,gBAAkBtG,QAASA,OAAOsG,aAAe,SAAUnI,GAC1E,IAAK,GAAIC,GAAO0W,UAAU3V,OAAQb,EAAOkL,MAAMpL,EAAO,EAAIA,EAAO,EAAI,GAAII,EAAO,EAAGA,EAAOJ,EAAMI,IAC5FF,EAAKE,EAAO,GAAKsW,UAAUtW,EAG/B,OAAO0tB,YAAW3kB,MAAM,QAAYpJ,EAAU,GAAGguB,OAAO7tB,KAGxDqF,EAAiB,WACjB,GAAI7D,OAAO6D,eACP,MAAO7D,QAAO6D,cAGlB,IAAIxF,MACAC,IAEJ,OADAD,GAAKiuB,UAAYhuB,EACb0B,OAAOoD,eAAe/E,KAAUC,EACzB,SAAUD,EAAQC,GAErB,MADAD,GAAOiuB,UAAYhuB,EACZD,GAIR,SAAUA,EAAQC,GAErB,IAAK,GADDE,GAAQwB,OAAO0C,oBAAoBpE,GAC9BI,EAAI,EAAGA,EAAIF,EAAMa,OAAQX,IAAK,CACnC,GAAIH,GAAOC,EAAME,GACbgF,EAAc1D,OAAO8rB,yBAAyBxtB,EAAOC,EACzDyB,QAAOC,eAAe5B,EAAQE,EAAMmF,QAK5C4G,EAA4BrC,EAAWlH,KAAM,eAC7CgrB,EAAkC9jB,EAAWzH,SAAU,gBAE3DrB,GAAQO,SACJuI,WAAYA,EACZzB,aAAcA,EACd3C,eAAgBA,EAChBM,iBAAkBA,EAClBc,YAAaA,EACbuR,OAAQA,EACRtN,eAAgBA,EAChBa,eAAgBA","file":"./dist/shadow-dom.min.js.map","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = require('./utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// TODO: CEReactions annotations for Range in the DOM spec\n// TODO: CEReactions for interfaces in the HTML spec\n\n// TODO: Document in the README that a Promise polyfill \n// should be brought in to support whenDefined\n\nvar nativeHTMLElement = window.HTMLElement; // https://html.spec.whatwg.org/multipage/scripting.html#custom-elements\n\nvar nativeCreateElement = Document.prototype.createElement;\nvar nativeCreateElementNS = Document.prototype.createElementNS;\nvar nativeMutationObserver = window.MutationObserver;\nvar nodeAppendChildDescriptor = _utils2.default.descriptor(Node, 'appendChild');\n\nvar htmlNamespace = 'http://www.w3.org/1999/xhtml';\nvar alreadyConstructedMarker = 1;\nvar upgradeReactionType = 1;\nvar callbackReactionType = 2;\nvar CE_STATE_FAILED = 'failed';\nvar CE_STATE_CUSTOM = 'custom';\nvar CE_STATE_UNDEFINED = 'undefined';\nvar CE_PROP_NAME = 'customElements';\nvar CE_CALLBACK_CONNECTED = 'connectedCallback';\nvar CE_CALLBACK_DISCONNECTED = 'disconnectedCallback';\nvar CE_CALLBACK_ADOPTED = 'adoptedCallback';\nvar CE_CALLBACK_ATTRIBUTE_CHANGED = 'attributeChangedCallback';\nvar DOM_CONTENT_LOADED = 'DOMContentLoaded';\nvar CTOR_PROP_NAME = 'constructor';\nvar ATTR_IS_NAME = 'is';\n\nvar nativeSupport = CE_PROP_NAME in window;\nvar promisesSupported = 'Promise' in window;\n\nexports.default = {\n    nativeSupport: nativeSupport,\n    install: install,\n    uninstall: uninstall,\n    isInstalled: isInstalled,\n    installTranspiledClassSupport: installTranspiledClassSupport,\n    isCustom: isCustom,\n    tryToUpgradeElement: tryToUpgradeElement,\n    enqueueConnectedReaction: enqueueConnectedReaction,\n    enqueueDisconnectedReaction: enqueueDisconnectedReaction,\n    enqueueAdoptedReaction: enqueueAdoptedReaction,\n    enqueueAttributeChangedReaction: enqueueAttributeChangedReaction,\n    executeCEReactions: executeCEReactions,\n    isValidCustomElementName: isValidCustomElementName\n};\n\n// Installation/uninstallation\n\nfunction install() {\n    var installation = {};\n\n    installation.builtInElementInterfaces = installHtmlConstructors();\n    installation.registry = new CustomElementRegistry();\n\n    Object.defineProperty(window, CE_PROP_NAME, {\n        value: installation.registry,\n        writable: false,\n        configurable: true,\n        enumerable: true\n    });\n\n    Document.prototype.createElement = createElement;\n    Document.prototype.createElementNS = createElementNS;\n\n    if (nativeMutationObserver) {\n        (function () {\n            var observer = new nativeMutationObserver(function (records) {\n                for (var i = 0; i < records.length; i++) {\n                    for (var j = 0; j < records[i].addedNodes.length; j++) {\n                        var added = records[i].addedNodes[j];\n                        if (added.nodeType === Node.ELEMENT_NODE) {\n                            tryToUpgradeElementSync(added);\n                        }\n                    }\n                }\n            });\n            observer.observe(window.document, {\n                childList: true,\n                subtree: true\n            });\n            window.document.addEventListener(DOM_CONTENT_LOADED, function () {\n                observer.disconnect();\n            });\n        })();\n    }\n\n    window.document.addEventListener(DOM_CONTENT_LOADED, function () {\n        // Upgrading elements initially present in the document\n        var elements = [];\n        treeOrderShadowInclusiveForEach(document, function (element) {\n            elements.push(element);\n        });\n        elements.forEach(tryToUpgradeElementSync);\n    }, { once: true });\n\n    installation.customElementsReactionStack = [];\n    installation.backupElementQueue = [];\n    installation.processingBackupElementQueue = false;\n\n    setInstallation(window, installation);\n}\n\nfunction uninstall() {\n    var windowState = getPrivateState(window);\n\n    if (!windowState) {\n        return;\n    }\n\n    uninstallHtmlConstructors(windowState.builtInElementInterfaces);\n\n    delete window[CE_PROP_NAME];\n\n    Document.prototype.createElement = nativeCreateElement;\n    Document.prototype.createElementNS = nativeCreateElementNS;\n\n    setPrivateState(window, undefined);\n}\n\nfunction isInstalled() {\n    return getInstallation(window) != null;\n}\n\nfunction gatherBuiltInElementInterfaces() {\n    var builtInElementInterfaces = [];\n    var windowPropertyNames = Object.getOwnPropertyNames(window);\n    for (var i = 0; i < windowPropertyNames.length; i++) {\n        var name = windowPropertyNames[i];\n        if (/^webkit/.test(name)) {\n            // This just avoids a slew of warnings.\n            continue;\n        }\n        var object = window[name];\n        if (object && object instanceof nativeHTMLElement || object === nativeHTMLElement) {\n            builtInElementInterfaces.push({ name: name, object: object, constructor: object.prototype.constructor });\n        }\n    }\n    return builtInElementInterfaces;\n}\n\nfunction installTranspiledClassSupport() {\n    try {\n        // Ensure that we are only shimming browsers that support ES2015 class syntax.\n        new Function('return class {}');\n\n        var _makeHtmlConstructor = new Function('nativeHTMLElement', 'return function(){const newTarget=new.target||this.constructor;' + 'return Reflect.construct(nativeHTMLElement, [], newTarget);}');\n\n        var builtInElementInterfaces = gatherBuiltInElementInterfaces();\n        for (var i = 0; i < builtInElementInterfaces.length; i++) {\n            var _builtInElementInterf = builtInElementInterfaces[i],\n                name = _builtInElementInterf.name,\n                object = _builtInElementInterf.object;\n\n            var htmlConstructor = _makeHtmlConstructor(object);\n            htmlConstructor.prototype = object.prototype;\n            Object.defineProperty(object.prototype, CTOR_PROP_NAME, {\n                value: htmlConstructor,\n                writable: true,\n                configurable: true\n            });\n            window[name] = htmlConstructor;\n        }\n    } catch (error) {\n        return;\n    }\n}\n\nfunction installHtmlConstructors() {\n    var builtInElementInterfaces = gatherBuiltInElementInterfaces();\n    for (var i = 0; i < builtInElementInterfaces.length; i++) {\n        var _builtInElementInterf2 = builtInElementInterfaces[i],\n            name = _builtInElementInterf2.name,\n            object = _builtInElementInterf2.object;\n\n        var htmlConstructor = makeHtmlConstructor();\n        htmlConstructor.prototype = object.prototype;\n        Object.defineProperty(object.prototype, CTOR_PROP_NAME, {\n            value: htmlConstructor,\n            writable: true,\n            configurable: true\n        });\n        window[name] = htmlConstructor;\n    }\n    return builtInElementInterfaces;\n}\n\nfunction uninstallHtmlConstructors(builtInElementInterfaces) {\n    for (var i = 0; i < builtInElementInterfaces.length; i++) {\n        var _builtInElementInterf3 = builtInElementInterfaces[i],\n            name = _builtInElementInterf3.name,\n            object = _builtInElementInterf3.object,\n            _constructor = _builtInElementInterf3.constructor;\n\n        Object.defineProperty(object.prototype, CTOR_PROP_NAME, {\n            value: _constructor,\n            writable: true,\n            configurable: true\n        });\n        window[name] = object;\n    }\n}\n\nfunction makeHtmlConstructor() {\n    return function htmlConstructor() {\n        var thisPrototype = Object.getPrototypeOf(this);\n\n        // 1. Let registry...\n        var registry = window[CE_PROP_NAME];\n        var registryState = getPrivateState(registry);\n\n        // 2. If NewTarget...\n        if (thisPrototype.constructor === htmlConstructor) {\n            throw new TypeError('Illegal constructor');\n        }\n\n        // 3. Let definition...\n        var definition = void 0;\n        for (var i = 0; i < registryState.definitions.length; i++) {\n            var current = registryState.definitions[i];\n            if (current.constructor === thisPrototype.constructor) {\n                definition = current;\n                break;\n            }\n        }\n        if (!definition) {\n            throw new TypeError();\n        }\n\n        // 4. If definition's local name is equal...\n        // 5. Otherwise... (customized built-in)\n        if (htmlConstructor !== definition.htmlConstructor) {\n            // TODO: assert this is the correct HTML___Element\n            throw new TypeError('Illegal constructor');\n        }\n\n        // 6. let prototype...\n        var prototype = thisPrototype;\n\n        // 7. if prototype is not Object...\n        // in this polyfill, this should always be true\n\n        // 8. If construction stack is empty...\n        var constructionStack = definition.constructionStack;\n        if (constructionStack.length === 0) {\n            var _element = nativeCreateElement.call(window.document, definition.localName);\n            _utils2.default.setPrototypeOf(_element, prototype);\n            setPrivateState(_element, {\n                customElementState: CE_STATE_CUSTOM,\n                customElementDefinition: definition\n            });\n            return _element;\n        }\n\n        var lastIndex = constructionStack.length - 1;\n        // 9. Let element be the last entry\n        var element = constructionStack[lastIndex];\n        // 10. if alreadyConstructedMarker\n        if (element === alreadyConstructedMarker) {\n            throw _utils2.default.makeDOMException('InvalidStateError', 'This element instance is already constructed');\n        }\n        // 11. set prototype\n        _utils2.default.setPrototypeOf(element, prototype);\n        // 12. replace last entry\n        constructionStack[lastIndex] = alreadyConstructedMarker;\n        // 13. return element\n        return element;\n    };\n}\n\n// DOM element creation\n\nfunction createAnElement(document, qualifiedOrLocalName, nameSpace, prefix, is, synchronousCustomElements) {\n    is = is || null;\n    var result = null;\n    var definition = lookupCustomElementDefinition(document, nameSpace, qualifiedOrLocalName, is);\n    if (definition && definition.name != definition.localName) {\n        result = nativeCreateElement.call(document, qualifiedOrLocalName);\n        setPrivateState(result, {\n            customElementState: CE_STATE_UNDEFINED,\n            customElementDefinition: null,\n            isValue: is\n        });\n        if (synchronousCustomElements) {\n            upgradeElement(result, definition);\n        } else {\n            enqueueUpgradeReaction(result, definition);\n        }\n    } else if (definition) {\n        if (synchronousCustomElements) {\n            try {\n                result = new definition.constructor();\n                if (!(result instanceof HTMLElement)) {\n                    throw new TypeError('Illegal constructor');\n                }\n                if (result.attributes.length !== 0 || result.hasChildNodes() || result.parentNode || result.ownerDocument !== document || result.namespaceURI !== htmlNamespace || result.localName !== qualifiedOrLocalName) {\n                    var error = new Error('Invalid state manipulation during custom element construction');\n                    error.name = 'NotSupportedError';\n                    throw error;\n                }\n            } catch (error) {\n                _utils2.default.reportError(error);\n                result = nativeCreateElement.call(document, qualifiedOrLocalName);\n                // should be HTMLUnknownElement already\n                setPrivateState(result, {\n                    customElementState: CE_STATE_FAILED\n                });\n            }\n        } else {\n            result = nativeCreateElement.call(document, qualifiedOrLocalName);\n            _utils2.default.setPrototypeOf(result, HTMLElement.prototype);\n            enqueueUpgradeReaction(result, definition);\n        }\n    } else {\n        result = nameSpace ? nativeCreateElementNS.call(document, nameSpace, qualifiedOrLocalName) : nativeCreateElement.call(document, qualifiedOrLocalName);\n        // PERF: forgo setting the custom element state to CE_STATE_UNDEFINED in order\n        // to avoid unnecessary allocation.\n    }\n    return result;\n}\n\nfunction createElement(localName, options) {\n    var nameSpace = null;\n    //if (this instanceof HTMLDocument) {\n    localName = localName.toLowerCase();\n    nameSpace = htmlNamespace;\n    //}\n    var is = options ? options.is || null : null;\n    var element = createAnElement(this, localName, nameSpace, null, is, true);\n    if (is != null) {\n        element.setAttribute(ATTR_IS_NAME, is);\n    }\n    return element;\n}\n\nfunction createElementNS(nameSpace, qualifiedName, options) {\n    var is = options ? options.is || null : null;\n    var element = createAnElement(this, qualifiedName, nameSpace, null, is, true);\n    if (is != null) {\n        element.setAttribute(ATTR_IS_NAME, is);\n    }\n    return element;\n}\n\n// Custom Element spec\n\nfunction isCustom(node) {\n    if (node.nodeType != Node.ELEMENT_NODE) {\n        return false;\n    }\n    var nodeState = getPrivateState(node);\n    if (!nodeState) {\n        return false;\n    }\n    return nodeState.customElementState === CE_STATE_CUSTOM;\n}\n\nfunction isValidCustomElementName(localName) {\n    // https://html.spec.whatwg.org/multipage/scripting.html#valid-custom-element-name\n    switch (localName) {\n        case 'annotation-xml':\n        case 'color-profile':\n        case 'font-face':\n        case 'font-face-src':\n        case 'font-face-uri':\n        case 'font-face-format':\n        case 'font-face-name':\n        case 'missing-glyph':\n            return false;\n    }\n\n    var nameLength = localName.length;\n\n    if (nameLength < 2) {\n        return false;\n    }\n\n    var firstCode = localName.charCodeAt(0);\n    if (firstCode < 0x61 /* a */ || firstCode > 0x7A /* z */) {\n            return false;\n        }\n\n    var foundHyphen = false;\n\n    for (var i = 1; i < nameLength; i++) {\n        var code = localName.charCodeAt(i);\n        if (code >= 0x61 /* a */ && code <= 0x7A /* z */) {\n                continue;\n            }\n        if (code === 0x2D /* - */) {\n                foundHyphen = true;\n                continue;\n            }\n        if (code === 0x2E /* . */ || code === 0x5F /* _ */ || code === 0xB7 /* · */) {\n                continue;\n            }\n        if (code >= 0x30 /* 0 */ && code <= 0x39 /* 9 */) {\n                continue;\n            }\n        if (code < 0x00C0) {\n            return false;\n        }\n        if (code >= 0xC0 && code <= 0xD6) {\n            continue;\n        }\n        if (code >= 0xD8 && code <= 0xF6) {\n            continue;\n        }\n        if (code >= 0xF8 && code <= 0x37D) {\n            continue;\n        }\n        if (code >= 0x37F && code <= 0x1FFF) {\n            continue;\n        }\n        if (code >= 0x200C && code <= 0x200D) {\n            continue;\n        }\n        if (code >= 0x203F && code <= 0x2040) {\n            continue;\n        }\n        if (code >= 0x2070 && code <= 0x218F) {\n            continue;\n        }\n        if (code >= 0x2C00 && code <= 0x2FEF) {\n            continue;\n        }\n        if (code >= 0x3001 && code <= 0xD7FF) {\n            continue;\n        }\n        if (code >= 0xF900 && code <= 0xFDCF) {\n            continue;\n        }\n        if (code >= 0xFDF0 && code <= 0xFFFD) {\n            continue;\n        }\n        if (code >= 0x10000 && code <= 0xEFFFF) {\n            continue;\n        }\n        return false;\n    }\n\n    return foundHyphen;\n}\n\nfunction lookupCustomElementDefinition(document, nameSpace, localName, is) {\n    if (nameSpace !== htmlNamespace) {\n        return null;\n    }\n    if (!document.defaultView) {\n        return null;\n    }\n    var registry = document.defaultView.customElements;\n    var privateState = getPrivateState(registry);\n    for (var i = 0; i < privateState.definitions.length; i++) {\n        var definition = privateState.definitions[i];\n        if (definition.localName === localName) {\n            if (definition.name === localName || definition.name === is) {\n                return definition;\n            }\n        }\n    }\n    return null;\n}\n\nfunction CustomElementRegistry() {\n    setPrivateState(this, {\n        definitions: [],\n        elementDefinitionIsRunning: false,\n        whenDefinedPromiseMap: {}\n    });\n}\n\nCustomElementRegistry.prototype = {\n    define: function define(name, constructor, options) {\n        var privateState = getPrivateState(this);\n        if (constructor !== constructor.prototype.constructor) {\n            throw new TypeError('The passed argument must be a constructor');\n        }\n        if (!isValidCustomElementName(name)) {\n            throw _utils2.default.makeDOMException('SyntaxError');\n        }\n        // TODO: check for already defined name\n        // TODO: check for already defined constructor\n        var localName = name;\n        var extensionOf = options ? options.extends : null;\n        var htmlConstructor = window.HTMLElement;\n        if (extensionOf != null) {\n            if (isValidCustomElementName(extensionOf)) {\n                throw _utils2.default.makeDOMException('NotSupportedError');\n            }\n            var testElement = nativeCreateElement.call(window.document, extensionOf);\n            if (testElement instanceof HTMLUnknownElement) {\n                // TODO: check for HTMLUnknownElement\n            }\n            localName = extensionOf;\n            htmlConstructor = Object.getPrototypeOf(testElement).constructor;\n        }\n        if (privateState.elementDefinitionIsRunning) {\n            throw _utils2.default.makeDOMException('NotSupportedError');\n        }\n        privateState.elementDefinitionIsRunning = true;\n        var caught = null;\n        var observedAttributes = [];\n        var lifecycleCallbacks = void 0;\n        var nativeInterface = void 0;\n        try {\n            var prototype = constructor.prototype;\n            if (!(prototype instanceof Object)) {\n                throw new TypeError('Invalid prototype');\n            }\n            lifecycleCallbacks = {};\n            lifecycleCallbacks[CE_CALLBACK_CONNECTED] = getCallback(prototype, CE_CALLBACK_CONNECTED);\n            lifecycleCallbacks[CE_CALLBACK_DISCONNECTED] = getCallback(prototype, CE_CALLBACK_DISCONNECTED);\n            lifecycleCallbacks[CE_CALLBACK_ADOPTED] = getCallback(prototype, CE_CALLBACK_ADOPTED);\n            lifecycleCallbacks[CE_CALLBACK_ATTRIBUTE_CHANGED] = getCallback(prototype, CE_CALLBACK_ATTRIBUTE_CHANGED);\n            if (lifecycleCallbacks[CE_CALLBACK_ATTRIBUTE_CHANGED]) {\n                var observedAttributesIterable = constructor.observedAttributes;\n                if (observedAttributesIterable) {\n                    observedAttributes = observedAttributesIterable.slice();\n                }\n            }\n        } catch (error) {\n            caught = error;\n        }\n        privateState.elementDefinitionIsRunning = false;\n        if (caught) {\n            throw caught;\n        }\n        var definition = {\n            name: name,\n            localName: localName,\n            constructor: constructor,\n            observedAttributes: observedAttributes,\n            lifecycleCallbacks: lifecycleCallbacks,\n            constructionStack: [],\n            htmlConstructor: htmlConstructor\n        };\n        privateState.definitions.push(definition);\n        var document = window.document;\n        treeOrderShadowInclusiveForEach(document, function (node) {\n            if (node.nodeType === Node.ELEMENT_NODE && node.namespaceURI === htmlNamespace && node.localName === localName) {\n                if (extensionOf) {\n                    var nodeState = getPrivateState(node);\n                    if (nodeState.isValue !== extensionOf) {\n                        return;\n                    }\n                }\n                enqueueUpgradeReaction(element, definition);\n            }\n        });\n        var entry = privateState.whenDefinedPromiseMap[name];\n        if (entry) {\n            _utils2.default.setImmediate(function () {\n                entry.resolve();\n                privateState.whenDefinedPromiseMap[name] = null;\n            });\n        }\n    },\n    get: function get(name) {\n        var privateState = getPrivateState(this);\n        for (var i = 0; i < privateState.definitions.length; i++) {\n            var definition = privateState.definitions[i];\n            if (definition.name === name) {\n                return definition.constructor;\n            }\n        }\n        return undefined;\n    },\n    whenDefined: function whenDefined(name) {\n        if (!promisesSupported) {\n            throw new Error('Please include a promise polyfill.');\n        }\n        if (!isValidCustomElementName(name)) {\n            throw _utils2.default.makeDOMException('SyntaxError', 'Invalid custom element name');\n        }\n        var privateState = getPrivateState(this);\n        for (var i = 0; i < privateState.definitions.length; i++) {\n            var definition = privateState.definitions[i];\n            if (name === definition.name) {\n                return Promise.resolve();\n            }\n        }\n        var entry = privateState.whenDefinedPromiseMap[name];\n        if (!entry) {\n            entry = { promise: null, resolve: null };\n            entry.promise = new Promise(function (resolve, reject) {\n                entry.resolve = resolve;\n            });\n            privateState.whenDefinedPromiseMap[name] = entry;\n        }\n        return entry.promise;\n    }\n};\n\nfunction upgradeElement(element, definition) {\n    // https://html.spec.whatwg.org/multipage/scripting.html#concept-upgrade-an-element\n    var elementState = getPrivateState(element);\n    if (!elementState) {\n        elementState = setPrivateState(element, {\n            reactionQueue: [],\n            customElementDefinition: definition\n        });\n    } else if (shouldNotUpgrade(elementState)) {\n        return;\n    }\n    var attributes = element.attributes;\n    for (var i = 0; i < attributes.length; i++) {\n        var attribute = attributes[i];\n        var args = [attribute.localName, null, attribute.value, attribute.namespaceURI];\n        enqueueCallbackReaction(element, CE_CALLBACK_ATTRIBUTE_CHANGED, args);\n    }\n    if (element.isConnected) {\n        enqueueCallbackReaction(element, CE_CALLBACK_CONNECTED, []);\n    }\n    definition.constructionStack.push(element);\n    var caught = null;\n    try {\n        var constructResult = new definition.constructor();\n        if (constructResult !== element) {\n            throw _utils2.default.makeDOMException('InvalidStateError');\n        }\n    } catch (error) {\n        caught = error;\n        delete element.prototype;\n        elementState.customElementState = CE_STATE_FAILED;\n        elementState.customElementDefinition = null;\n        elementState.reactionQueue.splice(0, elementState.reactionQueue.length);\n    }\n    definition.constructionStack.pop();\n    if (caught) {\n        throw caught;\n    }\n    elementState.customElementState = CE_STATE_CUSTOM;\n}\n\nfunction tryToUpgradeElementSync(element) {\n    var elementState = getPrivateState(element);\n    var isValue = null;\n    if (elementState) {\n        if (shouldNotUpgrade(elementState)) {\n            return;\n        }\n        isValue = elementState.isValue;\n    }\n    var definition = lookupCustomElementDefinition(element.ownerDocument, element.namespaceURI, element.localName, isValue);\n    if (definition) {\n        upgradeElement(element, definition);\n    }\n}\n\nfunction tryToUpgradeElement(element) {\n    var elementState = getPrivateState(element);\n    var isValue = null;\n    if (elementState) {\n        if (shouldNotUpgrade(elementState)) {\n            return;\n        }\n        isValue = elementState.isValue;\n    }\n    var definition = lookupCustomElementDefinition(element.ownerDocument, element.namespaceURI, element.localName, isValue);\n    if (definition) {\n        enqueueUpgradeReaction(element, definition);\n    }\n}\n\nfunction enqueueElementOnAppropriateElementQueue(element) {\n    var installation = getInstallation(window);\n    if (!installation) {\n        return;\n    }\n    // https://html.spec.whatwg.org/multipage/scripting.html#enqueue-an-element-on-the-appropriate-element-queue\n    // 1. If the custom element reactions stack is empty, then:\n    var stack = installation.customElementsReactionStack;\n    if (stack.length === 0) {\n        // 1. Add element to the backup element queue.\n        installation.backupElementQueue.push(element);\n        // 2. If the processing the backup element queue flag is set, abort this algorithm.\n        if (installation.processingBackupElementQueue) {\n            return;\n        }\n        // 3. Set the processing the backup element queue flag.\n        installation.processingBackupElementQueue = true;\n        // 4. Queue a microtask to perform the following steps:\n        _utils2.default.setImmediate(function () {\n            // 1. Invoke custom element reactions in the backup element queue.\n            invokeReactions(installation.backupElementQueue);\n            // 2. Unset the processing the backup element queue flag.\n            installation.processingBackupElementQueue = false;\n        });\n    }\n    // 2. Otherwise, add element to the current element queue.\n    else {\n            stack[stack.length - 1].push(element);\n        }\n}\n\nfunction enqueueCallbackReaction(element, callbackName, args) {\n    // https://html.spec.whatwg.org/multipage/scripting.html#enqueue-a-custom-element-callback-reaction\n    var elementState = getPrivateState(element);\n    var definition = elementState.customElementDefinition;\n    var callback = definition.lifecycleCallbacks[callbackName];\n    if (callback == null) {\n        return;\n    }\n    if (callbackName === CE_CALLBACK_ATTRIBUTE_CHANGED) {\n        var attributeName = args[0];\n        if (definition.observedAttributes.indexOf(attributeName) === -1) {\n            return;\n        }\n    }\n    if (!elementState.reactionQueue) {\n        elementState.reactionQueue = [];\n    }\n    elementState.reactionQueue.push({ type: callbackReactionType, callback: callback, args: args });\n    enqueueElementOnAppropriateElementQueue(element);\n}\n\nfunction enqueueConnectedReaction(element, args) {\n    enqueueCallbackReaction(element, CE_CALLBACK_CONNECTED, args);\n}\n\nfunction enqueueDisconnectedReaction(element, args) {\n    enqueueCallbackReaction(element, CE_CALLBACK_DISCONNECTED, args);\n}\n\nfunction enqueueAdoptedReaction(element, args) {\n    enqueueCallbackReaction(element, CE_CALLBACK_ADOPTED, args);\n}\n\nfunction enqueueAttributeChangedReaction(element, args) {\n    enqueueCallbackReaction(element, CE_CALLBACK_ATTRIBUTE_CHANGED, args);\n}\n\nfunction enqueueUpgradeReaction(element, definition) {\n    // https://html.spec.whatwg.org/multipage/scripting.html#enqueue-a-custom-element-upgrade-reaction\n    var elementState = getPrivateState(element) || setPrivateState(element, { reactionQueue: [] });\n    elementState.customElementDefinition = definition;\n    elementState.reactionQueue.push({ type: upgradeReactionType, definition: definition });\n    enqueueElementOnAppropriateElementQueue(element);\n}\n\nfunction invokeReactions(queue) {\n    // https://html.spec.whatwg.org/multipage/scripting.html#invoke-custom-element-reactions\n    for (var i = 0; i < queue.length; i++) {\n        var _element2 = queue[i];\n        var reactions = getPrivateState(_element2).reactionQueue;\n        while (reactions.length) {\n            try {\n                var splicedOut = reactions.splice(0, 1);\n                var reaction = splicedOut[0];\n                switch (reaction.type) {\n                    case upgradeReactionType:\n                        upgradeElement(_element2, reaction.definition);\n                        break;\n                    case callbackReactionType:\n                        reaction.callback.apply(_element2, reaction.args);\n                        break;\n                }\n            } catch (error) {\n                _utils2.default.reportError(error);\n            }\n        }\n    }\n}\n\nfunction executeCEReactions(callback) {\n    var installation = getInstallation(window);\n    if (installation) {\n        var stack = installation.customElementsReactionStack;\n        stack.push([]);\n        var result = callback();\n        invokeReactions(stack.pop());\n        return result;\n    }\n    return callback();\n}\n\n// Utility functions\n\nfunction shouldNotUpgrade(privateState) {\n    return privateState && (privateState.customElementState === CE_STATE_CUSTOM || privateState.customElementState === CE_STATE_FAILED);\n}\n\nfunction getCallback(prototype, callbackName) {\n    var callback = prototype[callbackName];\n    if (callback && typeof callback === 'function') {\n        return callback;\n    }\n    return null;\n}\n\nfunction getPrivateState(object) {\n    return object._custom;\n}\n\nfunction setPrivateState(object, state) {\n    return object._custom = state;\n}\n\nfunction getInstallation(window) {\n    return window._custom;\n}\n\nfunction setInstallation(window, installation) {\n    window._custom = installation;\n}\n\nfunction treeOrderShadowInclusiveForEach(node, callback) {\n    callback(node);\n    var shadowRoot = node.shadowRoot;\n    if (shadowRoot) {\n        treeOrderShadowInclusiveForEach(shadowRoot, callback);\n    }\n    var childNodes = node.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n        treeOrderShadowInclusiveForEach(childNodes[i], callback);\n    }\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = require('./utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _customElements = require('./custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n    treeOrderRecursiveSelectAll: treeOrderRecursiveSelectAll,\n    treeOrderRecursiveSelectFirst: treeOrderRecursiveSelectFirst,\n    filterByRoot: filterByRoot,\n    isShadowRoot: isShadowRoot,\n    parseHTMLFragment: parseHTMLFragment,\n    serializeHTMLFragment: serializeHTMLFragment,\n    root: root,\n    convertNodesIntoANode: convertNodesIntoANode,\n    clone: clone,\n    adopt: adopt,\n    shadowIncludingRoot: shadowIncludingRoot,\n    shadowIncludingInclusiveAncestor: shadowIncludingInclusiveAncestor,\n    closedShadowHidden: closedShadowHidden,\n    retarget: retarget,\n    changeAttribute: changeAttribute,\n    appendAttribute: appendAttribute,\n    removeAttribute: removeAttribute,\n    setAttribute: setAttribute,\n    setAttributeValue: setAttributeValue,\n    removeAttributeByName: removeAttributeByName,\n    removeAttributeByNamespace: removeAttributeByNamespace,\n    insertAdjacent: insertAdjacent,\n    setExistingAttributeValue: setExistingAttributeValue,\n    replaceData: replaceData,\n    findFlattenedSlotables: findFlattenedSlotables,\n    preInsert: preInsert,\n    insert: insert,\n    append: append,\n    replace: replace,\n    replaceAll: replaceAll,\n    preRemove: preRemove,\n    remove: remove,\n    createMutationObserver: createMutationObserver\n};\n\n\nvar attrValueDescriptor = _utils2.default.descriptor(Attr, 'value');\nvar characterDataDataDescriptor = _utils2.default.descriptor(CharacterData, 'data');\nvar elementAttributesDescriptor = _utils2.default.descriptor(Element, 'attributes') || _utils2.default.descriptor(Node, 'attributes');\nvar elementInnerHTMLDescriptor = _utils2.default.descriptor(Element, 'innerHTML') || _utils2.default.descriptor(HTMLElement, 'innerHTML');\nvar elementRemoveAttributeNSDescriptor = _utils2.default.descriptor(Element, 'removeAttributeNS');\nvar elementSetAttributeDescriptor = _utils2.default.descriptor(Element, 'setAttribute');\nvar namedNodeMapSetNamedItemNSDescriptor = _utils2.default.descriptor(NamedNodeMap, 'setNamedItemNS');\nvar nodeAppendChildDescriptor = _utils2.default.descriptor(Node, 'appendChild');\nvar nodeChildNodesDescriptor = _utils2.default.descriptor(Node, 'childNodes');\nvar nodeCloneNodeDescriptor = _utils2.default.descriptor(Node, 'cloneNode');\nvar nodeFirstChildDescriptor = _utils2.default.descriptor(Node, 'firstChild');\nvar nodeInsertBeforeDescriptor = _utils2.default.descriptor(Node, 'insertBefore');\nvar nodeParentNodeDescriptor = _utils2.default.descriptor(Node, 'parentNode');\nvar nodeRemoveChildDescriptor = _utils2.default.descriptor(Node, 'removeChild');\n\nvar ATTR_NAME = 'name';\nvar EMPTY_STRING = '';\nvar ERROR_IN_USE_ATTRIBUTE = 'InUseAttributeError';\nvar ERROR_HIERARCHY_REQUEST = 'HierarchyRequestError';\nvar ERROR_INDEX_SIZE = 'IndexSizeError';\nvar ERROR_NOT_FOUND = 'NotFoundError';\nvar ERROR_SYNTAX = 'SyntaxError';\nvar EVENT = 'event';\nvar EVT_SLOT_CHANGE = 'slotchange';\nvar MO_TYPE_ATTRIBUTES = 'attributes';\nvar MO_TYPE_CHILD_LIST = 'childList';\nvar MO_TYPE_CHARACTER_DATA = 'characterData';\nvar NS_HTML = 'http://www.w3.org/1999/xhtml';\nvar NS_MATHML = 'http://www.w3.org/1998/Math/MathML';\nvar NS_SVG = 'http://www.w3.org/2000/svg';\nvar NS_XML = 'http://www.w3.org/XML/1998/namespace';\nvar NS_XMLNS = 'http://www.w3.org/2000/xmlns/';\nvar NS_XLINK = 'http://www.w3.org/1999/xlink';\nvar PROP_ASSIGNED_SLOT = 'assignedSlot';\nvar SHADOW_MODE_OPEN = 'open';\nvar SHADOW_MODE_CLOSED = 'closed';\nvar SHADOW_NODE_NAME = '#shadow-root';\nvar TAG_SLOT = 'slot';\n\nfunction forEachShadowIncludingDescendant(node, action) {\n    var shadowState = null;\n    var shadowRoot = null;\n    if ((shadowState = _utils2.default.getShadowState(node)) && (shadowRoot = shadowState.shadowRoot)) {\n        action(shadowRoot);\n        forEachShadowIncludingInclusiveDescendant(shadowRoot, action);\n    }\n    var childNodes = node.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n        var childNode = childNodes[i];\n        action(childNode);\n        forEachShadowIncludingInclusiveDescendant(childNode, action);\n    }\n}\n\nfunction forEachShadowIncludingInclusiveDescendant(node, action) {\n    action(node);\n    var shadowState = null;\n    var shadowRoot = null;\n    if ((shadowState = _utils2.default.getShadowState(node)) && (shadowRoot = shadowState.shadowRoot)) {\n        forEachShadowIncludingInclusiveDescendant(shadowRoot, action);\n    }\n    var childNodes = node.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n        forEachShadowIncludingInclusiveDescendant(childNodes[i], action);\n    }\n}\n\nfunction treeOrderRecursiveSelectAll(node, results, match) {\n    if (match(node)) {\n        results[results.length] = node;\n    }\n    var firstChild = node.firstChild;\n    if (firstChild) {\n        treeOrderRecursiveSelectAll(firstChild, results, match);\n    }\n    var nextSibling = node.nextSibling;\n    if (nextSibling) {\n        treeOrderRecursiveSelectAll(nextSibling, results, match);\n    }\n}\n\nfunction treeOrderRecursiveSelectFirst(node, match) {\n    if (match(node)) {\n        return node;\n    }\n    var firstChild = node.firstChild;\n    if (firstChild) {\n        var result = treeOrderRecursiveSelectFirst(firstChild, match);\n        if (result) {\n            return result;\n        }\n    }\n    var nextSibling = node.nextSibling;\n    if (nextSibling) {\n        return treeOrderRecursiveSelectFirst(nextSibling, match);\n    }\n    return null;\n}\n\nfunction filterByRoot(node, descendants) {\n    var contextRoot = root(node);\n    var filtered = new Array(descendants.length);\n    var filteredCount = 0;\n    for (var i = 0; i < descendants.length; i++) {\n        var item = descendants[i];\n        if (root(item) === contextRoot) {\n            filtered[filteredCount++] = item;\n        }\n    }\n    filtered.length = filteredCount;\n    return filtered;\n}\n\nfunction isShadowRoot(node) {\n    return node.nodeName === SHADOW_NODE_NAME;\n}\n\n// https://www.w3.org/TR/DOM-Parsing/\n\n// PERF: This function uses a recycled div element\n// and a recycled document fragment stored in the passed \n// element's owner document so it can avoid allocation.\n// Callers must empty the returned fragment.\nfunction parseHTMLFragment(markup, context) {\n    var document = context.ownerDocument;\n    var documentState = _utils2.default.getShadowState(document) || _utils2.default.setShadowState(document, {});\n    var parsingElement = documentState.parsingElement;\n    if (!parsingElement) {\n        parsingElement = documentState.parsingElement = document.createElement('div');\n    }\n    var parsingFragment = documentState.parsingFragment;\n    if (!documentState.parsingFragment) {\n        parsingFragment = documentState.parsingFragment = document.createDocumentFragment();\n    }\n    elementInnerHTMLDescriptor.set.call(parsingElement, markup);\n    var firstChild = void 0;\n    while (firstChild = nodeFirstChildDescriptor.get.call(parsingElement)) {\n        nodeAppendChildDescriptor.value.call(parsingFragment, firstChild);\n    }\n    return parsingFragment;\n}\n\nfunction serializeHTMLFragment(node) {\n    // https://www.w3.org/TR/html5/single-page.html#html-fragment-serialization-algorithm\n\n    // 1. Let s be a string, and initialize it to the empty string.\n    var s = EMPTY_STRING;\n\n    // 2. If the node is a template element, then let the node instead be the \n    // template element's template contents (a DocumentFragment node).\n    if (node.localName === 'template') {\n        var content = node.content;\n        if (content) {\n            node = content;\n        }\n    }\n\n    // 3. For each child node of the node, in tree order, run the following steps:\n    var childNodes = node.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n        // 1. Let current node be the child node being processed.\n        var currentNode = childNodes[i];\n        // 2. Append the appropriate string from the following list to s:\n        switch (currentNode.nodeType) {\n            case Node.ELEMENT_NODE:\n                var tagName = void 0;\n                switch (currentNode.namespaceURI) {\n                    case NS_HTML:\n                    case NS_MATHML:\n                    case NS_SVG:\n                        tagName = currentNode.localName;\n                        break;\n                    default:\n                        tagName = currentNode.qualifiedName;\n                        break;\n                }\n                s += '<' + tagName;\n                var attributes = elementAttributesDescriptor.get.call(currentNode);\n                for (var j = 0; j < attributes.length; j++) {\n                    var attribute = attributes[j];\n                    s += ' ' + serializeAttributeName(attribute);\n                    s += '=\"' + escapeString(attribute.value) + '\"';\n                }\n                s += '>';\n                switch (currentNode.localName) {\n                    case 'area':case 'base':case 'basefont':case 'bgsound':\n                    case 'br':case 'col':case 'embed':case 'frame':case 'hr':\n                    case 'img':case 'input':case 'keygen':case 'link':case 'meta':\n                    case 'param':case 'source':case 'track':case 'wbr':\n                        continue;\n                    case 'pre':case 'textarea':case 'listing':\n                        var firstChild = currentNode.firstChild;\n                        if (firstChild && firstChild.nodeType === Node.TEXT_NODE && firstChild.data[0] === '\\n') {\n                            s += '\\n';\n                        }\n                        break;\n                }\n                s += serializeHTMLFragment(currentNode);\n                s += '</' + tagName + '>';\n                break;\n            case Node.TEXT_NODE:\n                switch (currentNode.parentNode.localName) {\n                    case 'style':case 'script':case 'xmp':case 'iframe':\n                    case 'noembed':case 'noframes':case 'plaintext':case 'noscript':\n                        s += currentNode.data;\n                        break;\n                    default:\n                        s += escapeString(currentNode.data);\n                        break;\n                }\n                break;\n            case Node.COMMENT_NODE:\n                s += '<!--' + currentNode.data + '-->';\n                break;\n            case Node.PROCESSING_INSTRUCTION_NODE:\n                s += '<?' + currentNode.target + ' ' + currentNode.data + '>';\n                break;\n            case Node.DOCUMENT_TYPE_NODE:\n                s += '<!DOCTYPE ' + currentNode.name + '>';\n                break;\n        }\n    }\n\n    // 4. The result of the algorithm is the string s.\n    return s;\n\n    function escapeString(string, attributeMode) {\n        if (!string || !string.length) {\n            return EMPTY_STRING;\n        }\n\n        string = string.replace('&', '&amp;');\n        string = string.replace('\\xA0', '&nbsp;');\n\n        if (attributeMode) {\n            string = string.replace('\"', '&quot;');\n        } else {\n            string = string.replace('<', '&lt;');\n            string = string.replace('>', '&gt;');\n        }\n\n        return string;\n    }\n\n    function serializeAttributeName(attribute) {\n        var namespaceURI = attribute.namespaceURI;\n        var localName = attribute.localName;\n        if (!namespaceURI) {\n            return localName;\n        }\n        switch (namespaceURI) {\n            case NS_XML:\n                return 'xml:' + localName;\n            case NS_XMLNS:\n                if (localName === 'xmlns') {\n                    return localName;\n                }\n                return 'xmlns:' + localName;\n            case NS_XLINK:\n                return 'xlink:' + localName;\n            default:\n                return attribute.name;\n        }\n    }\n}\n\n// https://dom.spec.whatwg.org/#trees\n\nfunction root(node) {\n    var root = node;\n    var parent = root.parentNode;\n\n    while (parent != null) {\n        root = parent;\n        parent = root.parentNode;\n    }\n\n    return root;\n}\n\nfunction descendant(nodeA, nodeB) {\n    var parent = nodeA.parentNode;\n\n    while (parent != null) {\n        if (nodeB === parent) {\n            return true;\n        }\n        parent = parent.parentNode;\n    }\n\n    return false;\n}\n\nfunction inclusiveDescendant(nodeA, nodeB) {\n    return nodeA === nodeB || descendant(nodeA, nodeB);\n}\n\nfunction ancestor(nodeA, nodeB) {\n    var parent = nodeB.parentNode;\n\n    while (parent != null) {\n        if (nodeA === parent) {\n            return true;\n        }\n        parent = parent.parentNode;\n    }\n\n    return false;\n}\n\nfunction inclusiveAncestor(nodeA, nodeB) {\n    return nodeA === nodeB || ancestor(nodeA, nodeB);\n}\n\n// https://dom.spec.whatwg.org/#interface-parentnode\n\nfunction convertNodesIntoANode(nodes, document) {\n    var node = null;\n\n    for (var i = 0; i < nodes.length; i++) {\n        var item = nodes[i];\n\n        if (typeof item === \"string\") {\n            nodes[i] = document.createTextNode(item);\n        }\n    }\n\n    if (nodes.length === 1) {\n        node = nodes[0];\n    } else {\n        node = document.createDocumentFragment();\n\n        for (var _i = 0; _i < nodes.length; _i++) {\n            node.appendChild(nodes[_i]);\n        }\n    }\n\n    return node;\n}\n\n// https://dom.spec.whatwg.org/#interface-node\n\nfunction clone(node, document, cloneChildren) {\n    // https://dom.spec.whatwg.org/#concept-node-clone\n    // To clone a node, with an optional document and clone children flag, run these steps:\n\n    // 1. If document is not given, let document be node’s node document.\n    document = document || node.ownerDocument;\n\n    // Use a shortcut here\n    // 2. If node is an element, then:\n    // 3. Otherwise, let copy be a node that implements the same interfaces \n    // as node, and fulfills these additional requirements, switching on node:\n    // 4. Set copy’s node document and document to copy, if copy is a document, \n    // and set copy’s node document to document otherwise.\n    // 5. Run any cloning steps defined for node in other applicable \n    // specifications and pass copy, node, document and the clone children \n    // flag if set, as parameters.\n    var copy = nodeCloneNodeDescriptor.value.call(node, false);\n    if (_customElements2.default.isInstalled()) {\n        _customElements2.default.tryToUpgradeElement(copy);\n    }\n\n    // 6. If the clone children flag is set, clone all the children of node \n    // and append them to copy, with document as specified and the clone \n    // children flag being set.\n    if (cloneChildren === true) {\n        var childNodes = node.childNodes;\n        for (var i = 0; i < childNodes.length; i++) {\n            append(childNodes[i].cloneNode(true), copy);\n        }\n    }\n\n    return copy;\n}\n\nfunction adopt(node, document) {\n    // https://dom.spec.whatwg.org/#concept-node-adopt\n\n    // 1. Let oldDocument be node’s node document.\n    var oldDocument = node.ownerDocument;\n\n    // 2. If node’s parent is not null, remove node from its parent.\n    var parent = node.parentNode;\n    if (parent != null) {\n        remove(node, parent);\n    }\n\n    // 3. If document is not the same as oldDocument, run these substeps:\n    if (document != oldDocument && _customElements2.default.isInstalled()) {\n        forEachShadowIncludingInclusiveDescendant(node, function (inclusiveDescendant) {\n            if (_customElements2.default.isCustom(inclusiveDescendant)) {\n                _customElements2.default.enqueueAdoptedReaction(inclusiveDescendant, [oldDocument, document]);\n            }\n        });\n    }\n}\n\n// https://dom.spec.whatwg.org/#interface-documentfragment\n\nfunction hostIncludingInclusiveAncestor(nodeA, nodeB) {\n    if (inclusiveAncestor(nodeA, nodeB)) {\n        return true;\n    }\n\n    var host = root(nodeB).host;\n\n    if (host && hostIncludingInclusiveAncestor(nodeA, host)) {\n        return true;\n    }\n\n    return false;\n}\n\n// https://dom.spec.whatwg.org/#interface-shadowroot\n\nfunction shadowIncludingRoot(node) {\n    var rootNode = root(node);\n    if (isShadowRoot(rootNode)) {\n        rootNode = shadowIncludingRoot(rootNode.host);\n    }\n    return rootNode;\n}\n\nfunction shadowIncludingDescendant(nodeA, nodeB) {\n    do {\n        if (isShadowRoot(nodeA)) {\n            nodeA = nodeA.host;\n        } else {\n            nodeA = nodeA.parentNode;\n        }\n        if (nodeA === nodeB) {\n            return true;\n        }\n    } while (nodeA != null);\n\n    return false;\n}\n\nfunction shadowIncludingInclusiveDescendant(nodeA, nodeB) {\n    return nodeA === nodeB || shadowIncludingDescendant(nodeA, nodeB);\n}\n\nfunction shadowIncludingAncestor(nodeA, nodeB) {\n    return shadowIncludingDescendant(nodeB, nodeA);\n}\n\nfunction shadowIncludingInclusiveAncestor(nodeA, nodeB) {\n    return nodeA === nodeB || shadowIncludingAncestor(nodeA, nodeB);\n}\n\nfunction closedShadowHidden(nodeA, nodeB) {\n    // https://dom.spec.whatwg.org/#concept-closed-shadow-hidden\n    var rootNode = root(nodeA);\n\n    if (!isShadowRoot(rootNode)) {\n        return false;\n    }\n\n    if (shadowIncludingInclusiveAncestor(rootNode, nodeB)) {\n        return false;\n    }\n\n    if (rootNode.mode === SHADOW_MODE_CLOSED || closedShadowHidden(rootNode.host, nodeB)) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction retarget(nodeA, nodeB) {\n    // https://dom.spec.whatwg.org/#retarget\n    // To retarget an object A against an object B, repeat these steps \n    // until they return an object:\n\n    var rootNode = void 0;\n    while (rootNode = root(nodeA)) {\n        // 1. If A’s root is not a shadow root, or A’s root is a shadow-including \n        // inclusive ancestor of B, then return A.\n        if (!isShadowRoot(rootNode) || shadowIncludingInclusiveAncestor(rootNode, nodeB)) {\n            return nodeA;\n        }\n        // 2. Set A to A’s root’s host.\n        nodeA = rootNode.host;\n    }\n}\n\n// https://dom.spec.whatwg.org/#interface-element\n\nfunction updateSlotName(element, localName, oldValue, value, nameSpace) {\n    // https://dom.spec.whatwg.org/#slot-name\n    if (element.localName === TAG_SLOT) {\n        if (localName === ATTR_NAME && nameSpace == null) {\n            if (value === oldValue) {\n                return;\n            }\n            if (value == null && oldValue === EMPTY_STRING) {\n                return;\n            }\n            if (value === EMPTY_STRING && oldValue == null) {\n                return;\n            }\n            if (value == null || value === EMPTY_STRING) {\n                elementSetAttributeDescriptor.value.call(element, ATTR_NAME, EMPTY_STRING);\n            } else {\n                elementSetAttributeDescriptor.value.call(element, ATTR_NAME, value);\n            }\n            assignSlotablesForATree(element);\n        }\n    }\n}\n\nfunction updateSlotableName(element, localName, oldValue, value, nameSpace) {\n    // https://dom.spec.whatwg.org/#slotable-name\n    if (localName === TAG_SLOT && nameSpace == null) {\n        if (value === oldValue) {\n            return;\n        }\n        if (value == null && oldValue === EMPTY_STRING) {\n            return;\n        }\n        if (value === EMPTY_STRING && oldValue == null) {\n            return;\n        }\n        if (value == null || value === EMPTY_STRING) {\n            elementSetAttributeDescriptor.value.call(element, TAG_SLOT, EMPTY_STRING);\n        } else {\n            elementSetAttributeDescriptor.value.call(element, TAG_SLOT, value);\n        }\n        var elementState = _utils2.default.getShadowState(element);\n        if (elementState && elementState.assignedSlot) {\n            assignSlotables(elementState.assignedSlot);\n        }\n        assignASlot(element);\n    }\n}\n\nfunction attributeChangeSteps(element, localName, oldValue, value, nameSpace) {\n    updateSlotName(element, localName, oldValue, value, nameSpace);\n    updateSlotableName(element, localName, oldValue, value, nameSpace);\n}\n\nfunction changeAttribute(attribute, element, value) {\n    // https://dom.spec.whatwg.org/#concept-element-attributes-change\n\n    var name = attribute.localName;\n    var nameSpace = attribute.namespaceURI;\n    var oldValue = attrValueDescriptor.get.call(attribute);\n    var newValue = value;\n\n    // 1. Queue a mutation record...\n    queueMutationRecord(MO_TYPE_ATTRIBUTES, element, name, nameSpace, oldValue);\n\n    // 2. If element is custom...\n    if (_customElements2.default.isInstalled() && _customElements2.default.isCustom(element)) {\n        var args = [name, oldValue, newValue, nameSpace];\n        _customElements2.default.enqueueAttributeChangedReaction(element, args);\n    }\n\n    // 3. Run the attribute change steps...\n    attributeChangeSteps(element, name, oldValue, newValue, nameSpace);\n\n    // 4. Set attribute's value...\n    attrValueDescriptor.set.call(attribute, newValue);\n}\n\nfunction appendAttribute(attribute, element) {\n    // https://dom.spec.whatwg.org/#concept-element-attributes-append\n\n    var name = attribute.localName;\n    var nameSpace = attribute.namespaceURI;\n    var oldValue = null;\n    var newValue = attrValueDescriptor.get.call(attribute);\n\n    // 1. Queue a mutation record...\n    queueMutationRecord(MO_TYPE_ATTRIBUTES, element, name, nameSpace, oldValue);\n\n    // 2. If element is custom...\n    if (_customElements2.default.isInstalled() && _customElements2.default.isCustom(element)) {\n        var args = [name, oldValue, newValue, nameSpace];\n        _customElements2.default.enqueueAttributeChangedReaction(element, args);\n    }\n\n    // 3. Run the attribute change steps...\n    attributeChangeSteps(element, name, oldValue, newValue, nameSpace);\n\n    // 4. Append the attribute to the element’s attribute list.\n    // SKIP: handled by caller\n\n    // 5. Set attribute’s element to element.\n    // SKIP: native\n}\n\nfunction removeAttribute(attribute, element) {\n    // https://dom.spec.whatwg.org/#concept-element-attributes-remove\n\n    var name = attribute.localName;\n    var nameSpace = attribute.namespaceURI;\n    var oldValue = attrValueDescriptor.get.call(attribute);\n    var newValue = null;\n\n    // 1. Queue a mutation record...\n    queueMutationRecord(MO_TYPE_ATTRIBUTES, element, name, nameSpace, oldValue);\n\n    // 2. If element is custom...\n    if (_customElements2.default.isInstalled() && _customElements2.default.isCustom(element)) {\n        var args = [name, oldValue, newValue, nameSpace];\n        _customElements2.default.enqueueAttributeChangedReaction(element, args);\n    }\n\n    // 3. Run the attribute change steps...\n    attributeChangeSteps(element, name, oldValue, null, nameSpace);\n\n    // 4. Remove attribute from the element’s attribute list.\n    elementRemoveAttributeNSDescriptor.value.call(nameSpace, name);\n\n    // 5. Set attribute’s element to null.\n    // SKIP: native\n}\n\nfunction replaceAttribute(oldAttr, newAttr, element) {\n    // Used by 'set an attribute'\n    // https://dom.spec.whatwg.org/#concept-element-attributes-replace\n\n    var name = oldAttr.localName;\n    var nameSpace = oldAttr.namespaceURI;\n    var oldValue = attrValueDescriptor.get.call(oldAttr);\n    var newValue = attrValueDescriptor.get.call(newAttr);\n\n    // 1. Queue a mutation record...\n    queueMutationRecord(MO_TYPE_ATTRIBUTES, element, name, nameSpace, oldValue);\n\n    // 2. If element is custom...\n    if (_customElements2.default.isInstalled() && _customElements2.default.isCustom(element)) {\n        var args = [name, oldValue, newValue, nameSpace];\n        _customElements2.default.enqueueAttributeChangedReaction(element, args);\n    }\n\n    // 3. Run the attribute change steps...\n    attributeChangeSteps(element, name, oldValue, newValue, nameSpace);\n\n    // 4. Replace oldAttr by newAttr in the element’s attribute list.\n    // This is handled by callers\n\n    // 5. Set oldAttr’s element to null.\n    // SKIP: native\n\n    // 6. Set newAttr’s element to element.\n    // SKIP: native\n}\n\nfunction setAttribute(attr, element, nativeSetAttributeNodeDescriptor) {\n    if (attr.ownerElement != null && attr.ownerElement !== element) {\n        throw _utils2.default.makeDOMException(ERROR_IN_USE_ATTRIBUTE);\n    }\n    var attributes = elementAttributesDescriptor.get.call(element);\n    var oldAttr = attributes.getNamedItemNS(attr.namespaceURI, attr.localName);\n    if (oldAttr === attr) {\n        return attr;\n    }\n    namedNodeMapSetNamedItemNSDescriptor.value.call(attributes, attr);\n    if (oldAttr) {\n        replaceAttribute(oldAttr, attr, element);\n    } else {\n        appendAttribute(attr, element);\n    }\n    return oldAttr;\n}\n\nfunction setAttributeValue(element, localName, value, prefix, ns) {\n    prefix = prefix || null;\n    ns = ns || null;\n    var attributes = elementAttributesDescriptor.get.call(element);\n    var attribute = attributes.getNamedItemNS(ns, localName);\n    if (!attribute) {\n        elementSetAttributeDescriptor.value.call(element, localName, value);\n        attribute = attributes.getNamedItemNS(ns, localName);\n        appendAttribute(attribute, element);\n        return;\n    }\n    changeAttribute(attribute, element, value);\n}\n\nfunction removeAttributeByName(qualifiedName, element) {\n    var attributes = elementAttributesDescriptor.get.call(element);\n    var attr = attributes.getNamedItem(qualifiedName);\n    if (attr) {\n        removeAttribute(attr, element);\n    }\n    return attr;\n}\n\nfunction removeAttributeByNamespace(nameSpace, localName, element) {\n    var attributes = elementAttributesDescriptor.get.call(element);\n    var attr = attributes.getNamedItemNS(nameSpace, localName);\n    if (attr) {\n        removeAttribute(attr, element);\n    }\n    return attr;\n}\n\nfunction insertAdjacent(element, where, node) {\n    if (!(node instanceof Node)) {\n        throw new TypeError();\n    }\n    var parent = void 0;\n    // https://dom.spec.whatwg.org/#insert-adjacent\n    switch ((where || EMPTY_STRING).toLowerCase()) {\n        case 'beforebegin':\n            if (parent = element.parentNode) {\n                return preInsert(node, parent, element);\n            }\n            return null;\n        case 'afterbegin':\n            return preInsert(node, element, element.firstChild);\n        case 'beforeend':\n            return preInsert(node, element, null);\n        case 'afterend':\n            if (parent = element.parentNode) {\n                return preInsert(node, parent, element.nextSibling);\n            }\n            return null;\n        default:\n            throw _utils2.default.makeDOMException(ERROR_SYNTAX);\n    }\n}\n\n// https://dom.spec.whatwg.org/#attr\n\nfunction setExistingAttributeValue(attribute, value) {\n    if (attribute.ownerElement == null) {\n        attrValueDescriptor.set.call(attribute, value);\n    } else {\n        changeAttribute(attribute, attribute.ownerElement, value);\n    }\n}\n\n// https://dom.spec.whatwg.org/#interface-characterdata\n\nfunction replaceData(node, offset, count, data) {\n    // https://dom.spec.whatwg.org/#concept-cd-replace\n    if (data == null) {\n        data = EMPTY_STRING;\n    }\n    var oldValue = characterDataDataDescriptor.get.call(node);\n    var length = oldValue.length;\n    if (offset > length) {\n        throw _utils2.default.makeDOMException(ERROR_INDEX_SIZE);\n    }\n    if (offset + count > length) {\n        count = length - offset;\n    }\n    queueMutationRecord(MO_TYPE_CHARACTER_DATA, node, null, null, oldValue);\n    var newValue = oldValue.slice(0, offset) + data + oldValue.slice(offset + count);\n    characterDataDataDescriptor.set.call(node, newValue);\n    // TODO: (Range)\n}\n\n// https://dom.spec.whatwg.org/#finding-slots-and-slotables\n\nfunction findASlot(slotable, open) {\n    // https://dom.spec.whatwg.org/#find-a-slot\n    // To find a slot for a given slotable slotable and an optional \n    // open flag (unset unless stated otherwise), run these steps:\n\n    // 1. If slotable’s parent is null, then return null.\n    var parent = slotable.parentNode;\n    if (!parent) {\n        return null;\n    }\n\n    // 2. Let shadow be slotable’s parent’s shadow root.\n    var parentState = _utils2.default.getShadowState(parent);\n\n    // 3. If shadow is null, then return null.\n    if (!parentState || !parentState.shadowRoot) {\n        return null;\n    }\n\n    // 4. If the open flag is set and shadow’s mode is not \"open\", then return null.\n    if (open === true && parentState.shadowRoot.mode !== SHADOW_MODE_OPEN) {\n        return null;\n    }\n\n    // 5. Return the first slot in shadow’s tree whose name is slotable’s name, if any, and null otherwise.\n    if (!parentState.shadowRoot.firstChild) {\n        return null;\n    }\n\n    var name = slotable instanceof Element ? slotable.slot : EMPTY_STRING;\n\n    return treeOrderRecursiveSelectFirst(parentState.shadowRoot.firstChild, function (node) {\n        return node.localName === TAG_SLOT && node.name === name;\n    });\n}\n\nfunction findSlotables(slot) {\n    // https://dom.spec.whatwg.org/#find-slotables\n    // To find slotables for a given slot slot, run these steps:\n\n    // 1. Let result be an empty list.\n    // PERF: allocations later on in algorithm\n    var result = void 0;\n\n    // 2. If slot’s root is not a shadow root, then return result.\n    var slotRoot = root(slot);\n    if (!isShadowRoot(slotRoot)) {\n        // PERF: 'an empty list' from step 1\n        return [];\n    }\n\n    // 3. Let host be slot’s root’s host.\n    var host = slotRoot.host;\n\n    // 4. For each slotable child of host, slotable, in tree order, run these substeps:\n    var slotableChildren = host.childNodes;\n    // PERF: allocation of result\n    result = new Array(slotableChildren.length);\n    var pushed = 0;\n    for (var i = 0; i < slotableChildren.length; i++) {\n        var slotable = slotableChildren[i];\n        if (slotable.nodeType === Node.ELEMENT_NODE || slotable.nodeType === Node.TEXT_NODE) {\n            // 1. Let foundSlot be the result of finding a slot given slotable.\n            var foundSlot = findASlot(slotable);\n            // 2. If foundSlot is slot, then append slotable to result.\n            if (foundSlot === slot) {\n                result[pushed++] = slotable;\n            }\n        }\n    }\n    // PERF: set the actual length\n    result.length = pushed;\n\n    // 5. Return result.\n    return result;\n}\n\nfunction findFlattenedSlotables(slot) {\n    // https://dom.spec.whatwg.org/#find-flattened-slotables\n    // To find flattened slotables for a given slot slot, run these steps:\n\n    // 1. Let result be an empty list.\n    var result = [];\n\n    // 2. Let slotables be the result of finding slotables given slot.\n    var slotables = findSlotables(slot);\n\n    // 3. If slotables is the empty list, then append each slotable child of slot, in tree order, to slotables.\n    if (slotables.length === 0) {\n        var slotableChildren = slot.childNodes;\n        var slotableChildrenLength = slotableChildren.length;\n        slotables.length = slotableChildrenLength;\n        var slotablesPushed = 0;\n        for (var i = 0; i < slotableChildrenLength; i++) {\n            var slotableChild = slotableChildren[i];\n            if (slotableChild.nodeType === Node.ELEMENT_NODE || slotableChild.nodeType === Node.TEXT_NODE) {\n                slotables[slotablesPushed++] = slotableChild;\n            }\n        }\n        slotables.length = slotablesPushed;\n    }\n\n    // 4. For each node in slotables, run these substeps:\n    for (var _i2 = 0; _i2 < slotables.length; _i2++) {\n        var node = slotables[_i2];\n        // 1. If node is a slot, run these subsubsteps:\n        if (node.localName === TAG_SLOT) {\n            var temporaryResult = findFlattenedSlotables(node);\n            var resultLength = resultLength;\n            result.length += temporaryResult.length;\n            for (var j = 0; j < temporaryResult.length; j++) {\n                result[resultLength + j] = temporaryResult[k];\n            }\n        } else {\n            result[result.length] = node;\n        }\n    }\n\n    // 5. Return result.\n    return result;\n}\n\n// https://dom.spec.whatwg.org/#assigning-slotables-and-slots\n\nfunction assignSlotables(slot, suppressSignaling) {\n    // https://dom.spec.whatwg.org/#assign-slotables\n    // To assign slotables, for a slot slot with an optional suppress \n    // signaling flag (unset unless stated otherwise), run these steps:\n\n    // 1. Let slotables be the result of finding slotables for slot.\n    var slotables = findSlotables(slot);\n\n    // 2. If suppress signaling flag is unset, and slotables and slot’s assigned \n    // nodes are not identical, then run signal a slot change for slot.\n    var identical = true;\n    var slotState = _utils2.default.getShadowState(slot) || _utils2.default.setShadowState(slot, {});\n    var assignedNodes = slotState.assignedNodes || [];\n    for (var i = 0; i < slotables.length; i++) {\n        if (slotables[i] !== assignedNodes[i]) {\n            identical = false;\n            break;\n        }\n    }\n    if (!suppressSignaling && !identical) {\n        signalASlotChange(slot);\n    }\n\n    // 3. Set slot’s assigned nodes to slotables.\n    slotState.assignedNodes = slotables;\n\n    // 4. For each slotable in slotables, set slotable’s assigned slot to slot.\n    for (var _i3 = 0; _i3 < slotables.length; _i3++) {\n        var slotable = slotables[_i3];\n        // If it's a slotable it should already have an associated state object.\n        _utils2.default.getShadowState(slotable).assignedSlot = slot;\n    }\n\n    // 4a. If we haven't tracked them yet, track the slot's logical children\n    if (!slotState.childNodes) {\n        var slotChildNodes = nodeChildNodesDescriptor.get.call(slot);\n        var slotChildNodesLength = slotChildNodes.length;\n        slotState.childNodes = new Array(slotChildNodesLength);\n        for (var _i4 = 0; _i4 < slotChildNodesLength; _i4++) {\n            slotState.childNodes[_i4] = slotChildNodes[_i4];\n        }\n    }\n\n    // function call avoiding closure for performance.\n    if (!identical) {\n        _utils2.default.setImmediate(renderSlotablesAsync, slot);\n    }\n}\n\nfunction renderSlotablesAsync(slot) {\n    var slotState = _utils2.default.getShadowState(slot);\n    var slotables = slotState.assignedNodes;\n\n    // 4b. Clean out the slot\n    var firstChild = void 0;\n    while (firstChild = nodeFirstChildDescriptor.get.call(slot)) {\n        nodeRemoveChildDescriptor.value.call(slot, firstChild);\n    }\n\n    // 4c. Append the slotables, if any\n    for (var i = 0; i < slotables.length; i++) {\n        var slotable = slotables[i];\n        nodeAppendChildDescriptor.value.call(slot, slotable);\n    }\n\n    // 4d. Append the fallback content, if no slots\n    if (!slotables.length) {\n        var childNodes = slotState.childNodes;\n        for (var _i5 = 0; _i5 < childNodes.length; _i5++) {\n            nodeAppendChildDescriptor.value.call(slot, childNodes[_i5]);\n        }\n    }\n}\n\nfunction assignSlotablesForATree(tree, noSignalSlots) {\n    // https://dom.spec.whatwg.org/#assign-slotables-for-a-tree\n    // To assign slotables for a tree, given a tree tree and an optional set of slots noSignalSlots\n    // (empty unless stated otherwise), run these steps for each slot slot in tree, in tree order:\n    var slots = [];\n\n    if (tree.localName === TAG_SLOT) {\n        slots[0] = tree;\n    }\n\n    treeOrderRecursiveSelectAll(tree, slots, function (descendant) {\n        return descendant.localName === TAG_SLOT;\n    });\n\n    for (var i = 0; i < slots.length; i++) {\n        var slot = slots[i];\n\n        // 1. Let suppress signaling flag be set, if slot is in noSignalSlots, and unset otherwise.\n        var suppressSignaling = noSignalSlots && noSignalSlots.indexOf(slot) !== -1;\n\n        // 2. Run assign slotables for slot with suppress signaling flag.\n        assignSlotables(slot, suppressSignaling);\n    }\n}\n\nfunction assignASlot(slotable) {\n    var slot = findASlot(slotable);\n\n    if (slot != null) {\n        assignSlotables(slot);\n    }\n}\n\n// https://dom.spec.whatwg.org/#signaling-slot-change\n\nfunction signalASlotChange(slot) {\n    // https://dom.spec.whatwg.org/#signal-a-slot-change\n    // To signal a slot change, for a slot slot, run these steps:\n\n    // 1. If slot is not in unit of related similar-origin browsing contexts' \n    // signal slot list, append slot to unit of related similar-origin browsing \n    // contexts' signal slot list.\n    if (signalSlotList.indexOf(slot) === -1) {\n        signalSlotList.push(slot);\n    }\n\n    // 2. Queue a mutation observer compound microtask.\n    queueMutationObserverCompoundMicrotask();\n}\n\n// https://dom.spec.whatwg.org/#mutation-algorithms\n\nfunction ensurePreInsertionValidity(node, parent, child) {\n    // https://dom.spec.whatwg.org/#concept-node-ensure-pre-insertion-validity\n    // To ensure pre-insertion validity of a node into a parent before a child, run these steps:\n\n    // 1. If parent is not a Document, DocumentFragment, or Element node, throw a HierarchyRequestError.\n    // SKIP: native\n\n    // 2. If node is a host-including inclusive ancestor of parent, throw a HierarchyRequestError.\n    if (hostIncludingInclusiveAncestor(node, parent)) {\n        throw _utils2.default.makeDOMException(ERROR_HIERARCHY_REQUEST);\n    }\n\n    // 3. If child is not null and its parent is not parent, then throw a NotFoundError.\n    if (child != null && child.parentNode !== parent) {\n        throw _utils2.default.makeDOMException(ERROR_NOT_FOUND);\n    }\n\n    // 4. If node is not a DocumentFragment, DocumentType, Element, Text, ProcessingInstruction, \n    // or Comment node, throw a HierarchyRequestError.\n    // SKIP: native\n\n    // 5. If either node is a Text node and parent is a document, or node is a doctype \n    // and parent is not a document, throw a HierarchyRequestError.\n    // SKIP: native\n\n    // 6. If parent is a document, and any of the statements below, switched on node, \n    // are true, throw a HierarchyRequestError.\n    // SKIP: native\n}\n\nfunction preInsert(node, parent, child) {\n    // https://dom.spec.whatwg.org/#concept-node-pre-insert\n    // To pre-insert a node into a parent before a child, run these steps:\n\n    // 1. Ensure pre-insertion validity of node into parent before child.\n    ensurePreInsertionValidity(node, parent, child);\n\n    // 2. Let reference child be child.\n    var referenceChild = child;\n\n    // 3. If reference child is node, set it to node’s next sibling.\n    referenceChild === node && (referenceChild = node.nextSibling);\n\n    // 4. Adopt node into parent’s node document.\n    // https://dom.spec.whatwg.org/#concept-node-adopt\n    adopt(node, parent.ownerDocument);\n\n    // 5. Insert node into parent before reference child.\n    // https://dom.spec.whatwg.org/#concept-node-insert\n    insert(node, parent, referenceChild);\n\n    // 6. Return node.\n    return node;\n}\n\nfunction insert(node, parent, child, suppressObservers) {\n    // https://dom.spec.whatwg.org/#concept-node-insert\n    // To insert a node into a parent before a child, with an optional suppress observers flag, run these steps:\n\n    // 1. Let count be the number of children of node if it is a DocumentFragment node, and one otherwise.\n    var count = 1;\n    var nodeChildNodes = void 0;\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        nodeChildNodes = node.childNodes;\n        count = nodeChildNodes.length;\n    }\n\n    // 2. If child is non-null, run these substeps:\n    // TODO: (Range)\n\n    // 3. Let nodes be node’s children if node is a DocumentFragment node, \n    // and a list containing solely node otherwise.\n    var nodes = new Array(count);\n\n    // 4. If node is a DocumentFragment node, remove its children with the suppress observers flag set.\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        for (var i = 0; i < count; i++) {\n            nodes[i] = nodeChildNodes[i];\n        }\n        for (var _i6 = 0; _i6 < count; _i6++) {\n            remove(nodes[_i6], node, true);\n        }\n        // 5. If node is a DocumentFragment node, queue a mutation record of \"childList\" for node with removedNodes nodes.\n        queueMutationRecord(MO_TYPE_CHILD_LIST, node, null, null, null, null, nodes);\n    } else {\n        nodes[0] = node;\n    }\n\n    // 6. For each node in nodes, in tree order, run these substeps:\n    var parentState = _utils2.default.getShadowState(parent);\n    var parentIsShadow = isShadowRoot(parent);\n    var parentStateChildNodes = parentState ? parentState.childNodes : null;\n    var parentIsConnected = parent.isConnected;\n    for (var _i7 = 0; _i7 < count; _i7++) {\n        var _node = nodes[_i7];\n        // 1. Insert node into parent before child or at the end of parent if child is null.\n        if (parentStateChildNodes) {\n            if (child) {\n                var childIndex = parentStateChildNodes.indexOf(child);\n                // TODO: PERF: Probably not worth the readability sacrifice to manually \n                // roll a splice algorithm here, but will come back to this later\n                parentStateChildNodes.splice(childIndex, 0, _node);\n            } else {\n                parentStateChildNodes.push(_node);\n            }\n            var nodeState = _utils2.default.getShadowState(_node) || _utils2.default.setShadowState(_node, {});\n            nodeState.parentNode = parent;\n            // If it's a shadow root, perform physical insert on the host.\n            if (parentIsShadow) {\n                nodeInsertBeforeDescriptor.value.call(parentState.host, _node, child);\n            }\n        } else {\n            nodeInsertBeforeDescriptor.value.call(parent, _node, child);\n        }\n\n        // 2. If parent is a shadow host and node is a slotable, then assign a slot for node.\n        if (parentState && parentState.shadowRoot && PROP_ASSIGNED_SLOT in _node) {\n            assignASlot(_node);\n        }\n\n        // 3. If parent is a slot whose assigned nodes is the empty list, \n        // then run signal a slot change for parent.\n        if (parent.localName === TAG_SLOT && (!parentState || !parentState.assignedNodes || parentState.assignedNodes.length === 0)) {\n            // 3a. Physically append the child into the slot.\n            nodeAppendChildDescriptor.value.call(parent, _node);\n            // 3b. Do what the spec said\n            signalASlotChange(parent);\n        }\n\n        // 4. Run assign slotables for a tree with node’s tree and a set containing \n        // each inclusive descendant of node that is a slot.\n        var inclusiveSlotDescendants = [];\n        if (_node.localName === TAG_SLOT) {\n            inclusiveSlotDescendants[0] = _node;\n        }\n        treeOrderRecursiveSelectAll(_node, inclusiveSlotDescendants, function (descendant) {\n            return descendant.localName === TAG_SLOT;\n        });\n        assignSlotablesForATree(_node, inclusiveSlotDescendants);\n\n        if (parentIsConnected && _customElements2.default.isInstalled()) {\n            // 5. For each shadow-including inclusive descendant inclusiveDescendant of node, \n            // in shadow-including tree order, run these subsubsteps:\n            forEachShadowIncludingInclusiveDescendant(_node, function (inclusiveDescendant) {\n                // 1. Run the insertion steps with inclusiveDescendant\n                // SKIP: other\n\n                // 2. If inclusiveDescendant is connected, then...\n                // PERF: moved this check out of the loop.\n\n                // 1. If inclusiveDescendant is custom, then enqueue a custom element \n                // callback reaction with inclusiveDescendant, callback name \n                // \"connectedCallback\", and an empty argument list.\n                if (_customElements2.default.isCustom(inclusiveDescendant)) {\n                    _customElements2.default.enqueueConnectedReaction(inclusiveDescendant, []);\n                }\n                // 2. Otherwise, try to upgrade inclusiveDescendant.\n                else {\n                        _customElements2.default.tryToUpgradeElement(inclusiveDescendant);\n                    }\n            });\n        }\n    }\n\n    // 7. If suppress observers flag is unset, queue a mutation record of \"childList\" for parent \n    // with addedNodes nodes, nextSibling child, and previousSibling child’s previous sibling or \n    // parent’s last child if child is null.\n    if (!suppressObservers) {\n        var previousSibling = child ? child.previousSibling : parent.lastChild;\n        queueMutationRecord(MO_TYPE_CHILD_LIST, parent, null, null, null, nodes, null, previousSibling, child);\n    }\n}\n\nfunction append(node, parent) {\n    // https://dom.spec.whatwg.org/#concept-node-append\n    // To append a node to a parent, pre-insert node into parent before null.\n    return preInsert(node, parent, null);\n}\n\nfunction replace(child, node, parent) {\n    // https://dom.spec.whatwg.org/#concept-node-replace\n    // To replace a child with node within a parent, run these steps:\n\n    // 1. If parent is not a Document, DocumentFragment, or Element node, throw a HierarchyRequestError.\n    // SKIP: native\n\n    // 2. If node is a host-including inclusive ancestor of parent, throw a HierarchyRequestError.\n    if (hostIncludingInclusiveAncestor(node, parent)) {\n        throw _utils2.default.makeDOMException(ERROR_HIERARCHY_REQUEST);\n    }\n\n    // 3. If child’s parent is not parent, then throw a NotFoundError.\n    if (child.parentNode !== parent) {\n        throw _utils2.default.makeDOMException(ERROR_NOT_FOUND);\n    }\n\n    // 4. If node...\n    // SKIP: native\n\n    // 5. If either node...\n    // SKIP: native\n\n    // 6. If parent...\n    // SKIP: native\n\n    // 7. Let reference child be child’s next sibling.\n    var referenceChild = child.nextSibling;\n\n    // 8. If reference child is node, set it to node’s next sibling.\n    if (referenceChild === node) {\n        referenceChild = node.nextSibling;\n    }\n\n    // 9. Let previousSibling be child’s previous sibling.\n    var previousSibling = child.previousSibling;\n\n    // 10. Adopt node into parent’s node document.\n    adopt(node, parent.ownerDocument);\n\n    // 11. Let removedNodes be the empty list.\n    var removedNodes = [];\n\n    // 12. If child’s parent is not null, run these substeps:\n    var childParent = child.parentNode;\n    if (childParent != null) {\n        // 1. Set removedNodes to a list solely containing child.\n        removedNodes[0] = child;\n        // 2. Remove child from its parent with the suppress observers flag set.\n        remove(child, parent, true);\n    }\n\n    // 13. Let nodes be node’s children if node is a DocumentFragment node, and a list containing solely node otherwise.\n    var nodes = void 0;\n    if (node instanceof DocumentFragment) {\n        var childNodes = node.childNodes;\n        var childNodesLength = childNodes.length;\n        nodes = new Array(childNodesLength);\n        for (var i = 0; i < childNodesLength; i++) {\n            nodes[i] = childNodes[i];\n        }\n    } else {\n        nodes = [node];\n    }\n\n    // 14. Insert node into parent before reference child with the suppress observers flag set.\n    insert(node, parent, referenceChild, true);\n\n    // 15. Queue a mutation record of \"childList\" for target parent with addedNodes nodes, \n    // removedNodes removedNodes, nextSibling reference child, and previousSibling previousSibling.\n    queueMutationRecord(MO_TYPE_CHILD_LIST, parent, null, null, null, nodes, removedNodes, previousSibling, referenceChild);\n}\n\nfunction replaceAll(node, parent) {\n    // https://dom.spec.whatwg.org/#concept-node-replace-all\n    // To replace all with a node within a parent, run these steps:\n\n    // 1. If node is not null, adopt node into parent’s node document.\n    if (node != null) {\n        adopt(node, parent.ownerDocument);\n    }\n\n    // 2. Let removedNodes be parent’s children.\n    var parentChildNodes = parent.childNodes;\n    var removedNodesCount = parentChildNodes.length;\n    var removedNodes = new Array(removedNodesCount);\n    for (var i = 0; i < removedNodesCount; i++) {\n        removedNodes[i] = parentChildNodes[i];\n    }\n\n    // 3. Let addedNodes be the empty list if node is null, node’s children if \n    // node is a DocumentFragment node, and a list containing node otherwise.\n    var addedNodes = void 0;\n    if (node == null) {\n        addedNodes = [];\n    } else if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        var nodeChildNodes = node.childNodes;\n        var nodeChildNodesLength = nodeChildNodes.length;\n        addedNodes = new Array(nodeChildNodesLength);\n        for (var _i8 = 0; _i8 < nodeChildNodesLength; _i8++) {\n            addedNodes[_i8] = nodeChildNodes[_i8];\n        }\n    } else {\n        addedNodes = [node];\n    }\n\n    // 4. Remove all parent’s children, in tree order, with the suppress observers flag set.\n    for (var _i9 = 0; _i9 < removedNodesCount; _i9++) {\n        remove(removedNodes[_i9], parent, true);\n    }\n\n    // 5. If node is not null, insert node into parent before null with the suppress observers flag set.\n    if (node != null) {\n        insert(node, parent, null, true);\n    }\n\n    // 6. Queue a mutation record of \"childList\" for parent with addedNodes addedNodes and removedNodes removedNodes.\n    queueMutationRecord(MO_TYPE_CHILD_LIST, parent, null, null, null, addedNodes, removedNodes);\n}\n\nfunction preRemove(child, parent) {\n    // https://dom.spec.whatwg.org/#concept-node-pre-remove\n    // To pre-remove a child from a parent, run these steps:\n\n    // 1. If child’s parent is not parent, then throw a NotFoundError.\n    if (child.parentNode !== parent) {\n        throw _utils2.default.makeDOMException(ERROR_NOT_FOUND);\n    }\n\n    // 2. Remove child from parent.\n    remove(child, parent);\n\n    // 3. Return child.\n    return child;\n}\n\nfunction remove(node, parent, suppressObservers) {\n    // https://dom.spec.whatwg.org/#concept-node-remove\n    // To remove a node from a parent, with an optional suppress observers flag, run these steps:\n\n    // TODO: (Range)\n    // 1. Let index be node’s index.\n    // 2. For each range whose start node is an inclusive descendant of node, set its start to (parent, index).\n    // 3. For each range whose end node is an inclusive descendant of node, set its end to (parent, index).\n    // 4. For each range whose start node is parent and start offset is greater than index, decrease its start offset by one.\n    // 5. For each range whose end node is parent and end offset is greater than index, decrease its end offset by one.\n\n    // TODO: (NodeIterator)\n    // 6. For each NodeIterator object iterator whose root’s node document is node’s node document, \n    // run the NodeIterator pre-removing steps given node and iterator.\n\n    // 7. Let oldPreviousSibling be node’s previous sibling.\n    var oldPreviousSibling = node.previousSibling;\n\n    // 8. Let oldNextSibling be node’s next sibling.\n    var oldNextSibling = node.nextSibling;\n\n    // 9. Remove node from its parent.\n    var nodeState = _utils2.default.getShadowState(node);\n    var parentState = _utils2.default.getShadowState(parent);\n    if (parentState && parentState.childNodes) {\n        var nodeIndex = parentState.childNodes.indexOf(node);\n        parentState.childNodes.splice(nodeIndex, 1);\n        // Should always have nodeState if we got here.\n        nodeState.parentNode = null;\n        var parentNode = nodeParentNodeDescriptor.get.call(node);\n        nodeRemoveChildDescriptor.value.call(parentNode, node);\n    } else {\n        nodeRemoveChildDescriptor.value.call(parent, node);\n    }\n\n    // 10. If node is assigned, then run assign slotables for node’s assigned slot.\n    if (nodeState && nodeState.assignedSlot) {\n        assignSlotables(nodeState.assignedSlot);\n        nodeState.assignedSlot = null;\n    }\n\n    // 11. If parent is a slot whose assigned nodes is the empty list,\n    // then run signal a slot change for parent.\n    if (parent.localName === TAG_SLOT && (!parentState || !parentState.assignedNodes || parentState.assignedNodes.length === 0)) {\n        signalASlotChange(parent);\n    }\n\n    // 12. If node has an inclusive descendant that is a slot, then:\n    var inclusiveSlotDescendants = [];\n    if (node.localName === TAG_SLOT) {\n        inclusiveSlotDescendants[0] = node;\n    }\n    treeOrderRecursiveSelectAll(node, inclusiveSlotDescendants, function (descendant) {\n        return descendant.localName === TAG_SLOT;\n    });\n    if (inclusiveSlotDescendants.length) {\n        // 1. Run assign slotables for a tree with parent’s tree.\n        assignSlotablesForATree(parent);\n        // 2. Run assign slotables for a tree with node’s tree and a \n        // set containing each inclusive descendant of node that is a slot.\n        assignSlotablesForATree(node, inclusiveSlotDescendants);\n    }\n\n    // 13. Run the removing steps with node and parent.\n    // SKIP: other\n\n    if (_customElements2.default.isInstalled()) {\n        // 14. If node is custom, then enqueue a custom element callback reaction \n        // with node, callback name \"disconnectedCallback\", and an empty argument list.\n        if (_customElements2.default.isCustom(node)) {\n            _customElements2.default.enqueueDisconnectedReaction(node, []);\n        }\n\n        // 15. For each shadow-including descendant descendant of node, in \n        // shadow-including tree order, run these substeps:\n        forEachShadowIncludingDescendant(node, function (descendant) {\n            // 1. Run the removing steps with descendant.\n            // SKIP: other\n\n            // 2. If descendant is custom, then enqueue a custom element \n            // callback reaction with descendant, callback name \"disconnectedCallback\", \n            // and an empty argument list.\n            if (_customElements2.default.isCustom(descendant)) {\n                _customElements2.default.enqueueDisconnectedReaction(descendant, []);\n            }\n        });\n    }\n\n    // 16. For each inclusive ancestor inclusiveAncestor of parent...\n    var inclusiveAncestor = parent;\n    while (inclusiveAncestor) {\n        // ...if inclusiveAncestor has any registered observers whose options' \n        // subtree is true, then for each such registered observer registered... \n        var ancestorState = _utils2.default.getShadowState(inclusiveAncestor);\n        if (ancestorState && ancestorState.observers) {\n            var ancestorObservers = ancestorState.observers;\n            for (var i = 0; i < ancestorObservers.length; i++) {\n                var registeredObserver = ancestorObservers[i];\n                if (registeredObserver.options.subtree) {\n                    // ...append a transient registered observer whose observer and options are \n                    // identical to those of registered and source which is registered to node’s \n                    // list of registered observers.\n                    var observer = registeredObserver.instance;\n                    var options = registeredObserver.options;\n                    var transientObserver = createTransientObserver(observer, node, options);\n                    mutationObservers.push(transientObserver);\n                }\n            }\n        }\n        inclusiveAncestor = inclusiveAncestor.parentNode;\n    }\n\n    // 17. If suppress observers flag is unset, queue a mutation record of \"childList\" \n    // for parent with removedNodes a list solely containing node, nextSibling \n    // oldNextSibling, and previousSibling oldPreviousSibling.\n    if (!suppressObservers) {\n        queueMutationRecord(MO_TYPE_CHILD_LIST, parent, null, null, null, null, [node], oldPreviousSibling, oldNextSibling);\n    }\n}\n\n// https://dom.spec.whatwg.org/#mutation-observers\n\n// TODO: test everything that queues mutation records\n\n// TODO: move mutation observers into a separately installed feature.\n// It should be installed automatically when ShadowDOM is installed,\n// with an option to opt out if desired for performance\n\nfunction getOrCreateNodeObservers(node) {\n    var nodeState = _utils2.default.getShadowState(node) || _utils2.default.setShadowState(node, {});\n    var observers = nodeState.observers;\n    return observers ? observers : nodeState.observers = [];\n}\n\nfunction createMutationObserver(callback) {\n    return {\n        callback: callback,\n        queue: [],\n        nodes: [],\n        observe: function observe(node, options) {\n            if (this.nodes.length === 0) {\n                mutationObservers.push(this);\n            }\n            var nodeObservers = getOrCreateNodeObservers(node);\n            nodeObservers.push({ instance: this, options: options });\n            this.nodes.push(node);\n        },\n        disconnect: function disconnect() {\n            var index = mutationObservers.indexOf(this);\n            mutationObservers.splice(index, 1);\n            for (var i = 0; i < this.nodes.length; i++) {\n                var nodeObservers = getOrCreateNodeObservers(this.nodes[i]);\n                for (var j = 0; j < nodeObservers.length; j++) {\n                    if (nodeObservers[j].instance === this) {\n                        nodeObservers.splice(j, 1);\n                        break;\n                    }\n                }\n            }\n            this.nodes = [];\n        }\n    };\n}\n\nfunction createTransientObserver(observer, node, options) {\n    var transientObserver = {\n        observer: observer,\n        callback: observer.callback,\n        options: options,\n        queue: [],\n        node: node,\n        disconnect: function disconnect() {\n            var nodeObservers = getOrCreateNodeObservers(this.node);\n            for (var j = 0; j < nodeObservers.length; j++) {\n                if (nodeObservers[j].instance === this) {\n                    nodeObservers.splice(j, 1);\n                    break;\n                }\n            }\n        }\n    };\n\n    var nodeObservers = getOrCreateNodeObservers(node);\n    nodeObservers.push({ instance: transientObserver, options: options });\n\n    return transientObserver;\n}\n\nvar mutationObserverCompoundMicrotaskQueuedFlag = false;\n\nvar mutationObservers = [];\nvar signalSlotList = [];\nvar theEmptyList = Object.freeze([]);\n\nfunction queueMutationRecord(type, target, name, nameSpace, oldValue, addedNodes, removedNodes, previousSibling, nextSibling) {\n    // PERF: This is an out-of-spec optimization\n    if (mutationObservers.length === 0) {\n        return;\n    }\n\n    // https://dom.spec.whatwg.org/#queueing-a-mutation-record\n    // 1. Let interested observers be an initially empty set of \n    // MutationObserver objects optionally paired with a string.\n    var interestedObservers = [];\n    var pairedStrings = [];\n    // 2. Let nodes be the inclusive ancestors of target.\n    var nodes = [target];\n    var ancestor = target;\n    while (ancestor = ancestor.parentNode) {\n        nodes.push(ancestor);\n    }\n    // 3. Then, for each node in nodes... \n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        var nodeState = _utils2.default.getShadowState(node);\n        if (!nodeState || !nodeState.observers) {\n            continue;\n        }\n        // ...and then for each registered observer (with registered \n        // observer’s options as options) in node’s list of registered \n        // observers...\n        for (var j = 0; j < nodeState.observers.length; j++) {\n            var registeredObserver = nodeState.observers[j];\n            var options = registeredObserver.options;\n            // ...run these substeps:\n            // 1. If none of the following are true:\n            if (node != target && !options.subtree) {\n                continue;\n            }\n            if (type === MO_TYPE_ATTRIBUTES) {\n                if (!options.attributes) {\n                    continue;\n                }\n                // if options' attributeFilter is present, and options' attributeFilter\n                // does not contain name or namespace is non-null\n                if (options.attributeFilter && (options.attributeFilter.indexOf(name) === -1 || nameSpace != null)) {\n                    continue;\n                }\n            }\n            if (type === MO_TYPE_CHARACTER_DATA && !options.characterData) {\n                continue;\n            }\n            if (type === MO_TYPE_CHILD_LIST && !options.childList) {\n                continue;\n            }\n            // ...then run the subsubsteps:\n            // 1. If registered observer’s observer is not in interested observers, \n            // append registered observer’s observer to interested observers.\n            var observer = registeredObserver.instance;\n            var index = interestedObservers.indexOf(observer);\n            if (index === -1) {\n                index = interestedObservers.length;\n                interestedObservers[index] = observer;\n            }\n            // 2. If either type is \"attributes\" and options’ attributeOldValue is true, \n            // or type is \"characterData\" and options’ characterDataOldValue is true, \n            // set the paired string of registered observer’s observer in interested observers to oldValue.\n            if (type === MO_TYPE_ATTRIBUTES && options.attributeOldValue || type === MO_TYPE_CHARACTER_DATA && options.characterDataOldValue) {\n                pairedStrings[index] = oldValue;\n            }\n        }\n    }\n\n    // PERF: This is an out-of-spec optimization\n    if (interestedObservers.length === 0) {\n        return;\n    }\n\n    // 4. Then, for each observer in interested observers, run these substeps:\n    for (var _i10 = 0; _i10 < interestedObservers.length; _i10++) {\n        var _observer = interestedObservers[_i10];\n        // 1. Let record be a new MutationRecord object with its type set to type and target set to target.\n        var record = {\n            type: type,\n            target: target,\n            attributeName: null,\n            attributeNamespace: null,\n            addedNodes: theEmptyList,\n            removedNodes: theEmptyList,\n            previousSibling: null,\n            nextSibling: null,\n            oldValue: null\n        };\n        // 2. If name and namespace are given, set record’s attributeName to name, and record’s attributeNamespace to namespace.\n        if (name) {\n            record.attributeName = name;\n            record.attributeNamespace = nameSpace;\n        }\n        // 3. If addedNodes is given, set record’s addedNodes to addedNodes.\n        if (addedNodes) {\n            record.addedNodes = Object.freeze(addedNodes);\n        }\n        // 4. If removedNodes is given, set record’s removedNodes to removedNodes.\n        if (removedNodes) {\n            record.removedNodes = Object.freeze(removedNodes);\n        }\n        // 5. If previousSibling is given, set record’s previousSibling to previousSibling.\n        if (previousSibling) {\n            record.previousSibling = previousSibling;\n        }\n        // 6. If nextSibling is given, set record’s nextSibling to nextSibling.\n        if (nextSibling) {\n            record.nextSibling = nextSibling;\n        }\n        // 7. If observer has a paired string, set record’s oldValue to observer’s paired string.\n        record.oldValue = pairedStrings[_i10];\n        // 8. Append record to observer’s record queue.\n        _observer.queue.push(record);\n    }\n\n    // 5. Queue a mutation observer compound microtask.\n    queueMutationObserverCompoundMicrotask();\n}\n\nfunction queueMutationObserverCompoundMicrotask() {\n    if (mutationObserverCompoundMicrotaskQueuedFlag) {\n        return;\n    }\n    mutationObserverCompoundMicrotaskQueuedFlag = true;\n    _utils2.default.setImmediate(notifyMutationObservers);\n}\n\nfunction notifyMutationObservers() {\n    mutationObserverCompoundMicrotaskQueuedFlag = false;\n    var mutationObserversLength = mutationObservers.length;\n    var notifyList = new Array(mutationObserversLength);\n    for (var i = 0; i < mutationObserversLength; i++) {\n        notifyList[i] = mutationObservers[i];\n    }\n    var signalList = signalSlotList.splice(0, signalSlotList.length);\n    for (var _i11 = 0; _i11 < notifyList.length; _i11++) {\n        var observer = notifyList[_i11];\n        var queue = observer.queue.splice(0, observer.queue.length);\n        for (var j = mutationObservers.length - 1; j >= 0; j--) {\n            var transientObserver = mutationObservers[j];\n            if (transientObserver.observer === observer) {\n                mutationObservers.splice(j, 1);\n                transientObserver.disconnect();\n            }\n        }\n        if (queue.length) {\n            try {\n                observer.callback.call(observer.interface, queue, observer.interface);\n            } catch (error) {\n                _utils2.default.reportError(error);\n            }\n        }\n    }\n    for (var _i12 = 0; _i12 < signalList.length; _i12++) {\n        var slot = signalList[_i12];\n        var event = slot.ownerDocument.createEvent(EVENT);\n        event.initEvent(EVT_SLOT_CHANGE, true, false);\n        try {\n            slot.dispatchEvent(event);\n        } catch (error) {\n            _utils2.default.reportError(error);\n        }\n    }\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar attrValueDescriptor = _utils2.default.descriptor(Attr, 'value'); // https://dom.spec.whatwg.org/#interface-attr\n\nexports.default = {\n\n    get value() {\n        return attrValueDescriptor.get.call(this);\n    },\n\n    set value(value) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            _dom2.default.setExistingAttributeValue(_this, value);\n        });\n    }\n\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-characterdata\n\nvar characterDataDataDescriptor = _utils2.default.descriptor(CharacterData, 'data');\n\nexports.default = {\n\n    get data() {\n        return characterDataDataDescriptor.get.call(this);\n    },\n\n    set data(value) {\n        var length = characterDataDataDescriptor.get.call(this).length;\n        _dom2.default.replaceData(this, 0, length, value);\n    },\n\n    appendData: function appendData(data) {\n        var length = characterDataDataDescriptor.get.call(this).length;\n        _dom2.default.replaceData(this, length, 0, data);\n    },\n    insertData: function insertData(offset, data) {\n        _dom2.default.replaceData(this, offset, 0, data);\n    },\n    deleteData: function deleteData(offset, count) {\n        _dom2.default.replaceData(this, offset, count, '');\n    },\n    replaceData: function replaceData(offset, count, data) {\n        _dom2.default.replaceData(this, offset, count, data);\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = $CustomEvent;\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction $CustomEvent(type, init) {\n    var bubbles = false;\n    var cancelable = false;\n    var composed = false;\n    var detail = null;\n    if (init) {\n        bubbles = init.bubbles === true;\n        cancelable = init.cancelable === true;\n        composed = init.composed === true;\n        detail = init.detail || null;\n    }\n    var event = document.createEvent('CustomEvent');\n    event.initCustomEvent(type, bubbles, cancelable, detail);\n    _utils2.default.setShadowState(event, { composed: composed });\n    return event;\n} // https://dom.spec.whatwg.org/#interface-customevent\n\n$CustomEvent.prototype = window.CustomEvent.prototype;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.getOrCreateDOMTokenList = getOrCreateDOMTokenList;\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    get length() {\n        var state = _utils2.default.getShadowState(this);\n        return state.tokens.length;\n    },\n\n    // TODO: Caveat about indexer expressions?\n    item: function item(index) {\n        var state = _utils2.default.getShadowState(this);\n        return index >= state.tokens.length ? null : state.tokens[index];\n    },\n    contains: function contains(token) {\n        var state = _utils2.default.getShadowState(this);\n        return state.tokens.indexOf(token) !== -1;\n    },\n    add: function add() {\n        var _this = this;\n\n        for (var _len = arguments.length, tokens = Array(_len), _key = 0; _key < _len; _key++) {\n            tokens[_key] = arguments[_key];\n        }\n\n        return _customElements2.default.executeCEReactions(function () {\n            validateTokens(tokens);\n            var state = _utils2.default.getShadowState(_this);\n            for (var i = 0; i < tokens.length; i++) {\n                var token = tokens[i];\n                var index = state.tokens.indexOf(token);\n                if (index === -1) {\n                    state.tokens.push(token);\n                }\n            }\n            state.tokens.sort();\n            _dom2.default.setAttributeValue(state.element, state.localName, state.tokens.join(' '));\n        });\n    },\n    remove: function remove() {\n        var _this2 = this;\n\n        for (var _len2 = arguments.length, tokens = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            tokens[_key2] = arguments[_key2];\n        }\n\n        return _customElements2.default.executeCEReactions(function () {\n            validateTokens(tokens);\n            var state = _utils2.default.getShadowState(_this2);\n            for (var i = 0; i < tokens.length; i++) {\n                var token = tokens[i];\n                var index = state.tokens.indexOf(token);\n                if (index !== -1) {\n                    state.tokens.splice(index, 1);\n                }\n            }\n            _dom2.default.setAttributeValue(state.element, state.localName, state.tokens.join(' '));\n        });\n    },\n    toggle: function toggle(token, force) {\n        var _this3 = this,\n            _arguments = arguments;\n\n        return _customElements2.default.executeCEReactions(function () {\n            validateToken(token);\n            var state = _utils2.default.getShadowState(_this3);\n            var index = state.tokens.indexOf(token);\n            if (index !== -1) {\n                if (_arguments.length === 1 || force === false) {\n                    state.tokens.splice(index, 1);\n                    _dom2.default.setAttributeValue(state.element, state.localName, state.tokens.join(' '));\n                    return false;\n                } else {\n                    return true;\n                }\n            } else {\n                if (force === false) {\n                    return false;\n                } else {\n                    state.tokens.push(token);\n                    state.tokens.sort();\n                    _dom2.default.setAttributeValue(state.element, state.localName, state.tokens.join(' '));\n                    return true;\n                }\n            }\n        });\n    },\n    replace: function replace(token, newToken) {\n        var _this4 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            validateToken(token);\n            validateToken(newToken);\n            var state = _utils2.default.getShadowState(_this4);\n            var index = state.tokens.indexOf(token);\n            if (index === -1) {\n                return;\n            }\n            state.tokens[index] = newToken;\n            state.tokens.sort();\n            _dom2.default.setAttributeValue(state.element, state.localName, state.tokens.join(' '));\n        });\n    },\n\n\n    get value() {\n        var state = _utils2.default.getShadowState(this);\n        return state.element.getAttribute(state.localName) || '';\n    },\n\n    set value(value) {\n        var _this5 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var state = _utils2.default.getShadowState(_this5);\n            _dom2.default.setAttributeValue(state.element, state.localName, value);\n            // TODO: Remove usage of slice in favor of direct parse\n            state.tokens = Array.prototype.slice.call(_this5);\n        });\n    }\n\n}; // https://dom.spec.whatwg.org/#interface-domtokenlist\n\nfunction validateTokens(tokens) {\n    for (var i = 0; i < tokens.length; i++) {\n        validateToken(tokens[i]);\n    }\n}\n\nfunction validateToken(token) {\n    if (token == '') {\n        throw _utils2.default.makeDOMException('SyntaxError');\n    }\n    if (/\\s/.test(token)) {\n        throw _utils2.default.makeDOMException('InvalidCharacterError');\n    }\n}\n\nfunction createDOMTokenList(element, localName) {\n    // TODO: run the steps per the DOM spec for 'when a DOMTokenList is created'\n    var originalValue = element.getAttribute(localName);\n    var tokens = originalValue ? originalValue.split(/\\s/).sort() : [];\n    var tokenList = Object.create(DOMTokenList.prototype);\n    _utils2.default.setShadowState(tokenList, { element: element, localName: localName, tokens: tokens });\n    return tokenList;\n}\n\nfunction getOrCreateDOMTokenList(element, localName) {\n    var elementState = _utils2.default.getShadowState(element) || _utils2.default.setShadowState(element, { tokenLists: {} });\n    if (!elementState.tokenLists) {\n        elementState.tokenLists = {};\n    }\n    var tokenList = void 0;\n    if (tokenList = elementState.tokenLists[localName]) {\n        return tokenList;\n    }\n    return elementState.tokenLists[localName] = createDOMTokenList(element, localName);\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar documentGetElementsByTagNameDescriptor = _utils2.default.descriptor(Element, 'getElementsByTagName'); // https://dom.spec.whatwg.org/#interface-document\n\nvar documentGetElementsByTagNameNSDescriptor = _utils2.default.descriptor(Element, 'getElementsByTagNameNS');\nvar documentGetElementsByClassNameDescriptor = _utils2.default.descriptor(Element, 'getElementsByClassName');\n\nexports.default = {\n\n    // TODO: tests\n    getElementsByTagName: function getElementsByTagName(qualifiedName) {\n        var results = documentGetElementsByTagNameDescriptor.value.call(this, qualifiedName);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    getElementsByTagNameNS: function getElementsByTagNameNS(ns, localName) {\n        var results = documentGetElementsByTagNameNSDescriptor.value.call(this, ns, localName);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    getElementsByClassName: function getElementsByClassName(names) {\n        var results = documentGetElementsByClassNameDescriptor.value.call(this, name);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    importNode: function importNode(node, deep) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            if (node.nodeType === Node.DOCUMENT_NODE || _dom2.default.isShadowRoot(node)) {\n                throw _utils2.default.makeDOMException('NotSupportedError');\n            }\n\n            return _dom2.default.clone(node, _this, deep);\n        });\n    },\n\n\n    // TODO: tests\n    adoptNode: function adoptNode(node) {\n        var _this2 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            return _dom2.default.adopt(node, _this2);\n        });\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _ShadowRoot = require('../interfaces/ShadowRoot.js');\n\nvar _ShadowRoot2 = _interopRequireDefault(_ShadowRoot);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-element\n\nvar elementAttributesDescriptor = _utils2.default.descriptor(Element, 'attributes') || _utils2.default.descriptor(Node, 'attributes');\nvar elementGetElementsByTagNameDescriptor = _utils2.default.descriptor(Element, 'getElementsByTagName');\nvar elementGetElementsByTagNameNSDescriptor = _utils2.default.descriptor(Element, 'getElementsByTagNameNS');\nvar elementGetElementsByClassNameDescriptor = _utils2.default.descriptor(Element, 'getElementsByClassName');\nvar elementSetAttributeDescriptor = _utils2.default.descriptor(Element, 'setAttribute');\nvar elementSetAttributeNSDescriptor = _utils2.default.descriptor(Element, 'setAttributeNS');\nvar nodeChildNodesDescriptor = _utils2.default.descriptor(Node, 'childNodes');\nvar nodeRemoveChildDescriptor = _utils2.default.descriptor(Node, 'removeChild');\n\nexports.default = {\n\n    // TODO: tests\n    get attributes() {\n        var attributes = elementAttributesDescriptor.get.call(this);\n        var shadowState = _utils2.default.getShadowState(attributes);\n        if (!shadowState) {\n            _utils2.default.setShadowState(attributes, { element: this });\n        }\n        return attributes;\n    },\n\n    // TODO: tests\n    setAttribute: function setAttribute(qualifiedName, value) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var attributes = elementAttributesDescriptor.get.call(_this);\n            var attribute = attributes.getNamedItem(qualifiedName);\n            if (!attribute) {\n                elementSetAttributeDescriptor.value.call(_this, qualifiedName, value);\n                attribute = attributes.getNamedItem(qualifiedName);\n                _dom2.default.appendAttribute(attribute, _this);\n            } else {\n                _dom2.default.changeAttribute(attribute, _this, value);\n            }\n        });\n    },\n\n\n    // TODO: tests\n    setAttributeNS: function setAttributeNS(nameSpace, qualifiedName, value) {\n        var _this2 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var attributes = elementAttributesDescriptor.get.call(_this2);\n            var attribute = attributes.getNamedItemNS(nameSpace, qualifiedName);\n            if (!attribute) {\n                elementSetAttributeNSDescriptor.value.call(_this2, nameSpace, qualifiedName, value);\n                attribute = attributes.getNamedItemNS(nameSpace, qualifiedName);\n                _dom2.default.appendAttribute(attribute, _this2);\n            } else {\n                _dom2.default.changeAttribute(attribute, _this2, value);\n            }\n        });\n    },\n\n\n    // TODO: tests\n    removeAttribute: function removeAttribute(qualifiedName) {\n        var _this3 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            _dom2.default.removeAttributeByName(qualifiedName, _this3);\n        });\n    },\n\n\n    // TODO: tests\n    removeAttributeNS: function removeAttributeNS(nameSpace, localName) {\n        var _this4 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            _dom2.default.removeAttributeByNamespace(nameSpace, localName, _this4);\n        });\n    },\n\n\n    // TODO: tests\n    setAttributeNode: function setAttributeNode(attr) {\n        var _this5 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            return _dom2.default.setAttribute(attr, _this5);\n        });\n    },\n\n\n    // TODO: tests\n    setAttributeNodeNS: function setAttributeNodeNS(attr) {\n        var _this6 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            return _dom2.default.setAttribute(attr, _this6);\n        });\n    },\n\n\n    // TODO: tests\n    removeAttributeNode: function removeAttributeNode(attr) {\n        var _this7 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            if (attr.ownerElement !== _this7) {\n                throw _utils2.default.makeDOMException('NotFoundError');\n            }\n            _dom2.default.removeAttribute(attr, _this7);\n            return attr;\n        });\n    },\n    attachShadow: function attachShadow(init) {\n        // https://dom.spec.whatwg.org/#dom-element-attachshadow\n        if (!init || init.mode !== 'open' && init.mode !== 'closed') {\n            throw _utils2.default.makeDOMException('TypeError');\n        }\n\n        if (this.namespaceURI !== 'http://www.w3.org/1999/xhtml') {\n            throw _utils2.default.makeDOMException('NotSupportedError');\n        }\n\n        switch (this.localName) {\n            case \"article\":case \"aside\":case \"blockquote\":case \"body\":\n            case \"div\":case \"footer\":case \"h1\":case \"h2\":case \"h3\":\n            case \"h4\":case \"h5\":case \"h6\":case \"header\":case \"main\":\n            case \"nav\":case \"p\":case \"section\":case \"span\":\n                break;\n            default:\n                if (_customElements2.default.isValidCustomElementName(this.localName)) {\n                    break;\n                }\n                throw _utils2.default.makeDOMException('NotSupportedError');\n        }\n\n        if (this.shadowRoot) {\n            throw _utils2.default.makeDOMException('InvalidStateError');\n        }\n\n        var shadow = this.ownerDocument.createDocumentFragment();\n\n        _utils2.default.extend(shadow, _ShadowRoot2.default);\n\n        _utils2.default.setShadowState(shadow, {\n            host: this,\n            mode: init.mode,\n            childNodes: []\n        });\n\n        var originalChildNodes = nodeChildNodesDescriptor.get.call(this);\n        var removeChild = nodeRemoveChildDescriptor.value;\n        var savedChildNodes = new Array(originalChildNodes.length);\n        var firstChild = void 0;\n        var i = 0;\n        while (firstChild = originalChildNodes[0]) {\n            var childState = _utils2.default.getShadowState(firstChild) || _utils2.default.setShadowState(firstChild, {});\n            childState.parentNode = this;\n            savedChildNodes[i++] = firstChild;\n            removeChild.call(this, firstChild);\n        }\n\n        var hostState = _utils2.default.getShadowState(this);\n        if (!hostState) {\n            hostState = {};\n            _utils2.default.setShadowState(this, hostState);\n        }\n        hostState.shadowRoot = shadow;\n        hostState.childNodes = savedChildNodes;\n\n        return shadow;\n    },\n\n\n    get shadowRoot() {\n        // https://dom.spec.whatwg.org/#dom-element-shadowroot\n        var shadowRoot = null;\n        var shadowState = _utils2.default.getShadowState(this);\n        if (shadowState) {\n            shadowRoot = shadowState.shadowRoot;\n            if (!shadowRoot || shadowRoot.mode === 'closed') {\n                return null;\n            }\n        }\n        return shadowRoot;\n    },\n\n    // TODO: tests\n    closest: function closest(selectors) {\n        var element = this;\n\n        do {\n            if (element.matches(selectors)) {\n                return element;\n            }\n        } while (element = element.parentElement);\n    },\n\n\n    // TODO: tests\n    getElementsByTagName: function getElementsByTagName(qualifiedName) {\n        var results = elementGetElementsByTagNameDescriptor.value.call(this, qualifiedName);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    getElementsByTagNameNS: function getElementsByTagNameNS(ns, localName) {\n        var results = elementGetElementsByTagNameNSDescriptor.value.call(this, ns, localName);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    getElementsByClassName: function getElementsByClassName(names) {\n        var results = elementGetElementsByClassNameDescriptor.value.call(this, name);\n        return _dom2.default.filterByRoot(this, results);\n    },\n\n\n    // TODO: tests\n    insertAdjacentElement: function insertAdjacentElement(where, element) {\n        var _this8 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-element-insertadjacentelement\n            return _dom2.default.insertAdjacent(_this8, where, element);\n        });\n    },\n\n\n    // TODO: tests\n    insertAdjacentText: function insertAdjacentText(where, data) {\n        // https://dom.spec.whatwg.org/#dom-element-insertadjacenttext\n        var text = this.ownerDocument.createTextNode(data);\n        _dom2.default.insertAdjacent(this, where, text);\n        return;\n    },\n\n\n    // https://w3c.github.io/DOM-Parsing/#extensions-to-the-element-interface\n\n    // TODO: more thorough tests of the serialization\n    get innerHTML() {\n        // https://w3c.github.io/DOM-Parsing/#dom-element-innerhtml\n        return _dom2.default.serializeHTMLFragment(this);\n    },\n\n    // TODO: MutationObserver tests\n    set innerHTML(value) {\n        var _this9 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://w3c.github.io/DOM-Parsing/#dom-element-innerhtml\n            var fragment = _dom2.default.parseHTMLFragment(value, _this9);\n            var content = _this9['content'];\n            if (content instanceof DocumentFragment) {\n                _dom2.default.replaceAll(fragment, content);\n            } else {\n                _dom2.default.replaceAll(fragment, _this9);\n            }\n        });\n    },\n\n    // TODO: tests\n    get outerHTML() {\n        // https://w3c.github.io/DOM-Parsing/#dom-element-outerhtml\n        return _dom2.default.serializeHTMLFragment({ childNodes: [this] });\n    },\n\n    // TODO: tests\n    set outerHTML(value) {\n        var _this10 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://w3c.github.io/DOM-Parsing/#dom-element-outerhtml\n            var parent = _this10.parentNode;\n            if (parent === null) {\n                return;\n            }\n            if (parent.nodeType === Node.DOCUMENT_NODE) {\n                throw _utils2.default.makeDOMException('NoModificationAllowedError');\n            }\n            if (parent.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n                parent = _this10.ownerDocument.createElement('body');\n            }\n            var fragment = _dom2.default.parseHTMLFragment(value, parent);\n            _dom2.default.replace(_this10, fragment, _this10.parentNode);\n        });\n    },\n\n    // TODO: tests\n    insertAdjacentHTML: function insertAdjacentHTML(position, text) {\n        var _this11 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://w3c.github.io/DOM-Parsing/#dom-element-insertadjacenthtml\n            // We aren't going to go exactly by the books for this one.\n            var fragment = _dom2.default.parseHTMLFragment(text, _this11);\n            _dom2.default.insertAdjacent(_this11, position, fragment);\n        });\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.hasRelatedTarget = undefined;\nexports.default = $Event;\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-event\n\nfunction $Event(type, init) {\n    var bubbles = false;\n    var cancelable = false;\n    var composed = false;\n    if (init) {\n        bubbles = init.bubbles === true;\n        cancelable = init.cancelable === true;\n        composed = init.composed === true;\n    }\n    var event = document.createEvent('event');\n    event.initEvent(type, bubbles, cancelable);\n    _utils2.default.setShadowState(event, { composed: composed });\n    return event;\n}\n\n$Event.prototype = {\n\n    get currentTarget() {\n        return _utils2.default.getShadowState(this).currentTarget;\n    },\n\n    get target() {\n        return _utils2.default.getShadowState(this).target;\n    },\n\n    stopImmediatePropagation: function stopImmediatePropagation() {\n        this.stopPropagation();\n        _utils2.default.getShadowState(this).stopImmediatePropagationFlag = true;\n    },\n    composedPath: function composedPath() {\n        // https://dom.spec.whatwg.org/#dom-event-composedpath\n\n        // 1. Let composedPath be a new empty list.\n        var composedPath = [];\n\n        // 2. Let currentTarget be context object’s currentTarget attribute value.\n        var currentTarget = this.currentTarget;\n\n        // 3. For each tuple in context object’s path:\n        var path = _utils2.default.getShadowState(this).path;\n\n        if (path) {\n            var c = 0;\n            for (var i = 0; i < path.length; i++) {\n                var item = path[i][0];\n                if (currentTarget instanceof Window) {\n                    if (!(item instanceof Node) || !_dom2.default.closedShadowHidden(item, _dom2.default.shadowIncludingRoot(item))) {\n                        composedPath[c++] = item;\n                    }\n                } else if (currentTarget instanceof Node) {\n                    if (!_dom2.default.closedShadowHidden(item, currentTarget)) {\n                        composedPath[c++] = item;\n                    }\n                } else {\n                    composedPath[c++] = item;\n                }\n            }\n        }\n\n        // 4. return composedPath.\n        return composedPath;\n    },\n\n\n    get composed() {\n        // TODO: Compare against the actual prototype instead of just the type strings\n        return _utils2.default.getShadowState(this).composed || builtInComposedEvents.indexOf(this.type) !== -1;\n    }\n\n};\n\n// FocusEvent:\n// relatedTarget will be the element losing or gaining focus\n// MouseEvent:\n// relatedTarget will be the element being moved into or out of\nvar hasRelatedTarget = exports.hasRelatedTarget = {\n\n    get relatedTarget() {\n        return _utils2.default.getShadowState(this).relatedTarget;\n    }\n\n};\n\nvar builtInComposedEvents = [\n// FocusEvent\n'blur', 'focus', 'focusin', 'focusout',\n// MouseEvent\n'click', 'dblclick', 'mousedown', 'mouseenter', 'mouseleave', 'mousemove', 'mouseout', 'mouseover', 'mouseup',\n// WheelEvent\n'wheel',\n// InputEvent\n'beforeinput', 'input',\n// KeyboardEvent\n'keydown', 'keyup',\n// CompositionEvent\n'compositionstart', 'compositionupdate', 'compositionend',\n// Legacy UIEvent\n'DOMActivate',\n// Legacy FocusEvent\n'DOMFocusIn', 'DOMFocusOut',\n// Legacy KeyboardEvent\n'keypress'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    var native = {\n        addEventListener: base.prototype.addEventListener,\n        removeEventListener: base.prototype.removeEventListener,\n        dispatchEvent: base.prototype.dispatchEvent\n    };\n\n    return {\n        addEventListener: function addEventListener(type, callback, options) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            var listener = { callback: callback };\n            var capture = false;\n\n            if (typeof options === 'boolean') {\n                capture = options;\n            } else if (typeof options !== 'undefined') {\n                capture = options.capture === true;\n                listener.once = options.once === true;\n                // we don't do anything with passive.\n                listener.passive = options.passive === true;\n            }\n\n            var collection = EventListenerCollection.get(this, type, capture) || EventListenerCollection.create(this, type, capture);\n\n            collection.addListener(this, listener);\n            collection.attach(native.addEventListener);\n        },\n        removeEventListener: function removeEventListener(type, callback, options) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            var listener = { callback: callback };\n            var capture = false;\n\n            if (typeof options === 'boolean') {\n                capture = options;\n            } else if (typeof options !== 'undefined') {\n                capture = options.capture === true;\n            }\n\n            var collection = EventListenerCollection.get(this, type, capture);\n\n            if (!collection) {\n                return;\n            }\n\n            collection.removeListener(this, listener);\n\n            if (collection.empty) {\n                collection.detach(native.removeEventListener);\n            }\n        }\n    };\n};\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-eventtarget\n\nvar eventTargetDescriptor = _utils2.default.descriptor(Event, 'target');\nvar focusEventRelatedTargetDescriptor = _utils2.default.descriptor(FocusEvent, 'relatedTarget');\nvar mouseEventRelatedTargetDescriptor = _utils2.default.descriptor(MouseEvent, 'relatedTarget');\n\nvar EventListenerCollection = function EventListenerCollection(target, type, capture) {\n    var _this = this;\n\n    this.target = target;\n    this.type = type;\n    this.capture = capture;\n\n    this.hostListeners = [];\n    this.shadowListeners = [];\n\n    this.callback = function (event) {\n        var shadowRoot = null;\n        var targetState = _utils2.default.getShadowState(target);\n        if (targetState) {\n            shadowRoot = targetState.shadowRoot;\n        }\n        switch (event.eventPhase) {\n            case Event.prototype.CAPTURING_PHASE:\n                _this.invokeListeners(event, _this.target, _this.hostListeners);\n                if (shadowRoot) {\n                    _this.invokeListeners(event, shadowRoot, _this.shadowListeners);\n                }\n                break;\n            case Event.prototype.AT_TARGET:\n                var nativeTarget = eventTargetDescriptor.get.call(event);\n                _this.invokeListeners(event, nativeTarget, _this.getListeners(nativeTarget));\n                break;\n            case Event.prototype.BUBBLING_PHASE:\n                if (shadowRoot) {\n                    _this.invokeListeners(event, shadowRoot, _this.shadowListeners);\n                }\n                _this.invokeListeners(event, _this.target, _this.hostListeners);\n                break;\n        }\n    };\n};\n\nEventListenerCollection.get = function (target, type, capture) {\n    var targetState = _utils2.default.getShadowState(target);\n    var nativeTarget = target;\n    var nativeTargetState = targetState;\n    if (targetState && targetState.host) {\n        nativeTarget = targetState.host;\n        nativeTargetState = _utils2.default.getShadowState(nativeTarget);\n    }\n    if (!nativeTargetState || !nativeTargetState.listeners) {\n        return null;\n    }\n    var collections = nativeTargetState.listeners;\n    for (var i = 0; i < collections.length; i++) {\n        var collection = collections[i];\n        if (collection.target === nativeTarget && collection.type === type && collection.capture === capture) {\n            return collection;\n        }\n    }\n    return null;\n};\n\nEventListenerCollection.create = function (target, type, capture) {\n    var targetState = _utils2.default.getShadowState(target);\n    var nativeTarget = target;\n    var nativeTargetState = targetState;\n    if (targetState && targetState.host) {\n        nativeTarget = targetState.host;\n        nativeTargetState = _utils2.default.getShadowState(nativeTarget);\n    }\n    if (!nativeTargetState) {\n        nativeTargetState = _utils2.default.setShadowState(nativeTarget, { listeners: [] });\n    } else if (!nativeTargetState.listeners) {\n        nativeTargetState.listeners = [];\n    }\n    var collection = new EventListenerCollection(nativeTarget, type, capture);\n    nativeTargetState.listeners.push(collection);\n    return collection;\n};\n\nEventListenerCollection.prototype = {\n\n    get empty() {\n        return this.hostListeners.length === 0 && this.shadowListeners.length === 0;\n    },\n\n    getListeners: function getListeners(target) {\n        var targetState = _utils2.default.getShadowState(target);\n        if (targetState && targetState.host) {\n            return this.shadowListeners;\n        }\n        return this.hostListeners;\n    },\n    addListener: function addListener(target, listener) {\n        var listeners = this.getListeners(target);\n\n        for (var i = 0; i < listeners.length; i++) {\n            if (listener.callback === listeners[i].callback) {\n                return;\n            }\n        }\n\n        listeners.push(listener);\n    },\n    removeListener: function removeListener(target, listener) {\n        var listeners = this.getListeners(target);\n\n        for (var i = 0; i < listeners.length; i++) {\n            var other = listeners[i];\n            if (listener.callback === other.callback) {\n                listeners.splice(i, 1);\n                break;\n            }\n        }\n    },\n    invokeListeners: function invokeListeners(event, currentTarget, listeners) {\n        var eventState = _utils2.default.getShadowState(event) || _utils2.default.setShadowState(event, {});\n        var path = eventState.calculatedPath;\n        if (!path) {\n            path = eventState.calculatedPath = calculatePath(event);\n        }\n        // if there is no target, the event is not composed and should be stopped\n        var target = calculateTarget(currentTarget, path);\n        if (!target) {\n            event.stopImmediatePropagation();\n        } else {\n            var relatedTarget = calculateRelatedTarget(currentTarget, path);\n            var remove = void 0;\n\n            eventState.path = path;\n            eventState.currentTarget = currentTarget;\n            eventState.target = target;\n            eventState.relatedTarget = relatedTarget;\n\n            for (var i = 0; i < listeners.length; i++) {\n                var listener = listeners[i];\n                var result = listener.callback.call(currentTarget, event);\n                if (listener.once) {\n                    if (!remove) {\n                        remove = [listener];\n                    } else {\n                        remove.push[listener];\n                    }\n                }\n                if (eventState.stopImmediatePropagationFlag) {\n                    break;\n                }\n            }\n\n            eventState.path = null;\n            eventState.currentTarget = null;\n\n            if (remove) {\n                for (var _i = 0; _i < remove.length; _i++) {\n                    var index = listeners.indexOf(remove[_i]);\n                    listeners.splice(index, 1);\n                }\n            }\n        }\n    },\n    attach: function attach(descriptor) {\n        descriptor.call(this.target, this.type, this.callback, this.capture);\n    },\n    detach: function detach(descriptor) {\n        descriptor.call(this.target, this.type, this.callback, this.capture);\n    }\n};\n\nfunction calculatePath(event) {\n    // https://dom.spec.whatwg.org/#concept-event-dispatch\n\n    var path = [];\n    var p = 0;\n\n    var target = eventTargetDescriptor.get.call(event);\n\n    var relatedTargetDescriptor = null;\n\n    if (event instanceof FocusEvent) {\n        relatedTargetDescriptor = focusEventRelatedTargetDescriptor;\n    } else if (event instanceof MouseEvent) {\n        relatedTargetDescriptor = mouseEventRelatedTargetDescriptor;\n    }\n\n    // 1. Set event’s dispatch flag.\n    // SKIP: native\n\n    // 2. Let targetOverride be target, if legacy target override flag is \n    // not given, and target’s associated Document otherwise. \n    var targetOverride = target;\n\n    // 3. Let relatedTarget be the result of retargeting event’s relatedTarget \n    // against target if event’s relatedTarget is non-null, and null otherwise.\n    var originalRelatedTarget = null;\n    var relatedTarget = null;\n    if (relatedTargetDescriptor) {\n        originalRelatedTarget = relatedTargetDescriptor.get.call(event);\n        if (originalRelatedTarget) {\n            relatedTarget = _dom2.default.retarget(originalRelatedTarget, target);\n        }\n    }\n\n    // 4. If target is relatedTarget and target is not event’s relatedTarget, then return true.\n    // SKIP: native\n\n    // 5. Append (target, targetOverride, relatedTarget) to event’s path.\n    path[p++] = [target, targetOverride, relatedTarget];\n\n    // 6. Let isActivationEvent be true, if event is a MouseEvent object and \n    // event’s type attribute is \"click\", and false otherwise.\n    // SKIP: native\n\n    // 7. Let activationTarget be target, if isActivationEvent is true and \n    // target has activation behavior, and null otherwise.\n    // SKIP: native\n\n    // 8. Let parent be the result of invoking target’s get the parent with event.\n    var parent = getTheParent(target, event, path);\n\n    // 9. While parent is non-null:\n    while (parent != null) {\n        // 1. Let relatedTarget be the result of retargeting event’s relatedTarget\n        // against parent if event’s relatedTarget is non-null, and null otherwise.\n        if (originalRelatedTarget) {\n            relatedTarget = _dom2.default.retarget(originalRelatedTarget, parent);\n        }\n        // 2. If target’s root is a shadow-including inclusive ancestor of parent, then... \n        // append (parent, null, relatedTarget) to event’s path.\n        if (_dom2.default.shadowIncludingInclusiveAncestor(_dom2.default.root(target), parent)) {\n            path[p++] = [parent, null, relatedTarget];\n            parent = getTheParent(parent, event, path);\n            continue;\n        }\n        // 3. Otherwise, if parent and relatedTarget are identical, then set parent to null.\n        else if (parent === relatedTarget) {\n                break;\n            }\n            // 4. Otherwise, set target to parent and then... \n            // append (parent, target, relatedTarget) to event’s path.\n            else {\n                    target = parent;\n                    path[p++] = [parent, target, relatedTarget];\n                    parent = getTheParent(parent, event, path);\n                    continue;\n                }\n        // 5. If parent is non-null, then set parent to the result of \n        // invoking parent’s get the parent with event.\n        // NOTE: This step was duplicated above to save some cycles.\n    }\n\n    return path;\n}\n\nfunction getTheParent(node, event, path) {\n    // https://dom.spec.whatwg.org/#get-the-parent\n    // Each EventTarget object also has an associated get the parent \n    // algorithm, which takes an event event, and returns an EventTarget \n    // object. Unless specified otherwise it returns null.\n\n    // A node’s get the parent algorithm, given an event, \n    // returns the node’s assigned slot, if node is assigned, \n    // and node’s parent otherwise.\n\n    // A document’s get the parent algorithm, given an event, returns null if event’s \n    // type attribute value is \"load\" or document does not have a browsing context, \n    // and the document’s associated Window object otherwise.\n\n    // A shadow root’s get the parent algorithm, given an event, returns null if \n    // event’s composed flag is unset and shadow root is the root of event’s \n    // path’s first tuple’s item, and shadow root’s host otherwise.\n\n    if (node instanceof Node) {\n        if (node.nodeType === Node.DOCUMENT_NODE) {\n            if (event.type === 'load') {\n                // or browsing context?\n                return null;\n            }\n            return node.defaultView;\n        } else if (_dom2.default.isShadowRoot(node)) {\n            if (!event.composed) {\n                var item = path[0][0];\n                if (_dom2.default.root(item) === node) {\n                    return null;\n                }\n            }\n            return node.host;\n        }\n        return node.assignedSlot || node.parentNode;\n    }\n\n    return null;\n}\n\nfunction calculateRelatedTarget(currentTarget, path) {\n    for (var i = 0; i < path.length; i++) {\n        var item = path[i][0];\n        var relatedTarget = path[i][2];\n        if (item === currentTarget) {\n            return relatedTarget;\n        }\n    }\n    return null;\n}\n\nfunction calculateTarget(currentTarget, path) {\n    for (var i = 0; i < path.length; i++) {\n        var item = path[i][0];\n        if (item === currentTarget) {\n            for (var j = i; j >= 0; j--) {\n                var target = path[j][1];\n                if (target != null) {\n                    return target;\n                }\n            }\n            return null;\n        }\n    }\n    return null;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://html.spec.whatwg.org/multipage/scripting.html#the-slot-element\n\nexports.default = {\n\n    // TODO: tests\n    get name() {\n        if (this.localName !== 'slot') {\n            return;\n        }\n\n        return this.getAttribute('name') || '';\n    },\n\n    // TODO: tests\n    set name(value) {\n        if (this.localName !== 'slot') {\n            return;\n        }\n\n        _dom2.default.setAttributeValue(this, 'name', value);\n    },\n\n    // TODO: tests\n    assignedNodes: function assignedNodes(options) {\n        if (this.localName !== 'slot') {\n            return;\n        }\n\n        // https://html.spec.whatwg.org/multipage/scripting.html#dom-slot-assignednodes\n        // The assignedNodes(options) method, when invoked, must run these steps:\n\n        // 1. If the value of options's flatten member is false, then return this element's assigned nodes.\n        if (!options || options.flatten !== true) {\n            var assignedNodes = null;\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                assignedNodes = shadowState.assignedNodes;\n            }\n            return assignedNodes || [];\n        }\n\n        // 2. Return the result of finding flattened slotables with this element.\n        return _dom2.default.findFlattenedSlotables(this);\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://www.w3.org/TR/html5/single-page.html#the-table-element\n\nexports.default = {\n\n    // TODO: tests\n    deleteCaption: function deleteCaption() {\n        var caption = this.caption;\n        if (caption) {\n            _dom2.default.remove(caption, this);\n        }\n    },\n\n\n    // TODO: tests\n    deleteTHead: function deleteTHead() {\n        var tHead = this.tHead;\n        if (tHead) {\n            _dom2.default.remove(tHead, this);\n        }\n    },\n\n\n    // TODO: tests\n    deleteTFoot: function deleteTFoot() {\n        var tFoot = this.tFoot;\n        if (tFoot) {\n            _dom2.default.remove(tFoot, this);\n        }\n    },\n\n\n    // TODO: tests\n    deleteRow: function deleteRow(index) {\n        // https://www.w3.org/TR/html5/single-page.html#dom-table-deleterow\n        if (index === -1) {\n            index = this.rows.length - 1;\n        }\n        if (index < 0 || index >= this.rows.length) {\n            throw _utils2.default.makeDOMException('IndexSizeError');\n        }\n        this.rows[index].remove();\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    // TODO: tests\n    deleteCell: function deleteCell(index) {\n        // https://www.w3.org/TR/html5/single-page.html#dom-tr-deletecell\n        if (index === -1) {\n            index = this.cells.length - 1;\n        }\n        if (index < 0 || index >= this.cells.length) {\n            throw _utils2.default.makeDOMException('IndexSizeError');\n        }\n        this.cells[index].remove();\n    }\n}; // https://www.w3.org/TR/html5/single-page.html#the-tr-element","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    // TODO: tests\n    deleteRow: function deleteRow(index) {\n        // https://www.w3.org/TR/html5/single-page.html#dom-tbody-deleterow\n        if (index < 0 || index >= this.rows.length) {\n            throw _utils2.default.makeDOMException('IndexSizeError');\n        }\n        this.rows[index].remove();\n    }\n}; // https://www.w3.org/TR/html5/single-page.html#the-tbody-element","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = $MutationObserver;\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-mutationobserver\n\nfunction $MutationObserver(callback) {\n    var observer = _dom2.default.createMutationObserver(callback);\n    _utils2.default.setShadowState(this, { observer: observer });\n    observer.interface = this;\n}\n\n$MutationObserver.prototype = {\n    observe: function observe(target, options) {\n        _utils2.default.getShadowState(this).observer.observe(target, options);\n    },\n    disconnect: function disconnect() {\n        _utils2.default.getShadowState(this).observer.disconnect();\n    },\n    takeRecords: function takeRecords() {\n        var records = _utils2.default.getShadowState(this).observer.queue;\n        return records.splice(0, records.length);\n    }\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    // TODO: tests\n    setNamedItem: function setNamedItem(attr) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var shadowState = _utils2.default.getShadowState(_this);\n            return _dom2.default.setAttribute(attr, shadowState.element);\n        });\n    },\n\n\n    // TODO: tests\n    setNamedItemNS: function setNamedItemNS(attr) {\n        var _this2 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var shadowState = _utils2.default.getShadowState(_this2);\n            return _dom2.default.setAttribute(attr, shadowState.element);\n        });\n    },\n\n\n    // TODO: tests\n    removeNamedItem: function removeNamedItem(qualifiedName) {\n        var _this3 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var shadowState = _utils2.default.getShadowState(_this3);\n            var attr = _dom2.default.removeAttributeByName(qualifiedName, shadowState.element);\n            if (!attr) {\n                throw _utils2.default.makeDOMException('NotFoundError');\n            }\n            return attr;\n        });\n    },\n\n\n    // TODO: tests\n    removeNamedItemNS: function removeNamedItemNS(nameSpace, localName) {\n        var _this4 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var shadowState = _utils2.default.getShadowState(_this4);\n            var attr = _dom2.default.removeAttributeByNamespace(nameSpace, localName, shadowState.element);\n            if (!attr) {\n                throw _utils2.default.makeDOMException('NotFoundError');\n            }\n            return attr;\n        });\n    }\n}; // https://dom.spec.whatwg.org/#interface-namednodemap","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar attrValueDescriptor = _utils2.default.descriptor(Attr, 'value'); // https://dom.spec.whatwg.org/#interface-node\n\nvar characterDataDataDescriptor = _utils2.default.descriptor(CharacterData, 'data');\nvar elementAttributesDescriptor = _utils2.default.descriptor(Element, 'attributes') || _utils2.default.descriptor(Node, 'attributes');\nvar nodeChildNodesDescriptor = _utils2.default.descriptor(Node, 'childNodes');\nvar nodeHasChildNodesDescriptor = _utils2.default.descriptor(Node, 'hasChildNodes');\nvar nodeFirstChildDescriptor = _utils2.default.descriptor(Node, 'firstChild');\nvar nodeLastChildDescriptor = _utils2.default.descriptor(Node, 'lastChild');\nvar nodePreviousSiblingDescriptor = _utils2.default.descriptor(Node, 'previousSibling');\nvar nodeNextSiblingDescriptor = _utils2.default.descriptor(Node, 'nextSibling');\nvar nodeParentNodeDescriptor = _utils2.default.descriptor(Node, 'parentNode');\nvar nodeNodeValueDescriptor = _utils2.default.descriptor(Node, 'nodeValue');\n\nexports.default = {\n\n    get isConnected() {\n        return _dom2.default.shadowIncludingRoot(this).nodeType === Node.DOCUMENT_NODE;\n    },\n\n    getRootNode: function getRootNode(options) {\n        var composed = options && options.composed === true;\n        return composed ? _dom2.default.shadowIncludingRoot(this) : _dom2.default.root(this);\n    },\n\n\n    get parentNode() {\n        var parentNode = void 0;\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            parentNode = nodeState.parentNode;\n        }\n\n        return parentNode || nodeParentNodeDescriptor.get.call(this);\n    },\n\n    get parentElement() {\n        var parentNode = this.parentNode;\n        if (parentNode && parentNode.nodeType === Node.ELEMENT_NODE) {\n            return parentNode;\n        }\n\n        return null;\n    },\n\n    // TODO: tests\n    hasChildNodes: function hasChildNodes() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var childNodes = nodeState.childNodes;\n            if (childNodes) {\n                return childNodes.length > 0;\n            }\n        }\n\n        return nodeHasChildNodesDescriptor.value.call(this);\n    },\n\n\n    // TODO: tests\n    get childNodes() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var childNodes = nodeState.childNodes;\n            if (childNodes) {\n                var childNodesLength = childNodes.length;\n                var result = new Array(childNodesLength);\n                for (var i = 0; i < childNodesLength; i++) {\n                    result[i] = childNodes[i];\n                }\n                return result;\n            }\n        }\n\n        return nodeChildNodesDescriptor.get.call(this);\n    },\n\n    // TODO: tests\n    get firstChild() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var childNodes = nodeState.childNodes;\n            if (childNodes) {\n                if (childNodes.length) {\n                    return childNodes[0];\n                }\n                return null;\n            }\n        }\n\n        return nodeFirstChildDescriptor.get.call(this);\n    },\n\n    // TODO: tests\n    get lastChild() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var childNodes = nodeState.childNodes;\n            if (childNodes) {\n                if (childNodes.length) {\n                    return childNodes[childNodes.length - 1];\n                }\n                return null;\n            }\n        }\n\n        return nodeLastChildDescriptor.get.call(this);\n    },\n\n    // TODO: tests\n    get previousSibling() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var parentNode = nodeState.parentNode;\n            if (parentNode) {\n                var childNodes = _utils2.default.getShadowState(parentNode).childNodes;\n                var siblingIndex = childNodes.indexOf(this) - 1;\n                return siblingIndex < 0 ? null : childNodes[siblingIndex];\n            }\n        }\n\n        return nodePreviousSiblingDescriptor.get.call(this);\n    },\n\n    // TODO: tests\n    get nextSibling() {\n        var nodeState = _utils2.default.getShadowState(this);\n        if (nodeState) {\n            var parentNode = nodeState.parentNode;\n            if (parentNode) {\n                var childNodes = _utils2.default.getShadowState(parentNode).childNodes;\n                var siblingIndex = childNodes.indexOf(this) + 1;\n                return siblingIndex === childNodes.length ? null : childNodes[siblingIndex];\n            }\n        }\n\n        return nodeNextSiblingDescriptor.get.call(this);\n    },\n\n    // TODO: consider creating a raw property descriptor\n    // that uses the native get instead of a pass-through function\n    get nodeValue() {\n        return nodeNodeValueDescriptor.get.call(this);\n    },\n\n    // TODO: MutationObserver tests\n    set nodeValue(value) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            switch (_this.nodeType) {\n                case Node.ATTRIBUTE_NODE:\n                    _dom2.default.setExistingAttributeValue(_this, value);\n                    break;\n                case Node.TEXT_NODE:\n                case Node.PROCESSING_INSTRUCTION_NODE:\n                case Node.COMMENT_NODE:\n                    var length = characterDataDataDescriptor.get.call(_this).length;\n                    _dom2.default.replaceData(_this, 0, length, value);\n                    break;\n            }\n        });\n    },\n\n    get textContent() {\n        switch (this.nodeType) {\n            case Node.DOCUMENT_FRAGMENT_NODE:\n            case Node.ELEMENT_NODE:\n                return elementTextContent(this);\n            case Node.ATTRIBUTE_NODE:\n                return attrValueDescriptor.get.call(this);\n            case Node.TEXT_NODE:\n            case Node.PROCESSING_INSTRUCTION_NODE:\n            case Node.COMMENT_NODE:\n                return characterDataDataDescriptor.get.call(this);\n            default:\n                return null;\n        }\n    },\n\n    // TODO: MutationObserver tests\n    set textContent(value) {\n        var _this2 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            switch (_this2.nodeType) {\n                case Node.DOCUMENT_FRAGMENT_NODE:\n                case Node.ELEMENT_NODE:\n                    var node = null;\n                    if (value !== '') {\n                        node = _this2.ownerDocument.createTextNode(value);\n                    }\n                    _dom2.default.replaceAll(node, _this2);\n                    break;\n                case Node.ATTRIBUTE_NODE:\n                    _dom2.default.setExistingAttributeValue(_this2, value);\n                    break;\n                case Node.TEXT_NODE:\n                case Node.PROCESSING_INSTRUCTION_NODE:\n                case Node.COMMENT_NODE:\n                    _dom2.default.replaceData(_this2, 0, _this2.data.length, value);\n                    break;\n            }\n        });\n    },\n\n    // TODO: tests\n    normalize: function normalize() {\n        var _this3 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-normalize\n            // The normalize() method, when invoked, must run these steps \n            // for each descendant exclusive Text node node of context object:\n            var childNodes = _this3.childNodes;\n            for (var i = 0; i < childNodes.length; i++) {\n                var childNode = childNodes[i];\n                if (childNode.nodeType === Node.TEXT_NODE) {\n                    var length = characterDataDataDescriptor.get.call(childNode).length;\n                    if (length === 0) {\n                        _dom2.default.remove(childNode, _this3);\n                        continue;\n                    }\n                    var data = '';\n                    var contiguousTextNodes = new Array(childNodes.length);\n                    var contiguousCount = 0;\n                    var next = childNode;\n                    while (next = next.nextSibling && next.nodeType === Node.TEXT_NODE) {\n                        data += characterDataDataDescriptor.get.call(next);\n                        contiguousTextNodes[contiguousCount++] = next;\n                    }\n                    _dom2.default.replaceData(childNode, length, 0, data);\n                    // TODO: (Range)\n                    for (var j = 0; j < contiguousCount; j++) {\n                        _dom2.default.remove(contiguousTextNodes[j], _this3);\n                    }\n                } else {\n                    childNode.normalize();\n                }\n            }\n        });\n    },\n\n\n    // TODO: tests\n    cloneNode: function cloneNode(deep) {\n        var _this4 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-clonenode\n            // The cloneNode(deep) method, when invoked, must run these steps:\n\n            // 1. If context object is a shadow root, then throw a NotSupportedError.\n            if (_dom2.default.isShadowRoot(_this4)) {\n                throw _utils2.default.makeDOMException('NotSupportedError');\n            }\n\n            // 2. Return a clone of the context object, with the clone children flag set if deep is true.\n            return _dom2.default.clone(_this4, undefined, deep);\n        });\n    },\n\n\n    // TODO: tests\n    isEqualNode: function isEqualNode(other) {\n        // https://dom.spec.whatwg.org/#dom-node-isequalnode\n        // https://dom.spec.whatwg.org/#concept-node-equals\n        if (!other) {\n            return false;\n        }\n\n        if (this.nodeType !== other.nodeType) {\n            return false;\n        }\n\n        var thisAttributes = void 0;\n        var otherAttributes = void 0;\n\n        switch (this.nodeType) {\n            case Node.DOCUMENT_TYPE_NODE:\n                if (this.name !== other.name || this.publicId !== other.publicId || this.systemId !== other.systemId) {\n                    return false;\n                }\n                break;\n            case Node.ELEMENT_NODE:\n                if (this.namespaceURI !== other.namespaceURI || this.prefix !== other.prefix || this.localName !== other.localName) {\n                    return false;\n                }\n                thisAttributes = elementAttributesDescriptor.get.call(this);\n                otherAttributes = elementAttributesDescriptor.get.call(other);\n                if (thisAttributes.length != otherAttributes.length) {\n                    return false;\n                }\n                break;\n            case Node.ATTRIBUTE_NODE:\n                if (this.namespaceURI !== other.namespaceURI || this.localName !== other.localName || this.value !== other.value) {\n                    return false;\n                }\n                break;\n            case Node.PROCESSING_INSTRUCTION_NODE:\n                if (this.target !== other.target || this.data !== other.data) {\n                    return false;\n                }\n                break;\n            case Node.TEXT_NODE:\n            case Node.COMMENT_NODE:\n                if (this.data !== other.data) {\n                    return false;\n                }\n                break;\n        }\n\n        if (this.nodeType == Node.ELEMENT_NODE) {\n            for (var i = 0; i < thisAttributes.length; i++) {\n                var attr1 = thisAttributes[i];\n                var attr2 = otherAttributes[attr1.name];\n                if (attr1.value !== attr2.value) {\n                    return false;\n                }\n            }\n        }\n\n        var childNodes1 = this.childNodes;\n        var childNodes2 = other.childNodes;\n        if (childNodes1.length !== other.childNodes.length) {\n            return false;\n        }\n\n        for (var _i = 0; _i < childNodes1.length; _i++) {\n            if (!childNodes1[_i].isEqualNode(childNodes2[_i])) {\n                return false;\n            }\n        }\n\n        return true;\n    },\n\n\n    // TODO: tests\n    compareDocumentPosition: function compareDocumentPosition(other) {\n        // https://dom.spec.whatwg.org/#dom-node-comparedocumentposition\n\n        if (this === other) {\n            return 0;\n        }\n\n        var node1 = other;\n        var node2 = this;\n        var attr1 = null;\n        var attr2 = null;\n\n        if (node1.nodeType == Document.prototype.ATTRIBUTE_NODE) {\n            attr1 = node1;\n            node1 = attr1.ownerElement;\n        }\n\n        if (node2.nodeType == Document.prototype.ATTRIBUTE_NODE) {\n            attr2 = node2;\n            node2 = attr2.ownerElement;\n\n            if (attr1 && node1 && node2 === node1) {\n                var attrs = node2.atttributes;\n                for (var i = 0; i < attrs.length; i++) {\n                    var attr = attrs[i];\n                    if (attr.isEqualNode(attr1)) {\n                        return Document.prototype.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC + Document.prototype.DOCUMENT_POSITION_PRECEDING;\n                    } else if (attr.isEqualNode(attr2)) {\n                        return Document.prototype.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC + Document.prototype.DOCUMENT_POSITION_FOLLOWING;\n                    }\n                }\n            }\n        }\n\n        if (!node1 || !node2 || _dom2.default.root(node1) !== _dom2.default.root(node2)) {\n            return Document.prototype.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC + Document.prototype.DOCUMENT_POSITION_FOLLOWING + Document.prototype.DOCUMENT_POSITION_DISCONNECTED;\n        }\n\n        if (ancestorOf(node2, node1) || node1 === node2 && attr2) {\n            return Document.prototype.DOCUMENT_POSITION_CONTAINS + Document.prototype.DOCUMENT_POSITION_PRECEDING;\n        }\n\n        if (ancestorOf(node1, node2) || node1 === node2 && attr1) {\n            return Document.prototype.DOCUMENT_POSITION_CONTAINS + Document.prototype.DOCUMENT_POSITION_FOLLOWING;\n        }\n\n        if (preceding(node1, node2)) {\n            return Document.prototype.DOCUMENT_POSITION_PRECEDING;\n        }\n\n        return Document.prototype.DOCUMENT_POSITION_FOLLOWING;\n    },\n\n\n    // TODO: tests\n    contains: function contains(node) {\n        // https://dom.spec.whatwg.org/#dom-node-contains\n\n        var parent = node.parentNode;\n\n        if (!parent) {\n            return false;\n        }\n\n        do {\n            if (parent === this) {\n                return true;\n            }\n        } while (parent = parent.parentNode);\n\n        return false;\n    },\n\n\n    // TODO: tests\n    insertBefore: function insertBefore(node, child) {\n        var _this5 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-insertbefore\n            // The insertBefore(node, child) method, when invoked, must return the result \n            // of pre-inserting node into context object before child.\n            return _dom2.default.preInsert(node, _this5, child);\n        });\n    },\n\n\n    // TODO: tests\n    appendChild: function appendChild(node) {\n        var _this6 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-appendchild\n            // The appendChild(node) method, when invoked, must return the result of \n            // appending node to context object.\n            return _dom2.default.append(node, _this6);\n        });\n    },\n\n\n    // TODO: tests\n    replaceChild: function replaceChild(node, child) {\n        var _this7 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-replacechild\n            // The replaceChild(node, child) method, when invoked, must return the \n            // result of replacing child with node within context object.\n            return _dom2.default.replace(child, node, _this7);\n        });\n    },\n\n\n    // TODO: tests\n    removeChild: function removeChild(child) {\n        var _this8 = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            // https://dom.spec.whatwg.org/#dom-node-removechild\n            // The removeChild(child) method, when invoked, must return the result of \n            // pre-removing child from context object.\n            return _dom2.default.preRemove(child, _this8);\n        });\n    }\n};\n\n\nfunction ancestorOf(node, ancestor) {\n    var parent = node.parentNode;\n\n    do {\n        if (parent === ancestor) {\n            return true;\n        }\n    } while (parent = parent.parentNode);\n\n    return false;\n}\n\nfunction preceding(element1, element2) {\n    function precedingSiblings(parent, sibling1, sibling2) {\n        var siblings = parent.childNodes;\n        for (var _i2 = 0; _i2 < siblings.length; _i2++) {\n            var sibling = siblings[_i2];\n            if (sibling === sibling1) {\n                return true;\n            } else if (sibling === sibling2) {\n                return false;\n            }\n        }\n    }\n\n    // Check if they're already siblings.\n    var ancestor1 = element1.parentNode;\n    var ancestor2 = element2.parentNode;\n\n    if (ancestor1 === ancestor2) {\n        return precedingSiblings(element1, element2);\n    }\n\n    // Find the closest common ancestor.\n    var ancestors1 = [ancestor1];\n    var ancestors2 = [ancestor2];\n\n    while (ancestor1 = ancestor1.parentNode) {\n        ancestors1.push(ancestor1);\n    }\n\n    while (ancestor2 = ancestor2.parentNode) {\n        ancestors2.push(ancestor2);\n    }\n\n    ancestors1.reverse();\n    ancestors2.reverse();\n\n    var diff = Math.abs(ancestors1.length - ancestors2.length);\n    var min = Math.min(ancestors1.length, ancestors2.length);\n\n    var i = 0;\n    while (ancestors1[i] === ancestors2[i]) {\n        i++;\n    }\n\n    return precedingSiblings(ancestors1[i - 1], ancestors1[i], ancestors2[i]);\n}\n\nfunction elementTextContent(element) {\n    var result = '';\n    var childNodes = element.childNodes;\n    for (var i = 0; i < childNodes.length; i++) {\n        var childNode = childNodes[i];\n        switch (childNode.nodeType) {\n            case Node.ELEMENT_NODE:\n                result += elementTextContent(childNode);\n                break;\n            case Node.TEXT_NODE:\n                result += characterDataDataDescriptor.get.call(childNode);\n                break;\n        }\n    }\n    return result;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    get nodeName() {\n        return '#shadow-root';\n    },\n\n    get mode() {\n        return _utils2.default.getShadowState(this).mode;\n    },\n\n    get host() {\n        return _utils2.default.getShadowState(this).host;\n    },\n\n    // TODO: tests\n    get innerHTML() {\n        return _dom2.default.serializeHTMLFragment(this);\n    },\n\n    // TODO: tests\n    set innerHTML(value) {\n        var _this = this;\n\n        return _customElements2.default.executeCEReactions(function () {\n            var fragment = _dom2.default.parseHTMLFragment(value, _this);\n            _dom2.default.replaceAll(fragment, _this);\n        });\n    }\n\n}; // https://dom.spec.whatwg.org/#interface-shadowroot\n// https://www.w3.org/TR/shadow-dom/#the-shadowroot-interface","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// https://dom.spec.whatwg.org/#interface-text\n\nexports.default = {\n\n    // TODO: tests\n    splitText: function splitText(offset) {\n        var length = this.length;\n        if (offset > length) {\n            throw _utils2.default.makeDOMException('IndexSizeError');\n        }\n        var count = length - offset;\n        var newData = this.data.slice(offset, count);\n        var newNode = this.ownerDocument.createTextNode(newData);\n        var parent = this.parentNode;\n        if (parent) {\n            _dom2.default.insert(newNode, parent, this.nextSibling);\n            // TODO: (Range)\n        }\n        _dom2.default.replaceData(this, offset, count, '');\n        // TODO: (Range)\n        // if (!parent) { }\n        return newNode;\n    }\n};","'use strict';\n\nvar _shadowDom = require('./shadow-dom.js');\n\nvar _shadowDom2 = _interopRequireDefault(_shadowDom);\n\nvar _customElements = require('./custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar installShadowDom = false;\nvar installCustomElements = false;\n\nif (window['forceShadowDomPolyfill'] || !_shadowDom2.default.nativeSupport) {\n    installShadowDom = true;\n}\n\nif (window['forceCustomElementsPolyfill'] || !_customElements2.default.nativeSupport) {\n    installShadowDom = true;\n    installCustomElements = true;\n}\n\nif (installShadowDom) {\n    _shadowDom2.default.install();\n    window.shadowDomPolyfilled = true;\n}\n\nif (installCustomElements) {\n    _customElements2.default.install();\n    window.customElementsPolyfilled = true;\n} else {\n    // TODO: Offer a way to opt out if desired\n    _customElements2.default.installTranspiledClassSupport();\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    return {\n\n        // TODO: tests\n        before: function before() {\n            var _this = this;\n\n            for (var _len = arguments.length, nodes = Array(_len), _key = 0; _key < _len; _key++) {\n                nodes[_key] = arguments[_key];\n            }\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-childnode-before\n                // The before(nodes) method, when invoked, must run these steps:\n\n                // 1. Let parent be context object’s parent.\n                var parent = _this.parentNode;\n\n                // 2. If parent is null, terminate these steps.\n                if (!parent) {\n                    return;\n                }\n\n                // 3. Let viablePreviousSibling be context object’s first preceding \n                // sibling not in nodes, and null otherwise.\n                var viablePreviousSibling = _this.previousSibling;\n                while (viablePreviousSibling && nodes.indexOf(viablePreviousSibling) !== -1) {\n                    viablePreviousSibling = viablePreviousSibling.previousSibling;\n                }\n\n                // 4. Let node be the result of converting nodes into a node, given \n                // nodes and context object’s node document. Rethrow any exceptions.\n                var node = _dom2.default.convertNodesIntoANode(nodes, _this.ownerDocument);\n\n                // 5. If viablePreviousSibling is null, set it to parent’s first child, \n                // and to viablePreviousSibling’s next sibling otherwise.\n                if (viablePreviousSibling === null) {\n                    viablePreviousSibling = parent.firstChild;\n                } else {\n                    viablePreviousSibling = viablePreviousSibling.nextSibling;\n                }\n\n                // 6. Pre-insert node into parent before viablePreviousSibling. \n                // Rethrow any exceptions.\n                _dom2.default.preInsert(node, parent, viablePreviousSibling);\n            });\n        },\n\n\n        // TODO: tests\n        after: function after() {\n            var _this2 = this;\n\n            for (var _len2 = arguments.length, nodes = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                nodes[_key2] = arguments[_key2];\n            }\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-childnode-after\n                // The after(nodes) method, when invoked, must run these steps:\n\n                // 1. Let parent be context object’s parent.\n                var parent = _this2.parentNode;\n\n                // 2. If parent is null, terminate these steps.\n                if (!parent) {\n                    return;\n                }\n\n                // 3. Let viableNextSibling be context object’s first following \n                // sibling not in nodes, and null otherwise.\n                var viableNextSibling = _this2.nextSibling;\n                while (viableNextSibling && nodes.indexOf(viableNextSibling) !== -1) {\n                    viableNextSibling = viableNextSibling.nextSibling;\n                }\n\n                // 4. Let node be the result of converting nodes into a node, given \n                // nodes and context object’s node document. Rethrow any exceptions.\n                var node = _dom2.default.convertNodesIntoANode(nodes, _this2.ownerDocument);\n\n                // 5. Pre-insert node into parent before viableNextSibling. Rethrow \n                // any exceptions.\n                _dom2.default.preInsert(node, parent, viableNextSibling);\n            });\n        },\n\n\n        // TODO: tests\n        replaceWith: function replaceWith() {\n            var _this3 = this;\n\n            for (var _len3 = arguments.length, nodes = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n                nodes[_key3] = arguments[_key3];\n            }\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-childnode-replacewith\n                // The replaceWith(nodes) method, when invoked, must run these steps:\n\n                // 1. Let parent be context object’s parent.\n                var parent = _this3.parentNode;\n\n                // 2. If parent is null, terminate these steps.\n                if (!parent) {\n                    return;\n                }\n\n                // 3. Let viableNextSibling be context object’s first following \n                // sibling not in nodes, and null otherwise.\n                var viableNextSibling = _this3.nextSibling;\n                while (viableNextSibling && nodes.indexOf(viableNextSibling) !== -1) {\n                    viableNextSibling = viableNextSibling.nextSibling;\n                }\n\n                // 4. Let node be the result of converting nodes into a node, given \n                // nodes and context object’s node document. Rethrow any exceptions.\n                var node = _dom2.default.convertNodesIntoANode(nodes, _this3.ownerDocument);\n\n                // 5. If context object’s parent is parent, replace the context object \n                // with node within parent. Rethrow any exceptions.\n                if (_this3.parentNode == parent) {\n                    _dom2.default.replace(_this3, node, parent);\n                }\n                // 6. Otherwise, pre-insert node into parent before viableNextSibling. \n                // Rethrow any exceptions.\n                else {\n                        _dom2.default.preInsert(node, parent, viableNextSibling);\n                    }\n            });\n        },\n\n\n        // TODO: tests\n        remove: function remove() {\n            var _this4 = this;\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-childnode-remove\n                // The remove() method, when invoked, must run these steps:\n\n                // 1. If context object’s parent is null, terminate these steps.\n                var parent = _this4.parentNode;\n\n                if (!parent) {\n                    return;\n                }\n\n                // 2. Remove the context object from context object’s parent.\n                _dom2.default.remove(_this4, parent);\n            });\n        }\n    };\n};\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n\n    // TODO: consider getSelection()\n    // TODO: consider elementFromPoint(double x, double y)\n    // TODO: consider elementsFromPoint(double x, double y)\n    // TODO: consider get styleSheets()\n\n    // TODO: tests\n    get activeElement() {\n        var document = this.ownerDocument || this;\n        var nativeActiveElement = native.activeElement.get.call(document);\n\n        if (!nativeActiveElement || document != _dom2.default.shadowIncludingRoot(this)) {\n            return null;\n        }\n\n        return _dom2.default.retarget(nativeActiveElement, this);\n    }\n\n}; // https://dom.spec.whatwg.org/#mixin-documentorshadowroot\n// https://www.w3.org/TR/shadow-dom/#extensions-to-the-documentorshadowroot-mixin","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    var nodePreviousSiblingDescriptor = _utils2.default.descriptor(Node, 'previousSibling');\n    var nodeNextSiblingDescriptor = _utils2.default.descriptor(Node, 'nextSibling');\n    var basePreviousElementSiblingDescriptor = _utils2.default.descriptor(base, 'previousElementSibling');\n    var baseNextElementSiblingDescriptor = _utils2.default.descriptor(base, 'nextElementSibling');\n\n    return {\n\n        // TODO: tests\n        get previousElementSibling() {\n            var nodeState = _utils2.default.getShadowState(this);\n            if (nodeState && nodeState.parentNode) {\n                var childNodes = _utils2.default.getShadowState(nodeState.parentNode).childNodes;\n                var index = childNodes.indexOf(this);\n                while (index > 0) {\n                    var previous = childNodes[--index];\n                    if (previous.nodeType === Node.ELEMENT_NODE) {\n                        return previous;\n                    }\n                };\n                return null;\n            } else if (basePreviousElementSiblingDescriptor) {\n                return basePreviousElementSiblingDescriptor.get.call(this);\n            } else {\n                var getPreviousSibling = nodePreviousSiblingDescriptor.get;\n                var previousSibling = this;\n                while (previousSibling = getPreviousSibling.call(previousSibling)) {\n                    if (previousSibling.nodeType === Node.ELEMENT_NODE) {\n                        return previousSibling;\n                    }\n                }\n                return null;\n            }\n        },\n\n        // TODO: tests\n        get nextElementSibling() {\n            var nodeState = _utils2.default.getShadowState(this);\n            if (nodeState && nodeState.parentNode) {\n                var childNodes = _utils2.default.getShadowState(nodeState.parentNode).childNodes;\n                var index = childNodes.indexOf(this);\n                while (index < childNodes.length - 1) {\n                    var next = childNodes[++index];\n                    if (next.nodeType === Node.ELEMENT_NODE) {\n                        return next;\n                    }\n                };\n                return null;\n            } else if (baseNextElementSiblingDescriptor) {\n                return baseNextElementSiblingDescriptor.get.call(this);\n            } else {\n                var getNextSibling = nodeNextSiblingDescriptor.get;\n                var nextSibling = this;\n                while (nextSibling = getNextSibling.call(nextSibling)) {\n                    if (nextSibling.nodeType === Node.ELEMENT_NODE) {\n                        return nextSibling;\n                    }\n                }\n                return null;\n            }\n        }\n\n    };\n};\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    return {\n        getElementById: function getElementById(id) {\n            // https://dom.spec.whatwg.org/#dom-nonelementparentnode-getelementbyid\n\n            if (id === '' || /\\s/.test(id)) {\n                return null;\n            }\n\n            var firstChild = this.firstChild;\n\n            if (!firstChild) {\n                return null;\n            }\n\n            return _dom2.default.treeOrderRecursiveSelectFirst(firstChild, function (node) {\n                return node.id === id;\n            });\n        }\n    };\n};\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    var native = {\n        children: _utils2.default.descriptor(base, 'children'),\n        firstElementChild: _utils2.default.descriptor(base, 'firstElementChild'),\n        lastElementChild: _utils2.default.descriptor(base, 'lastElementChild'),\n        childElementCount: _utils2.default.descriptor(base, 'childElementCount')\n    };\n\n    return {\n\n        get children() {\n            var childNodes = void 0;\n\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                childNodes = shadowState.childNodes;\n            }\n\n            if (!childNodes) {\n                if (native.children) {\n                    return native.children.get.call(this);\n                }\n                childNodes = this.childNodes;\n            }\n\n            var childNodesLength = childNodes.length;\n            var elements = new Array(childNodesLength);\n            var pushed = 0;\n            for (var i = 0; i < childNodesLength; i++) {\n                var node = childNodes[i];\n                if (node.nodeType == Node.ELEMENT_NODE) {\n                    elements[pushed++] = node;\n                }\n            }\n            elements.length = pushed;\n\n            return elements;\n        },\n\n        get firstElementChild() {\n            var childNodes = void 0;\n\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                childNodes = shadowState.childNodes;\n            }\n\n            if (!childNodes) {\n                if (native.firstElementChild) {\n                    return native.firstElementChild.get.call(this);\n                }\n                childNodes = this.childNodes;\n            }\n\n            for (var i = 0; i < childNodes.length; i++) {\n                var node = childNodes[i];\n                if (node.nodeType == Node.ELEMENT_NODE) {\n                    return node;\n                }\n            }\n\n            return null;\n        },\n\n        get lastElementChild() {\n            var childNodes = void 0;\n\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                childNodes = shadowState.childNodes;\n            }\n\n            if (!childNodes) {\n                if (native.lastElementChild) {\n                    return native.lastElementChild.get.call(this);\n                }\n                childNodes = this.childNodes;\n            }\n\n            for (var i = childNodes.length - 1; i >= 0; i--) {\n                var node = childNodes[i];\n                if (node.nodeType == Node.ELEMENT_NODE) {\n                    return node;\n                }\n            }\n\n            return null;\n        },\n\n        get childElementCount() {\n            var childNodes = void 0;\n\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                childNodes = shadowState.childNodes;\n            }\n\n            if (!childNodes) {\n                if (native.childElementCount) {\n                    return native.childElementCount.get.call(this);\n                }\n                childNodes = this.childNodes;\n            }\n\n            var count = 0;\n\n            for (var i = 0; i < childNodes.length; i++) {\n                var node = childNodes[i];\n                if (node.nodeType == Node.ELEMENT_NODE) {\n                    count++;\n                }\n            }\n\n            return count;\n        },\n\n        // TODO: tests\n        prepend: function prepend() {\n            var _this = this;\n\n            for (var _len = arguments.length, nodes = Array(_len), _key = 0; _key < _len; _key++) {\n                nodes[_key] = arguments[_key];\n            }\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-parentnode-prepend\n                // The prepend(nodes) method, when invoked, must run these steps:\n\n                // 1. Let node be the result of converting nodes into a node given \n                // nodes and context object’s node document. Rethrow any exceptions.\n                var node = _dom2.default.convertNodesIntoANode(nodes, _this.ownerDocument || _this);\n\n                // 2. Pre-insert node into context object before the context object’s \n                // first child. Rethrow any exceptions.\n                _dom2.default.preInsert(node, _this, _this.firstChild);\n            });\n        },\n\n\n        // TODO: tests\n        append: function append() {\n            var _this2 = this;\n\n            for (var _len2 = arguments.length, nodes = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                nodes[_key2] = arguments[_key2];\n            }\n\n            return _customElements2.default.executeCEReactions(function () {\n                // https://dom.spec.whatwg.org/#dom-parentnode-append\n                // The append(nodes) method, when invoked, must run these steps:\n\n                // 1. Let node be the result of converting nodes into a node given \n                // nodes and context object’s node document. Rethrow any exceptions.\n                var node = _dom2.default.convertNodesIntoANode(nodes, _this2.ownerDocument || _this2);\n\n                // 2. Append node to context object. Rethrow any exceptions.\n                _dom2.default.append(node, _this2);\n            });\n        },\n\n\n        // TODO: tests\n        querySelector: function querySelector(selectors) {\n            var results = this.querySelectorAll(selectors);\n\n            if (results.length) {\n                return results[0];\n            }\n\n            return null;\n        },\n\n\n        // TODO: tests\n        querySelectorAll: function querySelectorAll(selectors) {\n            // https://dom.spec.whatwg.org/#scope-match-a-selectors-string\n            // this is horrible, performance-wise.\n            // it's about 100x slower than native querySelectorAll.\n            // that might not amount to much in practice, though.\n            // after all, this is a polyfill.\n\n            var results = [];\n\n            var firstChild = this.firstChild;\n\n            if (!firstChild) {\n                return results;\n            }\n\n            _dom2.default.treeOrderRecursiveSelectAll(firstChild, results, function (node) {\n                return node.nodeType === Node.ELEMENT_NODE && node.matches(selectors);\n            });\n\n            return results;\n        }\n    };\n};\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _customElements = require('../custom-elements.js');\n\nvar _customElements2 = _interopRequireDefault(_customElements);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (base) {\n\n    return {\n\n        get assignedSlot() {\n            // spec implementation is to run 'find a slot'\n            // this uses an alternative (see https://github.com/whatwg/dom/issues/369)\n            var shadowState = _utils2.default.getShadowState(this);\n            if (shadowState) {\n                var slot = shadowState.assignedSlot;\n                if (slot && _dom2.default.closedShadowHidden(slot, this)) {\n                    return null;\n                }\n                return slot;\n            }\n            return null;\n        }\n\n    };\n};\n\nvar _dom = require('../dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _utils = require('../utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.patchAll = patchAll;\n\nvar _utils = require('./utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _dom = require('./dom.js');\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _DOMTokenList = require('./interfaces/DOMTokenList.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Fear not the single page\n// https://www.w3.org/TR/html/single-page.html\n\n// TODO: implement on demand\n// These might be a bit much considering we can't do anything about inline script handlers\n// GlobalEventHandlers\n// DocumentAndElementEventHandlers\n\n// TODO: implement on demand\n// This would be useful to polyfill considering most current browsers don't implement it yet\n// HTMLHyperlinkElementUtils (Anchor, Area)\n\nvar interfaces = {\n    'Element': {\n        'id': reflectString(),\n        'className': reflectString('class'),\n        'classList': reflectDOMTokenList('class'),\n        'slot': reflectString()\n    },\n    'HTMLElement': {\n        'title': reflectString(),\n        'lang': reflectString(),\n        'translate': reflectString(),\n        'dir': reflectString(),\n        // TODO: implement on demand\n        //'dataset': reflect.DOMStringMap('data'),\n        'hidden': reflectBoolean(),\n        'tabIndex': reflectInteger(null, 0),\n        'accessKey': reflectString(),\n        'draggable': reflectString(),\n        'contextMenu': reflectHTMLElement(window.HTMLMenuElement),\n        'spellcheck': reflectString(),\n        // ElementContentEditable\n        'contentEditable': reflectString()\n    },\n    'HTMLAnchorElement': {\n        'target': reflectString(),\n        'download': reflectString(),\n        'rel': reflectString(),\n        'rev': reflectString(),\n        'relList': reflectDOMTokenList('rel'),\n        'hreflang': reflectString(),\n        'type': reflectString(),\n        'text': reflectTextContent()\n    },\n    'HTMLAreaElement': {\n        'alt': reflectString(),\n        'coords': reflectString(),\n        'shape': reflectString(),\n        'target': reflectString(),\n        'download': reflectString(),\n        'rel': reflectString(),\n        'relList': reflectDOMTokenList('rel'),\n        'hreflang': reflectString(),\n        'type': reflectString()\n    },\n    'HTMLBaseElement': {\n        'href': reflectString(),\n        'target': reflectString()\n    },\n    'HTMLButtonElement': {\n        'autofocus': reflectBoolean(),\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'formAction': reflectString(),\n        'formEnctype': reflectString(),\n        'formMethod': reflectString(),\n        'formNoValidate': reflectBoolean(),\n        'formTarget': reflectString(),\n        'name': reflectString(),\n        'type': reflectString(),\n        'value': reflectString(),\n        'menu': reflectHTMLElement(window.HTMLMenuElement)\n    },\n    'HTMLCanvasElement': {\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0)\n    },\n    'HTMLDataElement': {\n        'value': reflectString()\n    },\n    'HTMLDetailsElement': {\n        'open': reflectBoolean()\n    },\n    'HTMLEmbedElement': {\n        'src': reflectString(),\n        'type': reflectString(),\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0)\n    },\n    'HTMLFieldSetElement': {\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'name': reflectString()\n    },\n    'HTMLFormElement': {\n        'acceptCharset': reflectString('accept-charset'),\n        'action': reflectString(),\n        'autocomplete': reflectString(),\n        'enctype': reflectString(),\n        'encoding': reflectString('enctype'),\n        'method': reflectString(),\n        'name': reflectString(),\n        'noValidate': reflectBoolean(),\n        'target': reflectString()\n    },\n    'HTMLIFrameElement': {\n        'src': reflectString(),\n        'srcdoc': reflectString(),\n        'name': reflectString(),\n        'sandbox': reflectDOMTokenList('sandbox'),\n        'allowFullscreen': reflectBoolean(),\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0)\n    },\n    'HTMLImageElement': {\n        'alt': reflectString(),\n        'src': reflectString(),\n        'srcset': reflectString(),\n        'crossOrigin': reflectString(),\n        'useMap': reflectString(),\n        'isMap': reflectBoolean(),\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0)\n    },\n    // TODO: caveat about feature testing input elements using anything besides 'type'\n    'HTMLInputElement': {\n        'accept': reflectString(),\n        'alt': reflectString(),\n        'autocomplete': reflectString(),\n        'autofocus': reflectBoolean(),\n        'defaultChecked': reflectBoolean('checked'),\n        'dirName': reflectString(),\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'formAction': reflectString(),\n        'formEnctype': reflectString(),\n        'formMethod': reflectString(),\n        'formNoValidate': reflectBoolean(),\n        'formTarget': reflectString(),\n        'height': reflectInteger(null, 0),\n        'inputMode': reflectString(),\n        // TODO: investigate whether we should bother with 'list'.\n        // Browsers without native Shadow DOM could end up not\n        // pulling suggestions from the correct list anyways.\n        // Possibly needs to be a caveat about this.\n        //'list': reflectSuggestionSourceElement(),\n        'max': reflectString(),\n        'maxLength': reflectInteger(0, 0),\n        'min': reflectString(),\n        'minLength': reflectInteger(0, 0),\n        'multiple': reflectBoolean(),\n        'name': reflectString(),\n        'pattern': reflectString(),\n        'placeholder': reflectString(),\n        'readOnly': reflectBoolean(),\n        'required': reflectBoolean(),\n        'size': reflectInteger(1, 1),\n        'src': reflectString(),\n        'step': reflectString(),\n        'type': reflectString(),\n        'defaultValue': reflectString('value'),\n        'width': reflectInteger(null, 0)\n    },\n    'HTMLKeygenElement': {\n        'autofocus': reflectBoolean(),\n        'challenge': reflectString(),\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'keytype': reflectString(),\n        'name': reflectString()\n    },\n    'HTMLLabelElement': {\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'htmlFor': reflectString('for')\n    },\n    'HTMLLegendElement': {\n        //'form': reflectHTMLElement(HTMLFormElement, true)\n    },\n    'HTMLLIElement': {\n        'value': reflectString()\n    },\n    'HTMLLinkElement': {\n        'href': reflectString(),\n        'crossOrigin': reflectString(),\n        'rel': reflectString(),\n        'rev': reflectString(),\n        'relList': reflectDOMTokenList('rel'),\n        'media': reflectString(),\n        'hreflang': reflectString(),\n        'type': reflectString(),\n        'sizes': reflectDOMTokenList('sizes')\n    },\n    'HTMLMapElement': {\n        'name': reflectString()\n    },\n    'HTMLMediaElement': {\n        'src': reflectString(),\n        'crossOrigin': reflectString(),\n        'preload': reflectString(),\n        'loop': reflectBoolean(),\n        'autoplay': reflectBoolean(),\n        'mediaGroup': reflectString(),\n        'controls': reflectBoolean(),\n        'defaultMuted': reflectBoolean('muted')\n    },\n    'HTMLMenuElement': {\n        'type': reflectString(),\n        'label': reflectString()\n    },\n    'HTMLMenuItemElement': {\n        'type': reflectString(),\n        'label': reflectString(),\n        'icon': reflectString(),\n        'disabled': reflectBoolean(),\n        'checked': reflectBoolean('checked'),\n        'radiogroup': reflectString(),\n        'default': reflectBoolean()\n    },\n    'HTMLMetaElement': {\n        'name': reflectString(),\n        'httpEquiv': reflectString('http-equiv'),\n        'content': reflectString()\n    },\n    'HTMLMeterElement': {\n        'value': reflectFloat(null, 0),\n        'min': reflectFloat(null, 0),\n        'max': reflectFloat(null, 0),\n        'low': reflectFloat(null, 0),\n        'high': reflectFloat(null, 0),\n        'optimum': reflectFloat(null, 0)\n    },\n    'HTMLModElement': {\n        'cite': reflectString(),\n        'dateTime': reflectString()\n    },\n    'HTMLObjectElement': {\n        'data': reflectString(),\n        'type': reflectString(),\n        'typeMustMatch': reflectBoolean(),\n        'name': reflectString(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0)\n    },\n    'HTMLOListElement': {\n        'reversed': reflectBoolean(),\n        'start': reflectInteger(null, 0),\n        'type': reflectString()\n    },\n    'HTMLOptGroupElement': {\n        'disabled': reflectBoolean(),\n        'label': reflectString()\n    },\n    'HTMLOptionElement': {\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'label': reflectString(),\n        'defaultSelected': reflectBoolean('selected'),\n        'value': reflectString()\n    },\n    'HTMLOutputElement': {\n        'htmlFor': reflectDOMTokenList('for'),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'name': reflectString(),\n        'defaultValue': reflectString('value')\n    },\n    'HTMLParamElement': {\n        'name': reflectString(),\n        'value': reflectString()\n    },\n    'HTMLProgressElement': {\n        'value': reflectFloat(null, 0),\n        'max': reflectFloat(null, 0)\n    },\n    'HTMLQuoteElement': {\n        'cite': reflectString()\n    },\n    'HTMLScriptElement': {\n        'src': reflectString(),\n        'type': reflectString(),\n        'charset': reflectString(),\n        'async': reflectBoolean(),\n        'defer': reflectBoolean(),\n        'crossOrigin': reflectString(),\n        // TODO: implement on demand\n        // 'text': reflectScriptText(),\n        'nonce': reflectString()\n    },\n    'HTMLSelectElement': {\n        'autocomplete': reflectString(),\n        'autofocus': reflectBoolean(),\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'multiple': reflectBoolean(),\n        'name': reflectString(),\n        'required': reflectBoolean(),\n        'size': reflectInteger(1, 1)\n    },\n    'HTMLSourceElement': {\n        'src': reflectString(),\n        'type': reflectString(),\n        'media': reflectString()\n    },\n    'HTMLStyleElement': {\n        'media': reflectString(),\n        'nonce': reflectString(),\n        'type': reflectString()\n    },\n    'HTMLTableCellElement': {\n        'colSpan': reflectInteger(0, -1),\n        'rowSpan': reflectInteger(0, -1),\n        'headers': reflectDOMTokenList('headers')\n    },\n    'HTMLTableColElement': {\n        'span': reflectInteger(1, 1)\n    },\n    'HTMLTableHeaderCellElement': {\n        'scope': reflectString(),\n        'abbr': reflectString()\n    },\n    'HTMLTextAreaElement': {\n        'autocomplete': reflectString(),\n        'autofocus': reflectBoolean(),\n        'cols': reflectString(),\n        'dirName': reflectString(),\n        'disabled': reflectBoolean(),\n        //'form': reflectHTMLElement(HTMLFormElement, true),\n        'inputMode': reflectString(),\n        'maxLength': reflectInteger(0, 0),\n        'minLength': reflectInteger(0, 0),\n        'name': reflectString(),\n        'placeholder': reflectString(),\n        'readOnly': reflectBoolean(),\n        'required': reflectBoolean(),\n        'rows': reflectInteger(1, 1),\n        'wrap': reflectString(),\n        'defaultValue': reflectTextContent()\n    },\n    'HTMLTimeElement': {\n        'dateTime': reflectString()\n    },\n    'HTMLTrackElement': {\n        'kind': reflectString(),\n        'src': reflectString(),\n        'srclang': reflectString(),\n        'label': reflectString(),\n        'default': reflectBoolean()\n    },\n    'HTMLVideoElement': {\n        'width': reflectInteger(null, 0),\n        'height': reflectInteger(null, 0),\n        'poster': reflectString()\n    }\n};\n\n// https://www.w3.org/TR/html/single-page.html#reflection\n\n// An index of IDL attributes that should reflect a corresponding content attribute.\n\nfunction reflectString(attributeName) {\n    return function (type, name) {\n        attributeName = attributeName || name.toLowerCase();\n        var descriptor = _utils2.default.descriptor(type, name);\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: descriptor ? descriptor.get : function () {\n                return this.getAttribute(attributeName) || '';\n            },\n            set: function set(value) {\n                _dom2.default.setAttributeValue(this, attributeName, value);\n            }\n        });\n    };\n}\n\nfunction reflectBoolean(attributeName) {\n    return function (type, name) {\n        attributeName = attributeName || name.toLowerCase();\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                return this.hasAttribute(attributeName);\n            },\n            set: function set(value) {\n                if (value === false) {\n                    _dom2.default.removeAttributeByName(attributeName, this);\n                } else {\n                    _dom2.default.setAttributeValue(this, attributeName, value);\n                }\n            }\n        });\n    };\n}\n\n// TODO: minValue, errors\nfunction reflectInteger(minValue, defaultValue) {\n    return function (type, name) {\n        var attributeName = name.toLowerCase();\n        defaultValue = defaultValue || 0;\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                var value = this.getAttribute(attributeName);\n                return parseInt(value) || defaultValue;\n            },\n            set: function set(value) {\n                if (typeof value !== 'number') {\n                    throw _utils2.default.makeDOMException('TypeError');\n                }\n                _dom2.default.setAttributeValue(this, attributeName, value.toString());\n            }\n        });\n    };\n}\n\n// TODO: minValue, errors\nfunction reflectFloat(minValue, defaultValue) {\n    return function (type, name) {\n        var attributeName = name.toLowerCase();\n        defaultValue = defaultValue || 0;\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                var value = this.getAttribute(attributeName);\n                return parseFloat(value) || defaultValue;\n            },\n            set: function set(value) {\n                if (typeof value !== 'number') {\n                    throw _utils2.default.makeDOMException('TypeError');\n                }\n                _dom2.default.setAttributeValue(this, attributeName, value.toString());\n            }\n        });\n    };\n}\n\nfunction reflectDOMTokenList(localName) {\n    return function (type, name) {\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                return (0, _DOMTokenList.getOrCreateDOMTokenList)(this, localName);\n            },\n            set: function set(value) {\n                (0, _DOMTokenList.getOrCreateDOMTokenList)(this, localName).value = value;\n            }\n        });\n    };\n}\n\nfunction reflectHTMLElement(candidateType, readOnly) {\n    return function (type, name) {\n        var attributeName = name.toLowerCase();\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                if (!this.hasAttribute(attributeName)) {\n                    return null;\n                }\n                var id = this.getAttribute(attributeName);\n                var candidate = this.ownerDocument.getElementById(id);\n                if (candidate == null || !(candidate instanceof candidateType)) {\n                    return null;\n                }\n                return candidate;\n            },\n            set: readOnly ? undefined : function (value) {\n                if (!(value instanceof candidateType)) {\n                    throw _utils2.default.makeDOMException('TypeError');\n                }\n                if (value.hasAttribute('id')) {\n                    var found = this.ownerDocument.getElementById(value.id);\n                    if (value === found) {\n                        this.setAttribute(attributeName, value.id);\n                        return;\n                    }\n                }\n                this.setAttribute(attributeName, '');\n            }\n        });\n    };\n}\n\nfunction reflectTextContent() {\n    return function (type, name) {\n        Object.defineProperty(type.prototype, name, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n                return this.textContent;\n            },\n            set: function set(value) {\n                this.textContent = value;\n            }\n        });\n    };\n}\n\nfunction patchAll() {\n    var identifiers = Object.getOwnPropertyNames(interfaces);\n    for (var i = 0; i < identifiers.length; i++) {\n        var identifier = identifiers[i];\n        if (identifier in window) {\n            var type = window[identifier];\n            var attributes = Object.getOwnPropertyNames(interfaces[identifier]);\n            for (var j = 0; j < attributes.length; j++) {\n                var attribute = attributes[j];\n                interfaces[identifier][attribute](type, attribute);\n            }\n        }\n    }\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = require('./utils.js');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _reflect = require('./reflect.js');\n\nvar reflect = _interopRequireWildcard(_reflect);\n\nvar _Attr = require('./interfaces/Attr.js');\n\nvar _Attr2 = _interopRequireDefault(_Attr);\n\nvar _CharacterData = require('./interfaces/CharacterData.js');\n\nvar _CharacterData2 = _interopRequireDefault(_CharacterData);\n\nvar _CustomEvent = require('./interfaces/CustomEvent.js');\n\nvar _CustomEvent2 = _interopRequireDefault(_CustomEvent);\n\nvar _Document = require('./interfaces/Document.js');\n\nvar _Document2 = _interopRequireDefault(_Document);\n\nvar _DOMTokenList = require('./interfaces/DOMTokenList.js');\n\nvar _DOMTokenList2 = _interopRequireDefault(_DOMTokenList);\n\nvar _Element = require('./interfaces/Element.js');\n\nvar _Element2 = _interopRequireDefault(_Element);\n\nvar _Event = require('./interfaces/Event.js');\n\nvar _Event2 = _interopRequireDefault(_Event);\n\nvar _EventTarget = require('./interfaces/EventTarget.js');\n\nvar _EventTarget2 = _interopRequireDefault(_EventTarget);\n\nvar _HTMLSlotElement = require('./interfaces/HTMLSlotElement.js');\n\nvar _HTMLSlotElement2 = _interopRequireDefault(_HTMLSlotElement);\n\nvar _HTMLTableElement = require('./interfaces/HTMLTableElement.js');\n\nvar _HTMLTableElement2 = _interopRequireDefault(_HTMLTableElement);\n\nvar _HTMLTableRowElement = require('./interfaces/HTMLTableRowElement.js');\n\nvar _HTMLTableRowElement2 = _interopRequireDefault(_HTMLTableRowElement);\n\nvar _HTMLTableSectionElement = require('./interfaces/HTMLTableSectionElement.js');\n\nvar _HTMLTableSectionElement2 = _interopRequireDefault(_HTMLTableSectionElement);\n\nvar _MutationObserver = require('./interfaces/MutationObserver.js');\n\nvar _MutationObserver2 = _interopRequireDefault(_MutationObserver);\n\nvar _NamedNodeMap = require('./interfaces/NamedNodeMap.js');\n\nvar _NamedNodeMap2 = _interopRequireDefault(_NamedNodeMap);\n\nvar _Node = require('./interfaces/Node.js');\n\nvar _Node2 = _interopRequireDefault(_Node);\n\nvar _ShadowRoot = require('./interfaces/ShadowRoot.js');\n\nvar _ShadowRoot2 = _interopRequireDefault(_ShadowRoot);\n\nvar _Text = require('./interfaces/Text.js');\n\nvar _Text2 = _interopRequireDefault(_Text);\n\nvar _ChildNode = require('./mixins/ChildNode.js');\n\nvar _ChildNode2 = _interopRequireDefault(_ChildNode);\n\nvar _DocumentOrShadowRoot = require('./mixins/DocumentOrShadowRoot.js');\n\nvar _DocumentOrShadowRoot2 = _interopRequireDefault(_DocumentOrShadowRoot);\n\nvar _NonDocumentTypeChildNode = require('./mixins/NonDocumentTypeChildNode.js');\n\nvar _NonDocumentTypeChildNode2 = _interopRequireDefault(_NonDocumentTypeChildNode);\n\nvar _NonElementParentNode = require('./mixins/NonElementParentNode.js');\n\nvar _NonElementParentNode2 = _interopRequireDefault(_NonElementParentNode);\n\nvar _ParentNode = require('./mixins/ParentNode.js');\n\nvar _ParentNode2 = _interopRequireDefault(_ParentNode);\n\nvar _Slotable = require('./mixins/Slotable.js');\n\nvar _Slotable2 = _interopRequireDefault(_Slotable);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar nativeSupport = 'attachShadow' in Element.prototype;\n\nexports.default = {\n    nativeSupport: nativeSupport,\n    install: install\n};\n\n\nfunction install() {\n\n    // Hacky setting in case you want to use ShadyCSS.\n    window['ShadyDOM'] = { 'inUse': true };\n\n    // Reflected attributes\n    reflect.patchAll();\n\n    // Element.matches(selectors) polyfill from MDN\n    // https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill\n    // Purposefully chop out the polyfill function that uses querySelectorAll.\n    if (!Element.prototype.matches) {\n        Element.prototype.matches = Element.prototype.matchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.webkitMatchesSelector;\n    }\n\n    // Attr interface\n    _utils2.default.extend(Attr, _Attr2.default);\n\n    // CharacterData interface\n    _utils2.default.extend(CharacterData, _CharacterData2.default);\n\n    // CustomEvent interface\n    window.CustomEvent = _CustomEvent2.default;\n\n    // Document interface\n    _utils2.default.extend(Document, _Document2.default);\n\n    // DOMTokenList interface\n    if ('DOMTokenList' in window) {\n        // TODO: what about IE9?\n        _utils2.default.extend(DOMTokenList, _DOMTokenList2.default);\n    }\n\n    // Element interface\n    _utils2.default.extend(Element, _Element2.default);\n\n    // Event interface\n    _utils2.default.extend(Event, _Event2.default);\n    _utils2.default.extend(FocusEvent, _Event.hasRelatedTarget);\n    _utils2.default.extend(MouseEvent, _Event.hasRelatedTarget);\n    _Event2.default.prototype = Event.prototype;\n    window.Event = _Event2.default;\n\n    // EventTarget\n    if ('EventTarget' in Window) {\n        _utils2.default.extend(EventTarget, (0, _EventTarget2.default)(EventTarget));\n    } else {\n        // In IE, EventTarget is not exposed and Window's\n        // EventTarget methods are not the same as Node's.\n        _utils2.default.extend(Window, (0, _EventTarget2.default)(Window));\n        _utils2.default.extend(Node, (0, _EventTarget2.default)(Node));\n    }\n\n    // HTMLSlotElement interface\n    _utils2.default.extend('HTMLSlotElement' in window ? HTMLSlotElement : HTMLUnknownElement, _HTMLSlotElement2.default);\n\n    // HTMLTableElement interface\n    _utils2.default.extend(HTMLTableElement, _HTMLTableElement2.default);\n\n    // HTMLTableRowElement interface\n    _utils2.default.extend(HTMLTableRowElement, _HTMLTableRowElement2.default);\n\n    // HTMLTableSectionElement interface\n    _utils2.default.extend(HTMLTableSectionElement, _HTMLTableSectionElement2.default);\n\n    // MutationObserver interface\n    window.MutationObserver = _MutationObserver2.default;\n\n    // NamedNodeMap interface\n    _utils2.default.extend(NamedNodeMap, _NamedNodeMap2.default);\n\n    // Node interface\n    _utils2.default.extend(Node, _Node2.default);\n\n    // TODO: implement Range interface\n\n    // Text interface\n    _utils2.default.extend(Text, _Text2.default);\n\n    // ChildNode mixin\n    _utils2.default.extend(DocumentType, (0, _ChildNode2.default)(DocumentType));\n    _utils2.default.extend(Element, (0, _ChildNode2.default)(Element));\n    _utils2.default.extend(CharacterData, (0, _ChildNode2.default)(CharacterData));\n\n    // DocumentOrShadowRoot mixin\n    _utils2.default.extend(Document, _DocumentOrShadowRoot2.default);\n    _utils2.default.extend(_ShadowRoot2.default, _DocumentOrShadowRoot2.default);\n\n    // NonDocumentTypeChildNode mixin\n    _utils2.default.extend(Element, (0, _NonDocumentTypeChildNode2.default)(Element));\n    _utils2.default.extend(CharacterData, (0, _NonDocumentTypeChildNode2.default)(CharacterData));\n\n    // NonElementParentNode mixin\n    _utils2.default.extend(Document, (0, _NonElementParentNode2.default)(Document));\n    _utils2.default.extend(DocumentFragment, (0, _NonElementParentNode2.default)(DocumentFragment));\n\n    // ParentNode mixin\n    _utils2.default.extend(Document, (0, _ParentNode2.default)(Document));\n    _utils2.default.extend(DocumentFragment, (0, _ParentNode2.default)(DocumentFragment));\n    _utils2.default.extend(Element, (0, _ParentNode2.default)(Element));\n\n    // Slotable mixin\n    _utils2.default.extend(Element, (0, _Slotable2.default)(Element));\n    _utils2.default.extend(Text, (0, _Slotable2.default)(Text));\n\n    // Cleanup for IE, Edge\n    delete Node.prototype.attributes;\n    delete HTMLElement.prototype.classList;\n    delete HTMLElement.prototype.children;\n    delete HTMLElement.prototype.parentElement;\n    delete HTMLElement.prototype.innerHTML;\n    delete HTMLElement.prototype.outerHTML;\n    delete HTMLElement.prototype.insertAdjacentText;\n    delete HTMLElement.prototype.insertAdjacentElement;\n    delete HTMLElement.prototype.insertAdjacentHTML;\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n// NOTE: setTimeout with args does not work in IE9. There is a note in the README about this.\nvar setImmediate = 'setImmediate' in window ? window.setImmediate : function (callback) {\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n    }\n\n    return setTimeout.apply(undefined, [callback, 0].concat(args));\n};\n\nvar setPrototypeOf = function () {\n    if (Object.setPrototypeOf) {\n        return Object.setPrototypeOf;\n    }\n\n    var test = {};\n    var proto = {};\n    test.__proto__ = proto;\n    if (Object.getPrototypeOf(test) === proto) {\n        return function (object, proto) {\n            object.__proto__ = proto;\n            return object;\n        };\n    }\n\n    return function (object, proto) {\n        var names = Object.getOwnPropertyNames(proto);\n        for (var i = 0; i < names.length; i++) {\n            var name = names[i];\n            var _descriptor = Object.getOwnPropertyDescriptor(proto, name);\n            Object.defineProperty(object, name, _descriptor);\n        }\n    };\n}();\n\nvar nodeAppendChildDescriptor = descriptor(Node, 'appendChild');\nvar documentCreateElementDescriptor = descriptor(Document, 'createElement');\n\nexports.default = {\n    descriptor: descriptor,\n    setImmediate: setImmediate,\n    setPrototypeOf: setPrototypeOf,\n    makeDOMException: makeDOMException,\n    reportError: reportError,\n    extend: extend,\n    getShadowState: getShadowState,\n    setShadowState: setShadowState\n};\n\n\nfunction descriptor(type, name) {\n    return Object.getOwnPropertyDescriptor(type.prototype, name);\n}\n\n// TODO: analyze usages and provide brief but descriptive messages\nfunction makeDOMException(name, message) {\n    try {\n        var sacrifice = documentCreateElementDescriptor.value.call(window.document, 'div');\n        nodeAppendChildDescriptor.value.call(sacrifice, sacrifice);\n    } catch (caught) {\n        return Object.create(caught, {\n            'message': {\n                get: function get() {\n                    return message;\n                }\n            },\n            'name': {\n                get: function get() {\n                    return name;\n                }\n            },\n            'code': {\n                get: function get() {\n                    return caught.code;\n                }\n            },\n            'toString': {\n                value: function value() {\n                    if (message) {\n                        return name + ': ' + message;\n                    }\n                    return name;\n                }\n            }\n        });\n    }\n}\n\nfunction reportError(error) {\n    if ('console' in window && 'error' in window.console) {\n        window.console.error(error);\n    }\n}\n\nfunction extend(object) {\n    for (var _len2 = arguments.length, mixins = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        mixins[_key2 - 1] = arguments[_key2];\n    }\n\n    for (var i = 0; i < mixins.length; i++) {\n        var mixin = mixins[i];\n        var prototype = mixin.prototype || mixin;\n        var names = Object.getOwnPropertyNames(prototype);\n        for (var j = 0; j < names.length; j++) {\n            var name = names[j];\n            if (name === 'constructor') {\n                continue;\n            }\n            var _descriptor2 = Object.getOwnPropertyDescriptor(prototype, name);\n            Object.defineProperty(object.prototype || object, name, _descriptor2);\n        }\n    }\n}\n\nfunction getShadowState(object) {\n    return object._shadow;\n}\n\nfunction setShadowState(object, state) {\n    return object._shadow = state;\n}"]}